- en: Kandinsky 2.2
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Kandinsky 2.2
- en: 'Original text: [https://huggingface.co/docs/diffusers/training/kandinsky](https://huggingface.co/docs/diffusers/training/kandinsky)'
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸå§‹æ–‡æœ¬ï¼š[https://huggingface.co/docs/diffusers/training/kandinsky](https://huggingface.co/docs/diffusers/training/kandinsky)
- en: null
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: This script is experimental, and itâ€™s easy to overfit and run into issues like
    catastrophic forgetting. Try exploring different hyperparameters to get the best
    results on your dataset.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªè„šæœ¬æ˜¯å®éªŒæ€§çš„ï¼Œå¾ˆå®¹æ˜“è¿‡æ‹Ÿåˆå¹¶é‡åˆ°åƒç¾éš¾æ€§é—å¿˜è¿™æ ·çš„é—®é¢˜ã€‚å°è¯•æ¢ç´¢ä¸åŒçš„è¶…å‚æ•°ï¼Œä»¥è·å¾—æ‚¨æ•°æ®é›†çš„æœ€ä½³ç»“æœã€‚
- en: Kandinsky 2.2 is a multilingual text-to-image model capable of producing more
    photorealistic images. The model includes an image prior model for creating image
    embeddings from text prompts, and a decoder model that generates images based
    on the prior modelâ€™s embeddings. Thatâ€™s why youâ€™ll find two separate scripts in
    Diffusers for Kandinsky 2.2, one for training the prior model and one for training
    the decoder model. You can train both models separately, but to get the best results,
    you should train both the prior and decoder models.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Kandinsky 2.2æ˜¯ä¸€ä¸ªå¤šè¯­è¨€æ–‡æœ¬åˆ°å›¾åƒæ¨¡å‹ï¼Œèƒ½å¤Ÿç”Ÿæˆæ›´é€¼çœŸçš„å›¾åƒã€‚è¯¥æ¨¡å‹åŒ…æ‹¬ä¸€ä¸ªå›¾åƒå…ˆéªŒæ¨¡å‹ï¼Œç”¨äºä»æ–‡æœ¬æç¤ºåˆ›å»ºå›¾åƒåµŒå…¥ï¼Œä»¥åŠä¸€ä¸ªè§£ç å™¨æ¨¡å‹ï¼Œæ ¹æ®å…ˆéªŒæ¨¡å‹çš„åµŒå…¥ç”Ÿæˆå›¾åƒã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨Diffusersä¸­ä¸ºKandinsky
    2.2æä¾›äº†ä¸¤ä¸ªå•ç‹¬çš„è„šæœ¬ï¼Œä¸€ä¸ªç”¨äºè®­ç»ƒå…ˆéªŒæ¨¡å‹ï¼Œä¸€ä¸ªç”¨äºè®­ç»ƒè§£ç å™¨æ¨¡å‹ã€‚æ‚¨å¯ä»¥åˆ†åˆ«è®­ç»ƒè¿™ä¸¤ä¸ªæ¨¡å‹ï¼Œä½†ä¸ºäº†è·å¾—æœ€ä½³ç»“æœï¼Œæ‚¨åº”è¯¥åŒæ—¶è®­ç»ƒå…ˆéªŒå’Œè§£ç å™¨æ¨¡å‹ã€‚
- en: Depending on your GPU, you may need to enable `gradient_checkpointing` (âš ï¸ not
    supported for the prior model!), `mixed_precision`, and `gradient_accumulation_steps`
    to help fit the model into memory and to speedup training. You can reduce your
    memory-usage even more by enabling memory-efficient attention with [xFormers](../optimization/xformers)
    (version [v0.0.16](https://github.com/huggingface/diffusers/issues/2234#issuecomment-1416931212)
    fails for training on some GPUs so you may need to install a development version
    instead).
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®æ‚¨çš„GPUï¼Œæ‚¨å¯èƒ½éœ€è¦å¯ç”¨`gradient_checkpointing`ï¼ˆâš ï¸ä¸æ”¯æŒå…ˆå‰æ¨¡å‹ï¼ï¼‰ï¼Œ`mixed_precision`å’Œ`gradient_accumulation_steps`æ¥å¸®åŠ©å°†æ¨¡å‹é€‚åº”å†…å­˜å¹¶åŠ é€Ÿè®­ç»ƒã€‚æ‚¨è¿˜å¯ä»¥é€šè¿‡å¯ç”¨[xFormers](../optimization/xformers)çš„å†…å­˜é«˜æ•ˆæ³¨æ„åŠ›æ¥è¿›ä¸€æ­¥å‡å°‘å†…å­˜ä½¿ç”¨é‡ï¼ˆç‰ˆæœ¬[v0.0.16](https://github.com/huggingface/diffusers/issues/2234#issuecomment-1416931212)åœ¨æŸäº›GPUä¸Šè®­ç»ƒå¤±è´¥ï¼Œå› æ­¤æ‚¨å¯èƒ½éœ€è¦å®‰è£…å¼€å‘ç‰ˆæœ¬ï¼‰ã€‚
- en: This guide explores the [train_text_to_image_prior.py](https://github.com/huggingface/diffusers/blob/main/examples/kandinsky2_2/text_to_image/train_text_to_image_prior.py)
    and the [train_text_to_image_decoder.py](https://github.com/huggingface/diffusers/blob/main/examples/kandinsky2_2/text_to_image/train_text_to_image_decoder.py)
    scripts to help you become more familiar with it, and how you can adapt it for
    your own use-case.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬æŒ‡å—æ¢è®¨äº†[train_text_to_image_prior.py](https://github.com/huggingface/diffusers/blob/main/examples/kandinsky2_2/text_to_image/train_text_to_image_prior.py)å’Œ[train_text_to_image_decoder.py](https://github.com/huggingface/diffusers/blob/main/examples/kandinsky2_2/text_to_image/train_text_to_image_decoder.py)è„šæœ¬ï¼Œä»¥å¸®åŠ©æ‚¨æ›´ç†Ÿæ‚‰å®ƒï¼Œå¹¶äº†è§£å¦‚ä½•ä¸ºæ‚¨è‡ªå·±çš„ç”¨ä¾‹è¿›è¡Œè°ƒæ•´ã€‚
- en: 'Before running the scripts, make sure you install the library from source:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿è¡Œè„šæœ¬ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨ä»æºä»£ç å®‰è£…åº“ï¼š
- en: '[PRE0]'
  id: totrans-8
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Then navigate to the example folder containing the training script and install
    the required dependencies for the script youâ€™re using:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åå¯¼èˆªåˆ°åŒ…å«è®­ç»ƒè„šæœ¬çš„ç¤ºä¾‹æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸ºæ‚¨æ­£åœ¨ä½¿ç”¨çš„è„šæœ¬å®‰è£…æ‰€éœ€çš„ä¾èµ–é¡¹ï¼š
- en: '[PRE1]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: ğŸ¤— Accelerate is a library for helping you train on multiple GPUs/TPUs or with
    mixed-precision. Itâ€™ll automatically configure your training setup based on your
    hardware and environment. Take a look at the ğŸ¤— Accelerate [Quick tour](https://huggingface.co/docs/accelerate/quicktour)
    to learn more.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: ğŸ¤— Accelerateæ˜¯ä¸€ä¸ªå¸®åŠ©æ‚¨åœ¨å¤šä¸ªGPU/TPUä¸Šè¿›è¡Œè®­ç»ƒæˆ–ä½¿ç”¨æ··åˆç²¾åº¦çš„åº“ã€‚å®ƒå°†æ ¹æ®æ‚¨çš„ç¡¬ä»¶å’Œç¯å¢ƒè‡ªåŠ¨é…ç½®æ‚¨çš„è®­ç»ƒè®¾ç½®ã€‚æŸ¥çœ‹ğŸ¤— Accelerate
    [å¿«é€Ÿå…¥é—¨](https://huggingface.co/docs/accelerate/quicktour)ä»¥äº†è§£æ›´å¤šã€‚
- en: 'Initialize an ğŸ¤— Accelerate environment:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: åˆå§‹åŒ–ğŸ¤— Accelerateç¯å¢ƒï¼š
- en: '[PRE2]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'To setup a default ğŸ¤— Accelerate environment without choosing any configurations:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: è®¾ç½®é»˜è®¤ğŸ¤— Accelerateç¯å¢ƒè€Œä¸é€‰æ‹©ä»»ä½•é…ç½®ï¼š
- en: '[PRE3]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Or if your environment doesnâ€™t support an interactive shell, like a notebook,
    you can use:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ–è€…ï¼Œå¦‚æœæ‚¨çš„ç¯å¢ƒä¸æ”¯æŒäº¤äº’å¼shellï¼Œæ¯”å¦‚ç¬”è®°æœ¬ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ï¼š
- en: '[PRE4]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Lastly, if you want to train a model on your own dataset, take a look at the
    [Create a dataset for training](create_dataset) guide to learn how to create a
    dataset that works with the training script.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œå¦‚æœæ‚¨æƒ³åœ¨è‡ªå·±çš„æ•°æ®é›†ä¸Šè®­ç»ƒæ¨¡å‹ï¼Œè¯·æŸ¥çœ‹[åˆ›å»ºç”¨äºè®­ç»ƒçš„æ•°æ®é›†](create_dataset)æŒ‡å—ï¼Œäº†è§£å¦‚ä½•åˆ›å»ºä¸€ä¸ªé€‚ç”¨äºè®­ç»ƒè„šæœ¬çš„æ•°æ®é›†ã€‚
- en: The following sections highlight parts of the training scripts that are important
    for understanding how to modify it, but it doesnâ€™t cover every aspect of the scripts
    in detail. If youâ€™re interested in learning more, feel free to read through the
    scripts and let us know if you have any questions or concerns.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹éƒ¨åˆ†çªå‡ºæ˜¾ç¤ºäº†è®­ç»ƒè„šæœ¬çš„ä¸€äº›é‡è¦éƒ¨åˆ†ï¼Œä»¥å¸®åŠ©æ‚¨äº†è§£å¦‚ä½•ä¿®æ”¹å®ƒï¼Œä½†å¹¶æœªè¯¦ç»†æ¶µç›–è„šæœ¬çš„æ¯ä¸ªæ–¹é¢ã€‚å¦‚æœæ‚¨æœ‰å…´è¶£äº†è§£æ›´å¤šï¼Œè¯·éšæ—¶é˜…è¯»è„šæœ¬ï¼Œå¹¶å‘Šè¯‰æˆ‘ä»¬æ‚¨æ˜¯å¦æœ‰ä»»ä½•é—®é¢˜æˆ–ç–‘è™‘ã€‚
- en: Script parameters
  id: totrans-20
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è„šæœ¬å‚æ•°
- en: The training scripts provides many parameters to help you customize your training
    run. All of the parameters and their descriptions are found in the [`parse_args()`](https://github.com/huggingface/diffusers/blob/6e68c71503682c8693cb5b06a4da4911dfd655ee/examples/kandinsky2_2/text_to_image/train_text_to_image_prior.py#L190)
    function. The training scripts provides default values for each parameter, such
    as the training batch size and learning rate, but you can also set your own values
    in the training command if youâ€™d like.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: è®­ç»ƒè„šæœ¬æä¾›äº†è®¸å¤šå‚æ•°ï¼Œå¸®åŠ©æ‚¨è‡ªå®šä¹‰è®­ç»ƒè¿è¡Œã€‚æ‰€æœ‰å‚æ•°åŠå…¶æè¿°éƒ½å¯ä»¥åœ¨[`parse_args()`](https://github.com/huggingface/diffusers/blob/6e68c71503682c8693cb5b06a4da4911dfd655ee/examples/kandinsky2_2/text_to_image/train_text_to_image_prior.py#L190)å‡½æ•°ä¸­æ‰¾åˆ°ã€‚è®­ç»ƒè„šæœ¬ä¸ºæ¯ä¸ªå‚æ•°æä¾›äº†é»˜è®¤å€¼ï¼Œå¦‚è®­ç»ƒæ‰¹é‡å¤§å°å’Œå­¦ä¹ ç‡ï¼Œä½†å¦‚æœæ‚¨æ„¿æ„ï¼Œä¹Ÿå¯ä»¥åœ¨è®­ç»ƒå‘½ä»¤ä¸­è®¾ç½®è‡ªå·±çš„å€¼ã€‚
- en: 'For example, to speedup training with mixed precision using the fp16 format,
    add the `--mixed_precision` parameter to the training command:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œè¦ä½¿ç”¨fp16æ ¼å¼åŠ é€Ÿæ··åˆç²¾åº¦è®­ç»ƒï¼Œè¯·åœ¨è®­ç»ƒå‘½ä»¤ä¸­æ·»åŠ `--mixed_precision`å‚æ•°ï¼š
- en: '[PRE5]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Most of the parameters are identical to the parameters in the [Text-to-image](text2image#script-parameters)
    training guide, so letâ€™s get straight to a walkthrough of the Kandinsky training
    scripts!
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: å¤§å¤šæ•°å‚æ•°ä¸[æ–‡æœ¬åˆ°å›¾åƒ](text2image#script-parameters)è®­ç»ƒæŒ‡å—ä¸­çš„å‚æ•°ç›¸åŒï¼Œå› æ­¤è®©æˆ‘ä»¬ç›´æ¥å¼€å§‹Kandinskyè®­ç»ƒè„šæœ¬çš„æ¼”ç»ƒï¼
- en: Min-SNR weighting
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æœ€å°-SNRåŠ æƒ
- en: The [Min-SNR](https://huggingface.co/papers/2303.09556) weighting strategy can
    help with training by rebalancing the loss to achieve faster convergence. The
    training script supports predicting `epsilon` (noise) or `v_prediction`, but Min-SNR
    is compatible with both prediction types. This weighting strategy is only supported
    by PyTorch and is unavailable in the Flax training script.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '[Min-SNR](https://huggingface.co/papers/2303.09556)åŠ æƒç­–ç•¥å¯ä»¥é€šè¿‡é‡æ–°å¹³è¡¡æŸå¤±æ¥å¸®åŠ©è®­ç»ƒï¼Œä»¥å®ç°æ›´å¿«çš„æ”¶æ•›ã€‚è®­ç»ƒè„šæœ¬æ”¯æŒé¢„æµ‹`epsilon`ï¼ˆå™ªå£°ï¼‰æˆ–`v_prediction`ï¼Œä½†Min-SNRä¸ä¸¤ç§é¢„æµ‹ç±»å‹å…¼å®¹ã€‚è¿™ç§åŠ æƒç­–ç•¥ä»…å—PyTorchæ”¯æŒï¼Œåœ¨Flaxè®­ç»ƒè„šæœ¬ä¸­ä¸å¯ç”¨ã€‚'
- en: 'Add the `--snr_gamma` parameter and set it to the recommended value of 5.0:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: æ·»åŠ `--snr_gamma`å‚æ•°ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºæ¨èå€¼5.0ï¼š
- en: '[PRE6]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Training script
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®­ç»ƒè„šæœ¬
- en: The training script is also similar to the [Text-to-image](text2image#training-script)
    training guide, but itâ€™s been modified to support training the prior and decoder
    models. This guide focuses on the code that is unique to the Kandinsky 2.2 training
    scripts.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: è®­ç»ƒè„šæœ¬ä¹Ÿç±»ä¼¼äº[æ–‡æœ¬åˆ°å›¾åƒ](text2image#training-script)è®­ç»ƒæŒ‡å—ï¼Œä½†å·²ç»ä¿®æ”¹ä»¥æ”¯æŒè®­ç»ƒå…ˆéªŒå’Œè§£ç å™¨æ¨¡å‹ã€‚æœ¬æŒ‡å—ä¾§é‡äºKandinsky
    2.2è®­ç»ƒè„šæœ¬ä¸­ç‹¬ç‰¹çš„ä»£ç ã€‚
- en: prior modeldecoder model
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: å…ˆéªŒæ¨¡å‹è§£ç å™¨æ¨¡å‹
- en: The [`main()`](https://github.com/huggingface/diffusers/blob/6e68c71503682c8693cb5b06a4da4911dfd655ee/examples/kandinsky2_2/text_to_image/train_text_to_image_prior.py#L441)
    function contains the code for preparing the dataset and training the model.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '[`main()`](https://github.com/huggingface/diffusers/blob/6e68c71503682c8693cb5b06a4da4911dfd655ee/examples/kandinsky2_2/text_to_image/train_text_to_image_prior.py#L441)å‡½æ•°åŒ…å«å‡†å¤‡æ•°æ®é›†å’Œè®­ç»ƒæ¨¡å‹çš„ä»£ç ã€‚'
- en: 'One of the main differences youâ€™ll notice right away is that the training script
    also loads a [CLIPImageProcessor](https://huggingface.co/docs/transformers/v4.37.2/en/model_doc/clip#transformers.CLIPImageProcessor)
    - in addition to a scheduler and tokenizer - for preprocessing images and a [CLIPVisionModelWithProjection](https://huggingface.co/docs/transformers/v4.37.2/en/model_doc/clip#transformers.CLIPVisionModelWithProjection)
    model for encoding the images:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: æ‚¨ç«‹å³æ³¨æ„åˆ°çš„ä¸»è¦åŒºåˆ«ä¹‹ä¸€æ˜¯ï¼Œè®­ç»ƒè„šæœ¬è¿˜åŠ è½½äº†ä¸€ä¸ª[CLIPImageProcessor](https://huggingface.co/docs/transformers/v4.37.2/en/model_doc/clip#transformers.CLIPImageProcessor)
    - é™¤äº†è°ƒåº¦å™¨å’Œæ ‡è®°å™¨ä¹‹å¤– - ç”¨äºé¢„å¤„ç†å›¾åƒï¼Œä»¥åŠä¸€ä¸ª[CLIPVisionModelWithProjection](https://huggingface.co/docs/transformers/v4.37.2/en/model_doc/clip#transformers.CLIPVisionModelWithProjection)æ¨¡å‹ç”¨äºç¼–ç å›¾åƒï¼š
- en: '[PRE7]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Kandinsky uses a [PriorTransformer](/docs/diffusers/v0.26.3/en/api/models/prior_transformer#diffusers.PriorTransformer)
    to generate the image embeddings, so youâ€™ll want to setup the optimizer to learn
    the prior modeâ€™s parameters.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: Kandinskyä½¿ç”¨[PriorTransformer](/docs/diffusers/v0.26.3/en/api/models/prior_transformer#diffusers.PriorTransformer)ç”Ÿæˆå›¾åƒåµŒå…¥ï¼Œå› æ­¤æ‚¨éœ€è¦è®¾ç½®ä¼˜åŒ–å™¨æ¥å­¦ä¹ å…ˆéªŒæ¨¡å¼çš„å‚æ•°ã€‚
- en: '[PRE8]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Next, the input captions are tokenized, and images are [preprocessed](https://github.com/huggingface/diffusers/blob/6e68c71503682c8693cb5b06a4da4911dfd655ee/examples/kandinsky2_2/text_to_image/train_text_to_image_prior.py#L632)
    by the [CLIPImageProcessor](https://huggingface.co/docs/transformers/v4.37.2/en/model_doc/clip#transformers.CLIPImageProcessor):'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: æ¥ä¸‹æ¥ï¼Œè¾“å…¥æ ‡é¢˜è¢«æ ‡è®°åŒ–ï¼Œå›¾åƒç”±[CLIPImageProcessor](https://huggingface.co/docs/transformers/v4.37.2/en/model_doc/clip#transformers.CLIPImageProcessor)è¿›è¡Œ[é¢„å¤„ç†](https://github.com/huggingface/diffusers/blob/6e68c71503682c8693cb5b06a4da4911dfd655ee/examples/kandinsky2_2/text_to_image/train_text_to_image_prior.py#L632)ï¼š
- en: '[PRE9]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Finally, the [training loop](https://github.com/huggingface/diffusers/blob/6e68c71503682c8693cb5b06a4da4911dfd655ee/examples/kandinsky2_2/text_to_image/train_text_to_image_prior.py#L718)
    converts the input images into latents, adds noise to the image embeddings, and
    makes a prediction:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œ[è®­ç»ƒå¾ªç¯](https://github.com/huggingface/diffusers/blob/6e68c71503682c8693cb5b06a4da4911dfd655ee/examples/kandinsky2_2/text_to_image/train_text_to_image_prior.py#L718)å°†è¾“å…¥å›¾åƒè½¬æ¢ä¸ºæ½œå˜é‡ï¼Œå‘å›¾åƒåµŒå…¥æ·»åŠ å™ªå£°ï¼Œå¹¶è¿›è¡Œé¢„æµ‹ï¼š
- en: '[PRE10]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: If you want to learn more about how the training loop works, check out the [Understanding
    pipelines, models and schedulers](../using-diffusers/write_own_pipeline) tutorial
    which breaks down the basic pattern of the denoising process.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ‚¨æƒ³äº†è§£è®­ç»ƒå¾ªç¯çš„å·¥ä½œåŸç†ï¼Œè¯·æŸ¥çœ‹[äº†è§£ç®¡é“ã€æ¨¡å‹å’Œè°ƒåº¦å™¨](../using-diffusers/write_own_pipeline)æ•™ç¨‹ï¼Œè¯¥æ•™ç¨‹è¯¦ç»†ä»‹ç»äº†å»å™ªè¿‡ç¨‹çš„åŸºæœ¬æ¨¡å¼ã€‚
- en: Launch the script
  id: totrans-42
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¯åŠ¨è„šæœ¬
- en: Once youâ€™ve made all your changes or youâ€™re okay with the default configuration,
    youâ€™re ready to launch the training script! ğŸš€
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦æ‚¨å®Œæˆæ‰€æœ‰æ›´æ”¹æˆ–å¯¹é»˜è®¤é…ç½®æ»¡æ„ï¼Œæ‚¨å°±å¯ä»¥å¯åŠ¨è®­ç»ƒè„šæœ¬ï¼ğŸš€
- en: Youâ€™ll train on the [PokÃ©mon BLIP captions](https://huggingface.co/datasets/lambdalabs/pokemon-blip-captions)
    dataset to generate your own PokÃ©mon, but you can also create and train on your
    own dataset by following the [Create a dataset for training](create_dataset) guide.
    Set the environment variable `DATASET_NAME` to the name of the dataset on the
    Hub or if youâ€™re training on your own files, set the environment variable `TRAIN_DIR`
    to a path to your dataset.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: æ‚¨å°†åœ¨[PokÃ©mon BLIPæ ‡é¢˜](https://huggingface.co/datasets/lambdalabs/pokemon-blip-captions)æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒï¼Œä»¥ç”Ÿæˆæ‚¨è‡ªå·±çš„
    PokÃ©monï¼Œä½†æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡æŒ‰ç…§[åˆ›å»ºç”¨äºè®­ç»ƒçš„æ•°æ®é›†](create_dataset)æŒ‡å—æ¥åˆ›å»ºå’Œè®­ç»ƒè‡ªå·±çš„æ•°æ®é›†ã€‚å°†ç¯å¢ƒå˜é‡`DATASET_NAME`è®¾ç½®ä¸ºHubä¸Šæ•°æ®é›†çš„åç§°ï¼Œæˆ–è€…å¦‚æœæ‚¨åœ¨è‡ªå·±çš„æ–‡ä»¶ä¸Šè¿›è¡Œè®­ç»ƒï¼Œè¯·å°†ç¯å¢ƒå˜é‡`TRAIN_DIR`è®¾ç½®ä¸ºæ•°æ®é›†çš„è·¯å¾„ã€‚
- en: If youâ€™re training on more than one GPU, add the `--multi_gpu` parameter to
    the `accelerate launch` command.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ‚¨åœ¨å¤šä¸ªGPUä¸Šè¿›è¡Œè®­ç»ƒï¼Œè¯·åœ¨`accelerate launch`å‘½ä»¤ä¸­æ·»åŠ `--multi_gpu`å‚æ•°ã€‚
- en: To monitor training progress with Weights & Biases, add the `--report_to=wandb`
    parameter to the training command. Youâ€™ll also need to add the `--validation_prompt`
    to the training command to keep track of results. This can be really useful for
    debugging the model and viewing intermediate results.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: è¦ä½¿ç”¨Weights & Biasesç›‘è§†è®­ç»ƒè¿›åº¦ï¼Œè¯·åœ¨è®­ç»ƒå‘½ä»¤ä¸­æ·»åŠ `--report_to=wandb`å‚æ•°ã€‚æ‚¨è¿˜éœ€è¦åœ¨è®­ç»ƒå‘½ä»¤ä¸­æ·»åŠ `--validation_prompt`ä»¥è·Ÿè¸ªç»“æœã€‚è¿™å¯¹äºè°ƒè¯•æ¨¡å‹å’ŒæŸ¥çœ‹ä¸­é—´ç»“æœéå¸¸æœ‰ç”¨ã€‚
- en: prior modeldecoder model
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: å…ˆéªŒæ¨¡å‹è§£ç å™¨æ¨¡å‹
- en: '[PRE11]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Once training is finished, you can use your newly trained model for inference!
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: è®­ç»ƒå®Œæˆåï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ–°è®­ç»ƒçš„æ¨¡å‹è¿›è¡Œæ¨æ–­ï¼
- en: prior modeldecoder model
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: å…ˆéªŒæ¨¡å‹è§£ç å™¨æ¨¡å‹
- en: '[PRE12]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Feel free to replace `kandinsky-community/kandinsky-2-2-decoder` with your own
    trained decoder checkpoint!
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: è¯·éšæ„å°†`kandinsky-community/kandinsky-2-2-decoder`æ›¿æ¢ä¸ºæ‚¨è‡ªå·±è®­ç»ƒçš„è§£ç å™¨æ£€æŸ¥ç‚¹ï¼
- en: Next steps
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä¸‹ä¸€æ­¥
- en: 'Congratulations on training a Kandinsky 2.2 model! To learn more about how
    to use your new model, the following guides may be helpful:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: ç¥è´ºæ‚¨è®­ç»ƒäº†ä¸€ä¸ªKandinsky 2.2æ¨¡å‹ï¼è¦äº†è§£å¦‚ä½•ä½¿ç”¨æ‚¨çš„æ–°æ¨¡å‹ï¼Œä»¥ä¸‹æŒ‡å—å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ï¼š
- en: Read the [Kandinsky](../using-diffusers/kandinsky) guide to learn how to use
    it for a variety of different tasks (text-to-image, image-to-image, inpainting,
    interpolation), and how it can be combined with a ControlNet.
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é˜…è¯»[Kandinsky](../using-diffusers/kandinsky)æŒ‡å—ï¼Œäº†è§£å¦‚ä½•å°†å…¶ç”¨äºå„ç§ä¸åŒä»»åŠ¡ï¼ˆæ–‡æœ¬åˆ°å›¾åƒï¼Œå›¾åƒåˆ°å›¾åƒï¼Œä¿®è¡¥ï¼Œæ’å€¼ï¼‰ï¼Œä»¥åŠå¦‚ä½•ä¸ControlNetç»“åˆä½¿ç”¨ã€‚
- en: Check out the [DreamBooth](dreambooth) and [LoRA](lora) training guides to learn
    how to train a personalized Kandinsky model with just a few example images. These
    two training techniques can even be combined!
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æŸ¥çœ‹[DreamBooth](dreambooth)å’Œ[LoRA](lora)åŸ¹è®­æŒ‡å—ï¼Œå­¦ä¹ å¦‚ä½•ä»…ä½¿ç”¨å‡ ä¸ªç¤ºä¾‹å›¾åƒè®­ç»ƒä¸ªæ€§åŒ–çš„Kandinskyæ¨¡å‹ã€‚ç”šè‡³å¯ä»¥ç»“åˆè¿™ä¸¤ç§è®­ç»ƒæŠ€æœ¯ï¼
