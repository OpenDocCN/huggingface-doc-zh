- en: Metrics
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æŒ‡æ ‡
- en: 'Original text: [https://huggingface.co/docs/datasets/how_to_metrics](https://huggingface.co/docs/datasets/how_to_metrics)'
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸå§‹æ–‡æœ¬ï¼š[https://huggingface.co/docs/datasets/how_to_metrics](https://huggingface.co/docs/datasets/how_to_metrics)
- en: null
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: Metrics is deprecated in ğŸ¤— Datasets. To learn more about how to use metrics,
    take a look at the library ğŸ¤— [Evaluate](https://huggingface.co/docs/evaluate/index)!
    In addition to metrics, you can find more tools for evaluating models and datasets.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: ğŸ¤— Datasetsä¸­çš„Metricså·²è¢«å¼ƒç”¨ã€‚è¦äº†è§£å¦‚ä½•ä½¿ç”¨æŒ‡æ ‡ï¼Œè¯·æŸ¥çœ‹åº“ğŸ¤— [Evaluate](https://huggingface.co/docs/evaluate/index)ï¼é™¤äº†æŒ‡æ ‡ï¼Œæ‚¨è¿˜å¯ä»¥æ‰¾åˆ°æ›´å¤šç”¨äºè¯„ä¼°æ¨¡å‹å’Œæ•°æ®é›†çš„å·¥å…·ã€‚
- en: Metrics are important for evaluating a modelâ€™s predictions. In the tutorial,
    you learned how to compute a metric over an entire evaluation set. You have also
    seen how to load a metric.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: æŒ‡æ ‡å¯¹äºè¯„ä¼°æ¨¡å‹çš„é¢„æµ‹éå¸¸é‡è¦ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæ‚¨å­¦ä¹ äº†å¦‚ä½•åœ¨æ•´ä¸ªè¯„ä¼°é›†ä¸Šè®¡ç®—æŒ‡æ ‡ã€‚æ‚¨è¿˜çœ‹åˆ°äº†å¦‚ä½•åŠ è½½æŒ‡æ ‡ã€‚
- en: 'This guide will show you how to:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬æŒ‡å—å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ï¼š
- en: Add predictions and references.
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ·»åŠ é¢„æµ‹å’Œå‚è€ƒã€‚
- en: Compute metrics using different methods.
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ä¸åŒçš„æ–¹æ³•è®¡ç®—æŒ‡æ ‡ã€‚
- en: Write your own metric loading script.
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç¼–å†™æ‚¨è‡ªå·±çš„æŒ‡æ ‡åŠ è½½è„šæœ¬ã€‚
- en: Add predictions and references
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ·»åŠ é¢„æµ‹å’Œå‚è€ƒ
- en: 'When you want to add model predictions and references to a [Metric](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Metric)
    instance, you have two options:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æ‚¨æƒ³è¦å°†æ¨¡å‹é¢„æµ‹å’Œå‚è€ƒæ·»åŠ åˆ°[Metric](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Metric)å®ä¾‹æ—¶ï¼Œæ‚¨æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼š
- en: '[Metric.add()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Metric.add)
    adds a single `prediction` and `reference`.'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Metric.add()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Metric.add)æ·»åŠ å•ä¸ª`prediction`å’Œ`reference`ã€‚'
- en: '[Metric.add_batch()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Metric.add_batch)
    adds a batch of `predictions` and `references`.'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Metric.add_batch()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Metric.add_batch)æ·»åŠ ä¸€æ‰¹`predictions`å’Œ`references`ã€‚'
- en: 'Use [Metric.add_batch()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Metric.add_batch)
    by passing it your model predictions, and the references the model predictions
    should be evaluated against:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: é€šè¿‡ä½¿ç”¨[Metric.add_batch()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Metric.add_batch)ï¼Œä¼ é€’æ‚¨çš„æ¨¡å‹é¢„æµ‹å’Œæ¨¡å‹é¢„æµ‹åº”è¯¥è¢«è¯„ä¼°çš„å‚è€ƒï¼š
- en: '[PRE0]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Metrics accepts various input formats (Python lists, NumPy arrays, PyTorch tensors,
    etc.) and converts them to an appropriate format for storage and computation.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: æŒ‡æ ‡æ¥å—å„ç§è¾“å…¥æ ¼å¼ï¼ˆPythonåˆ—è¡¨ã€NumPyæ•°ç»„ã€PyTorchå¼ é‡ç­‰ï¼‰ï¼Œå¹¶å°†å®ƒä»¬è½¬æ¢ä¸ºé€‚åˆå­˜å‚¨å’Œè®¡ç®—çš„æ ¼å¼ã€‚
- en: Compute scores
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®¡ç®—åˆ†æ•°
- en: The most straightforward way to calculate a metric is to call [Metric.compute()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Metric.compute).
    But some metrics have additional arguments that allow you to modify the metrics
    behavior.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—æŒ‡æ ‡çš„æœ€ç›´æ¥æ–¹æ³•æ˜¯è°ƒç”¨[Metric.compute()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Metric.compute)ã€‚ä½†æ˜¯æœ‰äº›æŒ‡æ ‡å…·æœ‰é¢å¤–çš„å‚æ•°ï¼Œå…è®¸æ‚¨ä¿®æ”¹æŒ‡æ ‡çš„è¡Œä¸ºã€‚
- en: Letâ€™s load the [SacreBLEU](https://huggingface.co/metrics/sacrebleu) metric,
    and compute it with a different smoothing method.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åŠ è½½[SacreBLEU](https://huggingface.co/metrics/sacrebleu)æŒ‡æ ‡ï¼Œå¹¶ä½¿ç”¨ä¸åŒçš„å¹³æ»‘æ–¹æ³•è®¡ç®—å®ƒã€‚
- en: 'Load the SacreBLEU metric:'
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åŠ è½½SacreBLEUæŒ‡æ ‡ï¼š
- en: '[PRE1]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Inspect the different argument methods for computing the metric:'
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ£€æŸ¥ç”¨äºè®¡ç®—æŒ‡æ ‡çš„ä¸åŒå‚æ•°æ–¹æ³•ï¼š
- en: '[PRE2]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Compute the metric with the `floor` method, and a different `smooth_value`:'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨`floor`æ–¹æ³•è®¡ç®—æŒ‡æ ‡ï¼Œå¹¶ä½¿ç”¨ä¸åŒçš„`smooth_value`ï¼š
- en: '[PRE3]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Custom metric loading script
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è‡ªå®šä¹‰æŒ‡æ ‡åŠ è½½è„šæœ¬
- en: Write a metric loading script to use your own custom metric (or one that is
    not on the Hub). Then you can load it as usual with [load_metric()](/docs/datasets/v2.17.0/en/package_reference/loading_methods#datasets.load_metric).
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: ç¼–å†™ä¸€ä¸ªæŒ‡æ ‡åŠ è½½è„šæœ¬æ¥ä½¿ç”¨æ‚¨è‡ªå·±çš„è‡ªå®šä¹‰æŒ‡æ ‡ï¼ˆæˆ–è€…ä¸åœ¨Hubä¸Šçš„æŒ‡æ ‡ï¼‰ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥åƒå¾€å¸¸ä¸€æ ·ä½¿ç”¨[load_metric()](/docs/datasets/v2.17.0/en/package_reference/loading_methods#datasets.load_metric)åŠ è½½å®ƒã€‚
- en: To help you get started, open the [SQuAD metric loading script](https://github.com/huggingface/datasets/blob/main/metrics/squad/squad.py)
    and follow along.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†å¸®åŠ©æ‚¨å…¥é—¨ï¼Œè¯·æ‰“å¼€[SQuADæŒ‡æ ‡åŠ è½½è„šæœ¬](https://github.com/huggingface/datasets/blob/main/metrics/squad/squad.py)ï¼Œå¹¶è·Ÿéšæ“ä½œã€‚
- en: Get jump started with our metric loading script [template](https://github.com/huggingface/datasets/blob/f9713d2e23813142a02f1b0e965095f528785cff/templates/new_metric_script.py)!
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨æˆ‘ä»¬çš„æŒ‡æ ‡åŠ è½½è„šæœ¬[æ¨¡æ¿](https://github.com/huggingface/datasets/blob/f9713d2e23813142a02f1b0e965095f528785cff/templates/new_metric_script.py)å¿«é€Ÿå…¥é—¨ï¼
- en: Add metric attributes
  id: totrans-29
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ·»åŠ æŒ‡æ ‡å±æ€§
- en: 'Start by adding some information about your metric in `Metric._info()`. The
    most important attributes you should specify are:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆåœ¨`Metric._info()`ä¸­æ·»åŠ æœ‰å…³æ‚¨çš„æŒ‡æ ‡çš„ä¸€äº›ä¿¡æ¯ã€‚æ‚¨åº”è¯¥æŒ‡å®šçš„æœ€é‡è¦å±æ€§æ˜¯ï¼š
- en: '`MetricInfo.description` provides a brief description about your metric.'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`MetricInfo.description`æä¾›æœ‰å…³æ‚¨çš„æŒ‡æ ‡çš„ç®€è¦æè¿°ã€‚'
- en: '`MetricInfo.citation` contains a BibTex citation for the metric.'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`MetricInfo.citation`åŒ…å«æŒ‡æ ‡çš„BibTexå¼•ç”¨ã€‚'
- en: '`MetricInfo.inputs_description` describes the expected inputs and outputs.
    It may also provide an example usage of the metric.'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`MetricInfo.inputs_description`æè¿°äº†é¢„æœŸçš„è¾“å…¥å’Œè¾“å‡ºã€‚å®ƒè¿˜å¯èƒ½æä¾›æŒ‡æ ‡çš„ç¤ºä¾‹ç”¨æ³•ã€‚'
- en: '`MetricInfo.features` defines the name and type of the predictions and references.'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`MetricInfo.features`å®šä¹‰äº†é¢„æµ‹å’Œå‚è€ƒçš„åç§°å’Œç±»å‹ã€‚'
- en: 'After youâ€™ve filled out all these fields in the template, it should look like
    the following example from the SQuAD metric script:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ¨¡æ¿ä¸­å¡«å†™æ‰€æœ‰è¿™äº›å­—æ®µåï¼Œå®ƒåº”è¯¥çœ‹èµ·æ¥åƒæ¥è‡ªSQuADæŒ‡æ ‡è„šæœ¬çš„ä»¥ä¸‹ç¤ºä¾‹ï¼š
- en: '[PRE4]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Download metric files
  id: totrans-37
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ä¸‹è½½æŒ‡æ ‡æ–‡ä»¶
- en: If your metric needs to download, or retrieve local files, you will need to
    use the `Metric._download_and_prepare()` method. For this example, letâ€™s examine
    the [BLEURT metric loading script](https://github.com/huggingface/datasets/blob/main/metrics/bleurt/bleurt.py).
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ‚¨çš„æŒ‡æ ‡éœ€è¦ä¸‹è½½æˆ–æ£€ç´¢æœ¬åœ°æ–‡ä»¶ï¼Œåˆ™éœ€è¦ä½¿ç”¨`Metric._download_and_prepare()`æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬æŸ¥çœ‹[BLEURTæŒ‡æ ‡åŠ è½½è„šæœ¬](https://github.com/huggingface/datasets/blob/main/metrics/bleurt/bleurt.py)ã€‚
- en: 'Provide a dictionary of URLs that point to the metric files:'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æä¾›æŒ‡å‘æŒ‡æ ‡æ–‡ä»¶çš„URLå­—å…¸ï¼š
- en: '[PRE5]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: If the files are stored locally, provide a dictionary of path(s) instead of
    URLs.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ–‡ä»¶å­˜å‚¨åœ¨æœ¬åœ°ï¼Œè¯·æä¾›ä¸€ä¸ªè·¯å¾„å­—å…¸ï¼Œè€Œä¸æ˜¯URLã€‚
- en: '`Metric._download_and_prepare()` will take the URLs and download the metric
    files specified:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`Metric._download_and_prepare()`å°†è·å–URLå¹¶ä¸‹è½½æŒ‡å®šçš„æŒ‡æ ‡æ–‡ä»¶ï¼š'
- en: '[PRE6]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Compute score
  id: totrans-44
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: è®¡ç®—åˆ†æ•°
- en: '`DatasetBuilder._compute` provides the actual instructions for how to compute
    a metric given the predictions and references. Now letâ€™s take a look at the [GLUE
    metric loading script](https://github.com/huggingface/datasets/blob/main/metrics/glue/glue.py).'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '`DatasetBuilder._compute` æä¾›äº†å¦‚ä½•æ ¹æ®é¢„æµ‹å’Œå‚è€ƒè®¡ç®—æŒ‡æ ‡çš„å®é™…æŒ‡ä»¤ã€‚ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ [GLUE æŒ‡æ ‡åŠ è½½è„šæœ¬](https://github.com/huggingface/datasets/blob/main/metrics/glue/glue.py)ã€‚'
- en: 'Provide the functions for `DatasetBuilder._compute` to calculate your metric:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æä¾›ç”¨äº `DatasetBuilder._compute` è®¡ç®—æ‚¨çš„æŒ‡æ ‡çš„å‡½æ•°ï¼š
- en: '[PRE7]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Create `DatasetBuilder._compute` with instructions for what metric to calculate
    for each configuration:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä¸ºæ¯ä¸ªé…ç½®åˆ›å»ºå¸¦æœ‰è®¡ç®—æŒ‡æ ‡æŒ‡ä»¤çš„ `DatasetBuilder._compute`ï¼š
- en: '[PRE8]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Test
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æµ‹è¯•
- en: 'Once youâ€™re finished writing your metric loading script, try to load it locally:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦æ‚¨å®Œæˆç¼–å†™æŒ‡æ ‡åŠ è½½è„šæœ¬ï¼Œè¯·å°è¯•åœ¨æœ¬åœ°åŠ è½½ï¼š
- en: '[PRE9]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
