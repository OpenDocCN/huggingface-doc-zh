- en: Models
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模型
- en: 'Original text: [https://huggingface.co/docs/diffusers/api/models/overview](https://huggingface.co/docs/diffusers/api/models/overview)'
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文链接：[https://huggingface.co/docs/diffusers/api/models/overview](https://huggingface.co/docs/diffusers/api/models/overview)
- en: null
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: 🤗 Diffusers provides pretrained models for popular algorithms and modules to
    create custom diffusion systems. The primary function of models is to denoise
    an input sample as modeled by the distribution <math><semantics><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo
    stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi
    mathvariant="normal">∣</mi><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation
    encoding="application/x-tex">p_{\theta}(x_{t-1}|x_{t})</annotation></semantics></math>pθ​(xt−1​∣xt​).
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 🤗 Diffusers为流行的算法和模块提供预训练模型，以创建自定义扩散系统。模型的主要功能是去噪输入样本，其模型由分布<math><semantics><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo
    stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mi
    mathvariant="normal">∣</mi><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation
    encoding="application/x-tex">p_{\theta}(x_{t-1}|x_{t})</annotation></semantics></math>pθ​(xt−1​∣xt​)建模。
- en: All models are built from the base [ModelMixin](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.ModelMixin)
    class which is a [`torch.nn.Module`](https://pytorch.org/docs/stable/generated/torch.nn.Module.html)
    providing basic functionality for saving and loading models, locally and from
    the Hugging Face Hub.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 所有模型都是从基础[ModelMixin](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.ModelMixin)类构建的，该类是一个[`torch.nn.Module`](https://pytorch.org/docs/stable/generated/torch.nn.Module.html)，提供了保存和加载模型的基本功能，可以在本地和从Hugging
    Face Hub中加载。
- en: ModelMixin
  id: totrans-5
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ModelMixin
- en: '### `class diffusers.ModelMixin`'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '### `class diffusers.ModelMixin`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L186)'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '[<来源>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L186)'
- en: '[PRE0]'
  id: totrans-8
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Base class for all models.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 所有模型的基类。
- en: '[ModelMixin](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.ModelMixin)
    takes care of storing the model configuration and provides methods for loading,
    downloading and saving models.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '[ModelMixin](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.ModelMixin)负责存储模型配置，并提供了加载、下载和保存模型的方法。'
- en: '`config_name` (`str`) — Filename to save a model to when calling [save_pretrained()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.ModelMixin.save_pretrained).'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`config_name` (`str`) — 在调用[save_pretrained()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.ModelMixin.save_pretrained)时保存模型的文件名。'
- en: '#### `disable_gradient_checkpointing`'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '#### `disable_gradient_checkpointing`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L238)'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '[<来源>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L238)'
- en: '[PRE1]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Deactivates gradient checkpointing for the current model (may be referred to
    as *activation checkpointing* or *checkpoint activations* in other frameworks).
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 为当前模型停用梯度检查点（在其他框架中可能被称为*激活检查点*或*检查点激活*）。
- en: '#### `disable_xformers_memory_efficient_attention`'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '#### `disable_xformers_memory_efficient_attention`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L299)'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '[<来源>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L299)'
- en: '[PRE2]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Disable memory efficient attention from [xFormers](https://facebookresearch.github.io/xformers/).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 从[xFormers](https://facebookresearch.github.io/xformers/)禁用内存高效的注意力。
- en: '#### `enable_gradient_checkpointing`'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '#### `enable_gradient_checkpointing`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L229)'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '[<来源>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L229)'
- en: '[PRE3]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Activates gradient checkpointing for the current model (may be referred to as
    *activation checkpointing* or *checkpoint activations* in other frameworks).
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 为当前模型激活梯度检查点（在其他框架中可能被称为*激活检查点*或*检查点激活*）。
- en: '#### `enable_xformers_memory_efficient_attention`'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '#### `enable_xformers_memory_efficient_attention`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L263)'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '[<来源>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L263)'
- en: '[PRE4]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Parameters
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 参数
- en: '`attention_op` (`Callable`, *optional*) — Override the default `None` operator
    for use as `op` argument to the [`memory_efficient_attention()`](https://facebookresearch.github.io/xformers/components/ops.html#xformers.ops.memory_efficient_attention)
    function of xFormers.'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`attention_op` (`Callable`, *optional*) — 用作xFormers的[`memory_efficient_attention()`](https://facebookresearch.github.io/xformers/components/ops.html#xformers.ops.memory_efficient_attention)函数的`op`参数的默认`None`运算符的覆盖。'
- en: Enable memory efficient attention from [xFormers](https://facebookresearch.github.io/xformers/).
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 从[xFormers](https://facebookresearch.github.io/xformers/)启用内存高效的注意力。
- en: When this option is enabled, you should observe lower GPU memory usage and a
    potential speed up during inference. Speed up during training is not guaranteed.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 启用此选项时，您应该观察到较低的GPU内存使用量，并且在推断期间可能会加速。不能保证在训练期间加速。
- en: ⚠️ When memory efficient attention and sliced attention are both enabled, memory
    efficient attention takes precedent.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: ⚠️ 当内存高效的注意力和切片注意力都启用时，内存高效的注意力优先。
- en: 'Examples:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE5]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '#### `from_pretrained`'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '#### `from_pretrained`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L393)'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '[<来源>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L393)'
- en: '[PRE6]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Parameters
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 参数
- en: '`pretrained_model_name_or_path` (`str` or `os.PathLike`, *optional*) — Can
    be either:'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pretrained_model_name_or_path` (`str`或`os.PathLike`, *optional*) — 可以是：'
- en: A string, the *model id* (for example `google/ddpm-celebahq-256`) of a pretrained
    model hosted on the Hub.
  id: totrans-39
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个字符串，预训练模型在Hub上托管的*模型id*（例如`google/ddpm-celebahq-256`）。
- en: A path to a *directory* (for example `./my_model_directory`) containing the
    model weights saved with [save_pretrained()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.ModelMixin.save_pretrained).
  id: totrans-40
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个*目录*路径（例如`./my_model_directory`），其中包含使用[save_pretrained()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.ModelMixin.save_pretrained)保存的模型权重。
- en: '`cache_dir` (`Union[str, os.PathLike]`, *optional*) — Path to a directory where
    a downloaded pretrained model configuration is cached if the standard cache is
    not used.'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`cache_dir` (`Union[str, os.PathLike]`, *optional*) — 如果不使用标准缓存，则下载的预训练模型配置将被缓存在其中的目录路径。'
- en: '`torch_dtype` (`str` or `torch.dtype`, *optional*) — Override the default `torch.dtype`
    and load the model with another dtype. If `"auto"` is passed, the dtype is automatically
    derived from the model’s weights.'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`torch_dtype` (`str` 或 `torch.dtype`, *可选*) — 覆盖默认的 `torch.dtype` 并使用另一种 dtype
    加载模型。如果传递 `"auto"`，dtype 将自动从模型的权重中派生。'
- en: '`force_download` (`bool`, *optional*, defaults to `False`) — Whether or not
    to force the (re-)download of the model weights and configuration files, overriding
    the cached versions if they exist.'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`force_download` (`bool`, *可选*, 默认为 `False`) — 是否强制（重新）下载模型权重和配置文件，覆盖缓存版本（如果存在）。'
- en: '`resume_download` (`bool`, *optional*, defaults to `False`) — Whether or not
    to resume downloading the model weights and configuration files. If set to `False`,
    any incompletely downloaded files are deleted.'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`resume_download` (`bool`, *可选*, 默认为 `False`) — 是否恢复下载模型权重和配置文件。如果设置为 `False`，任何未完全下载的文件将被删除。'
- en: '`proxies` (`Dict[str, str]`, *optional*) — A dictionary of proxy servers to
    use by protocol or endpoint, for example, `{''http'': ''foo.bar:3128'', ''http://hostname'':
    ''foo.bar:4012''}`. The proxies are used on each request.'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`proxies` (`Dict[str, str]`, *可选*) — 一个按协议或端点使用的代理服务器字典，例如，`{''http'': ''foo.bar:3128'',
    ''http://hostname'': ''foo.bar:4012''}`。代理将在每个请求中使用。'
- en: '`output_loading_info` (`bool`, *optional*, defaults to `False`) — Whether or
    not to also return a dictionary containing missing keys, unexpected keys and error
    messages.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`output_loading_info` (`bool`, *可选*, 默认为 `False`) — 是否还返回一个包含缺失键、意外键和错误消息的字典。'
- en: '`local_files_only(bool,` *optional*, defaults to `False`) — Whether to only
    load local model weights and configuration files or not. If set to `True`, the
    model won’t be downloaded from the Hub.'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`local_files_only(bool,` *可选*, 默认为 `False`) — 是否仅加载本地模型权重和配置文件。如果设置为 `True`，则不会从
    Hub 下载模型。'
- en: '`token` (`str` or *bool*, *optional*) — The token to use as HTTP bearer authorization
    for remote files. If `True`, the token generated from `diffusers-cli login` (stored
    in `~/.huggingface`) is used.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`token` (`str` 或 *bool*, *可选*) — 用作远程文件的 HTTP bearer 授权的令牌。如果为 `True`，则使用从
    `diffusers-cli login` 生成的令牌（存储在 `~/.huggingface`）。'
- en: '`revision` (`str`, *optional*, defaults to `"main"`) — The specific model version
    to use. It can be a branch name, a tag name, a commit id, or any identifier allowed
    by Git.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`revision` (`str`, *可选*, 默认为 `"main"`) — 要使用的特定模型版本。可以是分支名称、标签名称、提交 ID 或 Git
    允许的任何标识符。'
- en: '`from_flax` (`bool`, *optional*, defaults to `False`) — Load the model weights
    from a Flax checkpoint save file.'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`from_flax` (`bool`, *可选*, 默认为 `False`) — 从 Flax 检查点保存文件加载模型权重。'
- en: '`subfolder` (`str`, *optional*, defaults to `""`) — The subfolder location
    of a model file within a larger model repository on the Hub or locally.'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`subfolder` (`str`, *可选*, 默认为 `""`) — Hub 或本地较大模型存储库中模型文件的子文件夹位置。'
- en: '`mirror` (`str`, *optional*) — Mirror source to resolve accessibility issues
    if you’re downloading a model in China. We do not guarantee the timeliness or
    safety of the source, and you should refer to the mirror site for more information.'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`mirror` (`str`, *可选*) — 镜像源以解决在中国下载模型时的可访问性问题。我们不保证源的及时性或安全性，您应参考镜像站点获取更多信息。'
- en: '`device_map` (`str` or `Dict[str, Union[int, str, torch.device]]`, *optional*)
    — A map that specifies where each submodule should go. It doesn’t need to be defined
    for each parameter/buffer name; once a given module name is inside, every submodule
    of it will be sent to the same device.'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`device_map` (`str` 或 `Dict[str, Union[int, str, torch.device]]`, *可选*) — 一个指定每个子模块应该放在哪里的映射。不需要为每个参数/缓冲区名称定义；一旦给定模块名称在内部，它的每个子模块都将被发送到相同的设备。'
- en: Set `device_map="auto"` to have 🤗 Accelerate automatically compute the most
    optimized `device_map`. For more information about each option see [designing
    a device map](https://hf.co/docs/accelerate/main/en/usage_guides/big_modeling#designing-a-device-map).
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 设置 `device_map="auto"` 以使 🤗 Accelerate 自动计算最优化的 `device_map`。有关每个选项的更多信息，请参阅[设计设备映射](https://hf.co/docs/accelerate/main/en/usage_guides/big_modeling#designing-a-device-map)。
- en: '`max_memory` (`Dict`, *optional*) — A dictionary device identifier for the
    maximum memory. Will default to the maximum memory available for each GPU and
    the available CPU RAM if unset.'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`max_memory` (`Dict`, *可选*) — 用于最大内存的设备标识符字典。如果未设置，将默认为每个 GPU 和可用 CPU RAM 的最大内存。'
- en: '`offload_folder` (`str` or `os.PathLike`, *optional*) — The path to offload
    weights if `device_map` contains the value `"disk"`.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`offload_folder` (`str` 或 `os.PathLike`, *可选*) — 如果 `device_map` 包含值 `"disk"`，则是卸载权重的路径。'
- en: '`offload_state_dict` (`bool`, *optional*) — If `True`, temporarily offloads
    the CPU state dict to the hard drive to avoid running out of CPU RAM if the weight
    of the CPU state dict + the biggest shard of the checkpoint does not fit. Defaults
    to `True` when there is some disk offload.'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`offload_state_dict` (`bool`, *可选*) — 如果为 `True`，则临时将 CPU 状态字典转移到硬盘以避免 CPU
    RAM 不足，如果 CPU 状态字典的重量 + 检查点的最大分片的重量不适合。当存在一些磁盘卸载时，默认为 `True`。'
- en: '`low_cpu_mem_usage` (`bool`, *optional*, defaults to `True` if torch version
    >= 1.9.0 else `False`) — Speed up model loading only loading the pretrained weights
    and not initializing the weights. This also tries to not use more than 1x model
    size in CPU memory (including peak memory) while loading the model. Only supported
    for PyTorch >= 1.9.0\. If you are using an older version of PyTorch, setting this
    argument to `True` will raise an error.'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`low_cpu_mem_usage` (`bool`, *可选*, 如果 torch 版本 >= 1.9.0 则默认为 `True`，否则为 `False`)
    — 加速模型加载，仅加载预训练权重而不初始化权重。在加载模型时，还尝试不使用超过 CPU 内存中的 1x 模型大小（包括峰值内存）。仅支持 PyTorch
    >= 1.9.0。如果您使用较旧版本的 PyTorch，将此参数设置为 `True` 将引发错误。'
- en: '`variant` (`str`, *optional*) — Load weights from a specified `variant` filename
    such as `"fp16"` or `"ema"`. This is ignored when loading `from_flax`.'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`variant` (`str`, *可选*) — 从指定的 `variant` 文件名加载权重，例如 `"fp16"` 或 `"ema"`。在加载
    `from_flax` 时会被忽略。'
- en: '`use_safetensors` (`bool`, *optional*, defaults to `None`) — If set to `None`,
    the `safetensors` weights are downloaded if they’re available **and** if the `safetensors`
    library is installed. If set to `True`, the model is forcibly loaded from `safetensors`
    weights. If set to `False`, `safetensors` weights are not loaded.'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`use_safetensors` (`bool`, *可选*, 默认为 `None`) — 如果设置为 `None`，则会下载 `safetensors`
    权重（如果可用且已安装 `safetensors` 库）。如果设置为 `True`，则会强制从 `safetensors` 权重加载模型。如果设置为 `False`，则不会加载
    `safetensors` 权重。'
- en: Instantiate a pretrained PyTorch model from a pretrained model configuration.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 从预训练模型配置实例化预训练的 PyTorch 模型。
- en: The model is set in evaluation mode - `model.eval()` - by default, and dropout
    modules are deactivated. To train the model, set it back in training mode with
    `model.train()`.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，模型处于评估模式 - `model.eval()` - 并且关闭了 dropout 模块。要训练模型，请使用 `model.train()`
    将其设置回训练模式。
- en: To use private or [gated models](https://huggingface.co/docs/hub/models-gated#gated-models),
    log-in with `huggingface-cli login`. You can also activate the special [“offline-mode”](https://huggingface.co/diffusers/installation.html#offline-mode)
    to use this method in a firewalled environment.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用私有或[门控模型](https://huggingface.co/docs/hub/models-gated#gated-models)，请使用
    `huggingface-cli login` 登录。您还可以激活特殊的[“离线模式”](https://huggingface.co/diffusers/installation.html#offline-mode)以在受防火墙保护的环境中使用此方法。
- en: 'Example:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE7]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'If you get the error message below, you need to finetune the weights for your
    downstream task:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您收到下面的错误消息，则需要为下游任务微调权重：
- en: '[PRE8]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '#### `num_parameters`'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '#### `num_parameters`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L893)'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L893)'
- en: '[PRE9]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Parameters
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 参数
- en: '`only_trainable` (`bool`, *optional*, defaults to `False`) — Whether or not
    to return only the number of trainable parameters.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`only_trainable` (`bool`, *可选*, 默认为 `False`) — 是否仅返回可训练参数的数量。'
- en: '`exclude_embeddings` (`bool`, *optional*, defaults to `False`) — Whether or
    not to return only the number of non-embedding parameters.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`exclude_embeddings` (`bool`, *可选*, 默认为 `False`) — 是否仅返回非嵌入参数的数量。'
- en: Returns
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 返回
- en: '`int`'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '`int`'
- en: The number of parameters.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 参数数量。
- en: Get number of (trainable or non-embedding) parameters in the module.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 获取模块中（可训练或非嵌入）参数的数量。
- en: 'Example:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE10]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '#### `save_pretrained`'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '#### `save_pretrained`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L305)'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_utils.py#L305)'
- en: '[PRE11]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Parameters
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 参数
- en: '`save_directory` (`str` or `os.PathLike`) — Directory to save a model and its
    configuration file to. Will be created if it doesn’t exist.'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`save_directory` (`str` 或 `os.PathLike`) — 保存模型及其配置文件的目录。如果不存在，将会创建。'
- en: '`is_main_process` (`bool`, *optional*, defaults to `True`) — Whether the process
    calling this is the main process or not. Useful during distributed training and
    you need to call this function on all processes. In this case, set `is_main_process=True`
    only on the main process to avoid race conditions.'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`is_main_process` (`bool`, *可选*, 默认为 `True`) — 调用此函数的进程是否为主进程。在分布式训练期间，当您需要在所有进程上调用此函数时，这很有用。在这种情况下，仅在主进程上设置
    `is_main_process=True` 以避免竞争条件。'
- en: '`save_function` (`Callable`) — The function to use to save the state dictionary.
    Useful during distributed training when you need to replace `torch.save` with
    another method. Can be configured with the environment variable `DIFFUSERS_SAVE_MODE`.'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`save_function` (`Callable`) — 用于保存状态字典的函数。在分布式训练期间，当您需要用另一种方法替换 `torch.save`
    时，这很有用。可以使用环境变量 `DIFFUSERS_SAVE_MODE` 进行配置。'
- en: '`safe_serialization` (`bool`, *optional*, defaults to `True`) — Whether to
    save the model using `safetensors` or the traditional PyTorch way with `pickle`.'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`safe_serialization` (`bool`, *可选*, 默认为 `True`) — 是否使用 `safetensors` 或传统的 PyTorch
    方法与 `pickle` 保存模型。'
- en: '`variant` (`str`, *optional*) — If specified, weights are saved in the format
    `pytorch_model.<variant>.bin`.'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`variant` (`str`, *可选*) — 如果指定，权重将以 `pytorch_model.<variant>.bin` 格式保存。'
- en: '`push_to_hub` (`bool`, *optional*, defaults to `False`) — Whether or not to
    push your model to the Hugging Face Hub after saving it. You can specify the repository
    you want to push to with `repo_id` (will default to the name of `save_directory`
    in your namespace).'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`push_to_hub` (`bool`, *可选*, 默认为 `False`) — 是否在保存后将模型推送到 Hugging Face Hub。您可以使用
    `repo_id` 指定要推送到的存储库（将默认为您的命名空间中的 `save_directory` 名称）。'
- en: '`kwargs` (`Dict[str, Any]`, *optional*) — Additional keyword arguments passed
    along to the [push_to_hub()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.utils.PushToHubMixin.push_to_hub)
    method.'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`kwargs` (`Dict[str, Any]`, *可选*) — 传递给 [push_to_hub()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.utils.PushToHubMixin.push_to_hub)
    方法的额外关键字参数。'
- en: Save a model and its configuration file to a directory so that it can be reloaded
    using the [from_pretrained()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.ModelMixin.from_pretrained)
    class method.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 将模型及其配置文件保存到一个目录，以便可以使用 [from_pretrained()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.ModelMixin.from_pretrained)
    类方法重新加载它。
- en: FlaxModelMixin
  id: totrans-92
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: FlaxModelMixin
- en: '### `class diffusers.FlaxModelMixin`'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '### `class diffusers.FlaxModelMixin`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_flax_utils.py#L50)'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_flax_utils.py#L50)'
- en: '[PRE12]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Base class for all Flax models.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 所有 Flax 模型的基类。
- en: '[FlaxModelMixin](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.FlaxModelMixin)
    takes care of storing the model configuration and provides methods for loading,
    downloading and saving models.'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '[FlaxModelMixin](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.FlaxModelMixin)
    负责存储模型配置，并提供加载、下载和保存模型的方法。'
- en: '`config_name` (`str`) — Filename to save a model to when calling [save_pretrained()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.FlaxModelMixin.save_pretrained).'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`config_name` (`str`) — 在调用 [save_pretrained()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.FlaxModelMixin.save_pretrained)
    时保存模型的文件名。'
- en: '#### `from_pretrained`'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '#### `from_pretrained`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_flax_utils.py#L203)'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_flax_utils.py#L203)'
- en: '[PRE13]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Parameters
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 参数
- en: '`pretrained_model_name_or_path` (`str` or `os.PathLike`) — Can be either:'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pretrained_model_name_or_path` (`str` 或 `os.PathLike`) — 可以是以下之一：'
- en: A string, the *model id* (for example `runwayml/stable-diffusion-v1-5`) of a
    pretrained model hosted on the Hub.
  id: totrans-104
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个字符串，预训练模型在 Hub 上托管的*模型 ID*（例如 `runwayml/stable-diffusion-v1-5`）。
- en: A path to a *directory* (for example `./my_model_directory`) containing the
    model weights saved using [save_pretrained()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.FlaxModelMixin.save_pretrained).
  id: totrans-105
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 指向包含使用[save_pretrained()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.FlaxModelMixin.save_pretrained)保存的模型权重的*目录*的路径（例如
    `./my_model_directory`）。
- en: '`dtype` (`jax.numpy.dtype`, *optional*, defaults to `jax.numpy.float32`) —
    The data type of the computation. Can be one of `jax.numpy.float32`, `jax.numpy.float16`
    (on GPUs) and `jax.numpy.bfloat16` (on TPUs).'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`dtype` (`jax.numpy.dtype`, *optional*, 默认为 `jax.numpy.float32`) — 计算的数据类型。可以是
    `jax.numpy.float32`、`jax.numpy.float16`（在 GPU 上）和 `jax.numpy.bfloat16`（在 TPU 上）之一。'
- en: This can be used to enable mixed-precision training or half-precision inference
    on GPUs or TPUs. If specified, all the computation will be performed with the
    given `dtype`.
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这可用于在 GPU 或 TPU 上启用混合精度训练或半精度推断。如果指定，所有计算将使用给定的 `dtype` 执行。
- en: This only specifies the dtype of the *computation* and does not influence the
    dtype of model parameters.
  id: totrans-108
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这仅指定*计算*的数据类型，不影响模型参数的数据类型。
- en: If you wish to change the dtype of the model parameters, see [to_fp16()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.FlaxModelMixin.to_fp16)
    and [to_bf16()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.FlaxModelMixin.to_bf16).
  id: totrans-109
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果要更改模型参数的数据类型，请参阅[to_fp16()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.FlaxModelMixin.to_fp16)和[to_bf16()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.FlaxModelMixin.to_bf16)。
- en: '`model_args` (sequence of positional arguments, *optional*) — All remaining
    positional arguments are passed to the underlying model’s `__init__` method.'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`model_args`（位置参数序列，*optional*） — 所有剩余的位置参数都传递给基础模型的 `__init__` 方法。'
- en: '`cache_dir` (`Union[str, os.PathLike]`, *optional*) — Path to a directory where
    a downloaded pretrained model configuration is cached if the standard cache is
    not used.'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`cache_dir` (`Union[str, os.PathLike]`, *optional*) — 下载的预训练模型配置缓存在其中的目录路径，如果未使用标准缓存。'
- en: '`force_download` (`bool`, *optional*, defaults to `False`) — Whether or not
    to force the (re-)download of the model weights and configuration files, overriding
    the cached versions if they exist.'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`force_download` (`bool`, *optional*, 默认为 `False`) — 是否强制（重新）下载模型权重和配置文件，覆盖缓存版本（如果存在）。'
- en: '`resume_download` (`bool`, *optional*, defaults to `False`) — Whether or not
    to resume downloading the model weights and configuration files. If set to `False`,
    any incompletely downloaded files are deleted.'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`resume_download` (`bool`, *optional*, 默认为 `False`) — 是否恢复下载模型权重和配置文件。如果设置为
    `False`，则删除任何未完全下载的文件。'
- en: '`proxies` (`Dict[str, str]`, *optional*) — A dictionary of proxy servers to
    use by protocol or endpoint, for example, `{''http'': ''foo.bar:3128'', ''http://hostname'':
    ''foo.bar:4012''}`. The proxies are used on each request.'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`proxies` (`Dict[str, str]`, *optional*) — 用于每个请求的协议或端点的代理服务器字典，例如，`{''http'':
    ''foo.bar:3128'', ''http://hostname'': ''foo.bar:4012''}`。代理服务器在每个请求上使用。'
- en: '`local_files_only(bool,` *optional*, defaults to `False`) — Whether to only
    load local model weights and configuration files or not. If set to `True`, the
    model won’t be downloaded from the Hub.'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`local_files_only(bool,` *optional*, 默认为 `False`) — 是否仅加载本地模型权重和配置文件。如果设置为
    `True`，则模型不会从 Hub 下载。'
- en: '`revision` (`str`, *optional*, defaults to `"main"`) — The specific model version
    to use. It can be a branch name, a tag name, a commit id, or any identifier allowed
    by Git.'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`revision` (`str`, *optional*, 默认为 `"main"`) — 要使用的特定模型版本。可以是分支名称、标签名称、提交 ID
    或 Git 允许的任何标识符。'
- en: '`from_pt` (`bool`, *optional*, defaults to `False`) — Load the model weights
    from a PyTorch checkpoint save file.'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`from_pt` (`bool`, *optional*, 默认为 `False`) — 从 PyTorch 检查点保存文件加载模型权重。'
- en: '`kwargs` (remaining dictionary of keyword arguments, *optional*) — Can be used
    to update the configuration object (after it is loaded) and initiate the model
    (for example, `output_attentions=True`). Behaves differently depending on whether
    a `config` is provided or automatically loaded:'
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`kwargs`（剩余的关键字参数字典，*optional*） — 可用于更新配置对象（加载后）并启动模型（例如，`output_attentions=True`）。根据是否提供或自动加载了
    `config`，行为不同。'
- en: If a configuration is provided with `config`, `kwargs` are directly passed to
    the underlying model’s `__init__` method (we assume all relevant updates to the
    configuration have already been done).
  id: totrans-119
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果提供了 `config`，则 `kwargs` 直接传递给基础模型的 `__init__` 方法（我们假设配置的所有相关更新已经完成）。
- en: If a configuration is not provided, `kwargs` are first passed to the configuration
    class initialization function [from_config()](/docs/diffusers/v0.26.3/en/api/configuration#diffusers.ConfigMixin.from_config).
    Each key of the `kwargs` that corresponds to a configuration attribute is used
    to override said attribute with the supplied `kwargs` value. Remaining keys that
    do not correspond to any configuration attribute are passed to the underlying
    model’s `__init__` function.
  id: totrans-120
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果未提供配置，则首先将 `kwargs` 传递给配置类初始化函数[from_config()](/docs/diffusers/v0.26.3/en/api/configuration#diffusers.ConfigMixin.from_config)。与配置属性对应的
    `kwargs` 的每个键都用提供的 `kwargs` 值覆盖该属性。不对应任何配置属性的剩余键将传递给基础模型的 `__init__` 函数。
- en: Instantiate a pretrained Flax model from a pretrained model configuration.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 从预训练模型配置实例化预训练的 Flax 模型。
- en: 'Examples:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE14]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'If you get the error message below, you need to finetune the weights for your
    downstream task:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您收到下面的错误消息，则需要为您的下游任务微调权重：
- en: '[PRE15]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '#### `save_pretrained`'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '#### `save_pretrained`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_flax_utils.py#L502)'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_flax_utils.py#L502)'
- en: '[PRE16]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Parameters
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 参数
- en: '`save_directory` (`str` or `os.PathLike`) — Directory to save a model and its
    configuration file to. Will be created if it doesn’t exist.'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`save_directory` (`str`或`os.PathLike`) — 要保存模型及其配置文件的目录。如果目录不存在，将会创建。'
- en: '`params` (`Union[Dict, FrozenDict]`) — A `PyTree` of model parameters.'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`params` (`Union[Dict, FrozenDict]`) — 模型参数的`PyTree`。'
- en: '`is_main_process` (`bool`, *optional*, defaults to `True`) — Whether the process
    calling this is the main process or not. Useful during distributed training and
    you need to call this function on all processes. In this case, set `is_main_process=True`
    only on the main process to avoid race conditions.'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`is_main_process` (`bool`, *可选*, 默认为`True`) — 调用此函数的进程是否为主进程。在分布式训练中非常有用，当您需要在所有进程上调用此函数时。在这种情况下，仅在主进程上设置`is_main_process=True`以避免竞争条件。'
- en: '`push_to_hub` (`bool`, *optional*, defaults to `False`) — Whether or not to
    push your model to the Hugging Face model hub after saving it. You can specify
    the repository you want to push to with `repo_id` (will default to the name of
    `save_directory` in your namespace).'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`push_to_hub` (`bool`, *可选*, 默认为`False`) — 是否在保存后将模型推送到Hugging Face模型中心。您可以使用`repo_id`指定要推送到的存储库（默认为您的命名空间中的`save_directory`名称）。'
- en: '`kwargs` (`Dict[str, Any]`, *optional*) — Additional key word arguments passed
    along to the [push_to_hub()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.utils.PushToHubMixin.push_to_hub)
    method.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`kwargs` (`Dict[str, Any]`, *可选*) — 传递给[push_to_hub()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.utils.PushToHubMixin.push_to_hub)方法的额外关键字参数。'
- en: Save a model and its configuration file to a directory so that it can be reloaded
    using the [from_pretrained()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.FlaxModelMixin.from_pretrained)
    class method.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 将模型及其配置文件保存到一个目录中，以便可以使用[from_pretrained()](/docs/diffusers/v0.26.3/en/api/models/overview#diffusers.FlaxModelMixin.from_pretrained)类方法重新加载。
- en: '#### `to_bf16`'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '#### `to_bf16`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_flax_utils.py#L95)'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_flax_utils.py#L95)'
- en: '[PRE17]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Parameters
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 参数
- en: '`params` (`Union[Dict, FrozenDict]`) — A `PyTree` of model parameters.'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`params` (`Union[Dict, FrozenDict]`) — 模型参数的`PyTree`。'
- en: '`mask` (`Union[Dict, FrozenDict]`) — A `PyTree` with same structure as the
    `params` tree. The leaves should be booleans. It should be `True` for params you
    want to cast, and `False` for those you want to skip.'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`mask` (`Union[Dict, FrozenDict]`) — 一个与`params`树结构相同的`PyTree`。叶子节点应为布尔值。对于要转换的参数应为`True`，对于要跳过的参数应为`False`。'
- en: Cast the floating-point `params` to `jax.numpy.bfloat16`. This returns a new
    `params` tree and does not cast the `params` in place.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 将浮点`params`转换为`jax.numpy.bfloat16`。这将返回一个新的`params`树，不会直接转换`params`。
- en: This method can be used on a TPU to explicitly convert the model parameters
    to bfloat16 precision to do full half-precision training or to save weights in
    bfloat16 for inference in order to save memory and improve speed.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法可以在TPU上使用，显式地将模型参数转换为bfloat16精度，以进行完全的半精度训练或者保存权重为bfloat16以节省内存并提高速度。
- en: 'Examples:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: '示例:'
- en: '[PRE18]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '#### `to_fp16`'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: '#### `to_fp16`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_flax_utils.py#L161)'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_flax_utils.py#L161)'
- en: '[PRE19]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Parameters
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 参数
- en: '`params` (`Union[Dict, FrozenDict]`) — A `PyTree` of model parameters.'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`params` (`Union[Dict, FrozenDict]`) — 模型参数的`PyTree`。'
- en: '`mask` (`Union[Dict, FrozenDict]`) — A `PyTree` with same structure as the
    `params` tree. The leaves should be booleans. It should be `True` for params you
    want to cast, and `False` for those you want to skip.'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`mask` (`Union[Dict, FrozenDict]`) — 一个与`params`树结构相同的`PyTree`。叶子节点应为布尔值。对于要转换的参数应为`True`，对于要跳过的参数应为`False`。'
- en: Cast the floating-point `params` to `jax.numpy.float16`. This returns a new
    `params` tree and does not cast the `params` in place.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 将浮点`params`转换为`jax.numpy.float16`。这将返回一个新的`params`树，不会直接转换`params`。
- en: This method can be used on a GPU to explicitly convert the model parameters
    to float16 precision to do full half-precision training or to save weights in
    float16 for inference in order to save memory and improve speed.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法可以在GPU上使用，显式地将模型参数转换为float16精度，以进行完全的半精度训练或者保存权重为float16以节省内存并提高速度。
- en: 'Examples:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE20]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '#### `to_fp32`'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '#### `to_fp32`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_flax_utils.py#L134)'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/models/modeling_flax_utils.py#L134)'
- en: '[PRE21]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Parameters
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 参数
- en: '`params` (`Union[Dict, FrozenDict]`) — A `PyTree` of model parameters.'
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`params` (`Union[Dict, FrozenDict]`) — 模型参数的`PyTree`。'
- en: '`mask` (`Union[Dict, FrozenDict]`) — A `PyTree` with same structure as the
    `params` tree. The leaves should be booleans. It should be `True` for params you
    want to cast, and `False` for those you want to skip.'
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`mask` (`Union[Dict, FrozenDict]`) — 一个与`params`树结构相同的`PyTree`。叶子节点应为布尔值。对于要转换的参数应为`True`，对于要跳过的参数应为`False`。'
- en: Cast the floating-point `params` to `jax.numpy.float32`. This method can be
    used to explicitly convert the model parameters to fp32 precision. This returns
    a new `params` tree and does not cast the `params` in place.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 将浮点`params`转换为`jax.numpy.float32`。这种方法可以用于显式地将模型参数转换为fp32精度。这将返回一个新的`params`树，不会直接转换`params`。
- en: 'Examples:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE22]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: PushToHubMixin
  id: totrans-165
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PushToHubMixin
- en: '### `class diffusers.utils.PushToHubMixin`'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '### `class diffusers.utils.PushToHubMixin`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/utils/hub_utils.py#L351)'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/utils/hub_utils.py#L351)'
- en: '[PRE23]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: A Mixin to push a model, scheduler, or pipeline to the Hugging Face Hub.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 将模型、调度器或流水线推送到Hugging Face Hub的Mixin。
- en: '#### `push_to_hub`'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '`push_to_hub`'
- en: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/utils/hub_utils.py#L380)'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: '[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/utils/hub_utils.py#L380)'
- en: '[PRE24]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Parameters
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 参数
- en: '`repo_id` (`str`) — The name of the repository you want to push your model,
    scheduler, or pipeline files to. It should contain your organization name when
    pushing to an organization. `repo_id` can also be a path to a local directory.'
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`repo_id` (`str`) — 您要推送模型、调度器或流水线文件的存储库名称。在推送到组织时，应包含您的组织名称。`repo_id`也可以是本地目录的路径。'
- en: '`commit_message` (`str`, *optional*) — Message to commit while pushing. Default
    to `"Upload {object}"`.'
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`commit_message` (`str`, *optional*) — 推送时要提交的消息。默认为`"Upload {object}"`。'
- en: '`private` (`bool`, *optional*) — Whether or not the repository created should
    be private.'
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`private` (`bool`, *optional*) — 是否应将创建的存储库设置为私有。'
- en: '`token` (`str`, *optional*) — The token to use as HTTP bearer authorization
    for remote files. The token generated when running `huggingface-cli login` (stored
    in `~/.huggingface`).'
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`token` (`str`, *optional*) — 用作远程文件的HTTP bearer授权的令牌。在运行`huggingface-cli login`时生成的令牌（存储在`~/.huggingface`中）。'
- en: '`create_pr` (`bool`, *optional*, defaults to `False`) — Whether or not to create
    a PR with the uploaded files or directly commit.'
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`create_pr` (`bool`, *optional*, 默认为`False`) — 是否创建一个带有上传文件的PR或直接提交。'
- en: '`safe_serialization` (`bool`, *optional*, defaults to `True`) — Whether or
    not to convert the model weights to the `safetensors` format.'
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`safe_serialization` (`bool`, *optional*, 默认为`True`) — 是否将模型权重转换为`safetensors`格式。'
- en: '`variant` (`str`, *optional*) — If specified, weights are saved in the format
    `pytorch_model.<variant>.bin`.'
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`variant` (`str`, *optional*) — 如果指定，权重将以`pytorch_model.<variant>.bin`格式保存。'
- en: Upload model, scheduler, or pipeline files to the 🤗 Hugging Face Hub.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 将模型、调度器或流水线文件上传到🤗 Hugging Face Hub。
- en: 'Examples:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE25]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
