- en: Process image data
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¤„ç†å›¾åƒæ•°æ®
- en: 'Original text: [https://huggingface.co/docs/datasets/image_process](https://huggingface.co/docs/datasets/image_process)'
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸå§‹æ–‡æœ¬ï¼š[https://huggingface.co/docs/datasets/image_process](https://huggingface.co/docs/datasets/image_process)
- en: null
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: 'This guide shows specific methods for processing image datasets. Learn how
    to:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬æŒ‡å—å±•ç¤ºäº†å¤„ç†å›¾åƒæ•°æ®é›†çš„å…·ä½“æ–¹æ³•ã€‚å­¦ä¹ å¦‚ä½•ï¼š
- en: Use [map()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.map)
    with image dataset.
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨[map()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.map)å¤„ç†å›¾åƒæ•°æ®é›†ã€‚
- en: Apply data augmentations to a dataset with [set_transform()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.set_transform).
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨[set_transform()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.set_transform)å°†æ•°æ®å¢å¼ºåº”ç”¨åˆ°æ•°æ®é›†ä¸­ã€‚
- en: For a guide on how to process any type of dataset, take a look at the [general
    process guide](./process).
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰å…³å¦‚ä½•å¤„ç†ä»»ä½•ç±»å‹çš„æ•°æ®é›†çš„æŒ‡å—ï¼Œè¯·æŸ¥çœ‹[é€šç”¨å¤„ç†æŒ‡å—](./process)ã€‚
- en: Map
  id: totrans-7
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ˜ å°„
- en: The [map()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.map)
    function can apply transforms over an entire dataset.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '[map()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.map)å‡½æ•°å¯ä»¥åœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šåº”ç”¨å˜æ¢ã€‚'
- en: 'For example, create a basic [`Resize`](https://pytorch.org/vision/stable/generated/torchvision.transforms.Resize.html)
    function:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„[`Resize`](https://pytorch.org/vision/stable/generated/torchvision.transforms.Resize.html)å‡½æ•°ï¼š
- en: '[PRE0]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Now use the [map()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.map)
    function to resize the entire dataset, and set `batched=True` to speed up the
    process by accepting batches of examples. The transform returns `pixel_values`
    as a cacheable `PIL.Image` object:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ä½¿ç”¨[map()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.map)å‡½æ•°è°ƒæ•´æ•´ä¸ªæ•°æ®é›†çš„å¤§å°ï¼Œå¹¶è®¾ç½®`batched=True`ä»¥é€šè¿‡æ¥å—ç¤ºä¾‹æ‰¹æ¬¡åŠ å¿«å¤„ç†é€Ÿåº¦ã€‚è¯¥å˜æ¢å°†`pixel_values`ä½œä¸ºå¯ç¼“å­˜çš„`PIL.Image`å¯¹è±¡è¿”å›ï¼š
- en: '[PRE1]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: The cache file saves time because you donâ€™t have to execute the same transform
    twice. The [map()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.map)
    function is best for operations you only run once per training - like resizing
    an image - instead of using it for operations executed for each epoch, like data
    augmentations.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: ç¼“å­˜æ–‡ä»¶å¯ä»¥èŠ‚çœæ—¶é—´ï¼Œå› ä¸ºæ‚¨ä¸å¿…æ‰§è¡Œç›¸åŒçš„å˜æ¢ä¸¤æ¬¡ã€‚[map()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.map)å‡½æ•°æœ€é€‚åˆæ‚¨æ¯æ¬¡è®­ç»ƒåªè¿è¡Œä¸€æ¬¡çš„æ“ä½œï¼Œæ¯”å¦‚è°ƒæ•´å›¾åƒå¤§å°ï¼Œè€Œä¸æ˜¯ç”¨äºæ¯ä¸ªepochæ‰§è¡Œçš„æ“ä½œï¼Œæ¯”å¦‚æ•°æ®å¢å¼ºã€‚
- en: '[map()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.map)
    takes up some memory, but you can reduce its memory requirements with the following
    parameters:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '[map()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.map)ä¼šå ç”¨ä¸€äº›å†…å­˜ï¼Œä½†æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹å‚æ•°å‡å°‘å…¶å†…å­˜éœ€æ±‚ï¼š'
- en: '[`batch_size`](./package_reference/main_classes#datasets.DatasetDict.map.batch_size)
    determines the number of examples that are processed in one call to the transform
    function.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`batch_size`](./package_reference/main_classes#datasets.DatasetDict.map.batch_size)ç¡®å®šåœ¨ä¸€æ¬¡è°ƒç”¨å˜æ¢å‡½æ•°ä¸­å¤„ç†çš„ç¤ºä¾‹æ•°é‡ã€‚'
- en: '[`writer_batch_size`](./package_reference/main_classes#datasets.DatasetDict.map.writer_batch_size)
    determines the number of processed examples that are kept in memory before they
    are stored away.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`writer_batch_size`](./package_reference/main_classes#datasets.DatasetDict.map.writer_batch_size)ç¡®å®šåœ¨å°†å…¶å­˜å‚¨ä¹‹å‰åœ¨å†…å­˜ä¸­ä¿ç•™çš„å·²å¤„ç†ç¤ºä¾‹æ•°é‡ã€‚'
- en: Both parameter values default to 1000, which can be expensive if you are storing
    images. Lower these values to use less memory when you use [map()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.map).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸¤ä¸ªå‚æ•°å€¼é»˜è®¤ä¸º1000ï¼Œå¦‚æœæ‚¨è¦å­˜å‚¨å›¾åƒï¼Œè¿™å¯èƒ½ä¼šå¾ˆæ˜‚è´µã€‚é™ä½è¿™äº›å€¼ä»¥åœ¨ä½¿ç”¨[map()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.map)æ—¶ä½¿ç”¨æ›´å°‘çš„å†…å­˜ã€‚
- en: Apply transforms
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åº”ç”¨å˜æ¢
- en: ğŸ¤— Datasets applies data augmentations from any library or package to your dataset.
    Transforms can be applied on-the-fly on batches of data with [set_transform()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.set_transform),
    which consumes less disk space.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: ğŸ¤— æ•°æ®é›†å¯ä»¥å°†ä»»ä½•åº“æˆ–åŒ…ä¸­çš„æ•°æ®å¢å¼ºåº”ç”¨åˆ°æ‚¨çš„æ•°æ®é›†ä¸­ã€‚å˜æ¢å¯ä»¥åœ¨æ•°æ®æ‰¹æ¬¡ä¸Šå®æ—¶åº”ç”¨ï¼Œä½¿ç”¨[set_transform()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.set_transform)ï¼Œè¿™æ ·å¯ä»¥å‡å°‘ç£ç›˜ç©ºé—´çš„ä½¿ç”¨ã€‚
- en: The following example uses [torchvision](https://pytorch.org/vision/stable/index.html),
    but feel free to use other data augmentation libraries like [Albumentations](https://albumentations.ai/docs/),
    [Kornia](https://kornia.readthedocs.io/en/latest/), and [imgaug](https://imgaug.readthedocs.io/en/latest/).
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹ç¤ºä¾‹ä½¿ç”¨[torchvision](https://pytorch.org/vision/stable/index.html)ï¼Œä½†ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ•°æ®å¢å¼ºåº“ï¼Œå¦‚[Albumentations](https://albumentations.ai/docs/)ã€[Kornia](https://kornia.readthedocs.io/en/latest/)å’Œ[imgaug](https://imgaug.readthedocs.io/en/latest/)ã€‚
- en: 'For example, if youâ€™d like to change the color properties of an image randomly:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³éšæœºæ›´æ”¹å›¾åƒçš„é¢œè‰²å±æ€§ï¼š
- en: '[PRE2]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Create a function to apply the `ColorJitter` transform:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥åº”ç”¨`ColorJitter`å˜æ¢ï¼š
- en: '[PRE3]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Apply the transform with the [set_transform()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.set_transform)
    function:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨[set_transform()](/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.set_transform)å‡½æ•°åº”ç”¨å˜æ¢ï¼š
- en: '[PRE4]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
