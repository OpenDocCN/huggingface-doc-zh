# åˆ›å»ºç”¨äºè®­ç»ƒçš„æ•°æ®é›†

> åŸå§‹æ–‡æœ¬ï¼š[`huggingface.co/docs/diffusers/training/create_dataset`](https://huggingface.co/docs/diffusers/training/create_dataset)

Hub ä¸Šæœ‰è®¸å¤šæ•°æ®é›†å¯ç”¨äºè®­ç»ƒæ¨¡å‹ï¼Œä½†å¦‚æœæ‰¾ä¸åˆ°æ‚¨æ„Ÿå…´è¶£çš„æ•°æ®é›†æˆ–æƒ³ä½¿ç”¨è‡ªå·±çš„æ•°æ®é›†ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ğŸ¤—Datasets åº“åˆ›å»ºæ•°æ®é›†ã€‚æ•°æ®é›†ç»“æ„å–å†³äºæ‚¨æƒ³è¦è®­ç»ƒæ¨¡å‹çš„ä»»åŠ¡ã€‚æœ€åŸºæœ¬çš„æ•°æ®é›†ç»“æ„æ˜¯å›¾åƒç›®å½•ï¼Œç”¨äºæ— æ¡ä»¶å›¾åƒç”Ÿæˆç­‰ä»»åŠ¡ã€‚å¦ä¸€ä¸ªæ•°æ®é›†ç»“æ„å¯èƒ½æ˜¯å›¾åƒç›®å½•å’ŒåŒ…å«ç›¸åº”æ–‡æœ¬æ ‡é¢˜çš„æ–‡æœ¬æ–‡ä»¶ï¼Œç”¨äºæ–‡æœ¬åˆ°å›¾åƒç”Ÿæˆç­‰ä»»åŠ¡ã€‚

æ­¤æŒ‡å—å°†å‘æ‚¨å±•ç¤ºä¸¤ç§åˆ›å»ºæ•°æ®é›†ä»¥è¿›è¡Œå¾®è°ƒçš„æ–¹æ³•ï¼š

+   å°†å›¾åƒæ–‡ä»¶å¤¹æä¾›ç»™`--train_data_dir`å‚æ•°

+   å°†æ•°æ®é›†ä¸Šä¼ åˆ° Hubï¼Œå¹¶å°†æ•°æ®é›†å­˜å‚¨åº“ ID ä¼ é€’ç»™`--dataset_name`å‚æ•°

ğŸ’¡äº†è§£æœ‰å…³å¦‚ä½•ä¸ºè®­ç»ƒåˆ›å»ºå›¾åƒæ•°æ®é›†çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…[åˆ›å»ºå›¾åƒæ•°æ®é›†](https://huggingface.co/docs/datasets/image_dataset)æŒ‡å—ã€‚

## æä¾›ä¸€ä¸ªä½œä¸ºæ–‡ä»¶å¤¹çš„æ•°æ®é›†

å¯¹äºæ— æ¡ä»¶ç”Ÿæˆï¼Œæ‚¨å¯ä»¥æä¾›è‡ªå·±çš„æ•°æ®é›†ä½œä¸ºå›¾åƒæ–‡ä»¶å¤¹ã€‚è®­ç»ƒè„šæœ¬ä½¿ç”¨ğŸ¤—æ•°æ®é›†ä¸­çš„[`ImageFolder`](https://huggingface.co/docs/datasets/en/image_dataset#imagefolder)æ„å»ºå™¨ï¼Œè‡ªåŠ¨ä»æ–‡ä»¶å¤¹æ„å»ºæ•°æ®é›†ã€‚æ‚¨çš„ç›®å½•ç»“æ„åº”å¦‚ä¸‹æ‰€ç¤ºï¼š

```py
data_dir/xxx.png
data_dir/xxy.png
data_dir/[...]/xxz.png
```

å°†æ•°æ®é›†ç›®å½•è·¯å¾„ä¼ é€’ç»™`--train_data_dir`å‚æ•°ï¼Œç„¶åæ‚¨å¯ä»¥å¼€å§‹è®­ç»ƒï¼š

```py
accelerate launch train_unconditional.py \
    --train_data_dir <path-to-train-directory> \
    <other-arguments>
```

## å°†æ•°æ®ä¸Šä¼ åˆ° Hub

ğŸ’¡æœ‰å…³åœ¨ Hub ä¸Šåˆ›å»ºå’Œä¸Šä¼ æ•°æ®é›†çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯å’ŒèƒŒæ™¯ï¼Œè¯·æŸ¥çœ‹[ä½¿ç”¨ğŸ¤—æ•°æ®é›†è¿›è¡Œå›¾åƒæœç´¢](https://huggingface.co/blog/image-search-datasets)å¸–å­ã€‚

é¦–å…ˆä½¿ç”¨[`ImageFolder`](https://huggingface.co/docs/datasets/image_load#imagefolder)åŠŸèƒ½åˆ›å»ºä¸€ä¸ªæ•°æ®é›†ï¼Œè¯¥åŠŸèƒ½åˆ›å»ºä¸€ä¸ªåŒ…å« PIL ç¼–ç å›¾åƒçš„`image`åˆ—ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨`data_dir`æˆ–`data_files`å‚æ•°æŒ‡å®šæ•°æ®é›†çš„ä½ç½®ã€‚`data_files`å‚æ•°æ”¯æŒå°†ç‰¹å®šæ–‡ä»¶æ˜ å°„åˆ°æ•°æ®é›†æ‹†åˆ†ï¼Œå¦‚`train`æˆ–`test`ï¼š

```py
from datasets import load_dataset

# example 1: local folder
dataset = load_dataset("imagefolder", data_dir="path_to_your_folder")

# example 2: local files (supported formats are tar, gzip, zip, xz, rar, zstd)
dataset = load_dataset("imagefolder", data_files="path_to_zip_file")

# example 3: remote files (supported formats are tar, gzip, zip, xz, rar, zstd)
dataset = load_dataset(
    "imagefolder",
    data_files="https://download.microsoft.com/download/3/E/1/3E1C3F21-ECDB-4869-8368-6DEBA77B919F/kagglecatsanddogs_3367a.zip",
)

# example 4: providing several splits
dataset = load_dataset(
    "imagefolder", data_files={"train": ["path/to/file1", "path/to/file2"], "test": ["path/to/file3", "path/to/file4"]}
)
```

ç„¶åä½¿ç”¨[push_to_hub](https://huggingface.co/docs/datasets/v2.17.0/en/package_reference/main_classes#datasets.Dataset.push_to_hub)æ–¹æ³•å°†æ•°æ®é›†ä¸Šä¼ åˆ° Hubï¼š

```py
# assuming you have ran the huggingface-cli login command in a terminal
dataset.push_to_hub("name_of_your_dataset")

# if you want to push to a private repo, simply pass private=True:
dataset.push_to_hub("name_of_your_dataset", private=True)
```

ç°åœ¨æ•°æ®é›†å¯ä¾›è®­ç»ƒï¼Œé€šè¿‡å°†æ•°æ®é›†åç§°ä¼ é€’ç»™`--dataset_name`å‚æ•°ï¼š

```py
accelerate launch --mixed_precision="fp16"  train_text_to_image.py \
  --pretrained_model_name_or_path="runwayml/stable-diffusion-v1-5" \
  --dataset_name="name_of_your_dataset" \
  <other-arguments>
```

## ä¸‹ä¸€æ­¥

ç°åœ¨æ‚¨å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæ•°æ®é›†ï¼Œæ‚¨å¯ä»¥å°†å…¶æ’å…¥åˆ°è®­ç»ƒè„šæœ¬çš„`train_data_dir`ï¼ˆå¦‚æœæ‚¨çš„æ•°æ®é›†æ˜¯æœ¬åœ°çš„ï¼‰æˆ–`dataset_name`ï¼ˆå¦‚æœæ‚¨çš„æ•°æ®é›†åœ¨ Hub ä¸Šï¼‰å‚æ•°ä¸­ã€‚

åœ¨æ‚¨çš„ä¸‹ä¸€æ­¥ä¸­ï¼Œéšæ—¶å°è¯•ä½¿ç”¨æ‚¨çš„æ•°æ®é›†æ¥è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œç”¨äºæ— æ¡ä»¶ç”Ÿæˆæˆ–æ–‡æœ¬åˆ°å›¾åƒç”Ÿæˆï¼
