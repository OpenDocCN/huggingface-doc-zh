# AutoPipeline

> åŸæ–‡é“¾æ¥: [`huggingface.co/docs/diffusers/api/pipelines/auto_pipeline`](https://huggingface.co/docs/diffusers/api/pipelines/auto_pipeline)

`AutoPipeline` çš„è®¾è®¡ç›®çš„æ˜¯:

1.  ä½¿æ‚¨èƒ½å¤ŸåŠ è½½ä»»åŠ¡çš„æ£€æŸ¥ç‚¹ï¼Œè€Œæ— éœ€çŸ¥é“è¦ä½¿ç”¨çš„ç‰¹å®šç®¡é“ç±»

1.  åœ¨å·¥ä½œæµä¸­ä½¿ç”¨å¤šä¸ªç®¡é“

åŸºäºä»»åŠ¡ï¼Œ`AutoPipeline` ç±»ä¼šæ ¹æ®é¢„è®­ç»ƒæƒé‡çš„åç§°æˆ–è·¯å¾„è‡ªåŠ¨æ£€ç´¢ç›¸å…³ç®¡é“ï¼Œä½¿ç”¨ `from_pretrained()` æ–¹æ³•ã€‚

ä¸ºäº†åœ¨ä¸é‡æ–°åˆ†é…é¢å¤–å†…å­˜çš„æƒ…å†µä¸‹æ— ç¼åˆ‡æ¢ä»»åŠ¡ï¼Œä½¿ç”¨ `from_pipe()` æ–¹æ³•å°†ç»„ä»¶ä»åŸå§‹ç®¡é“ä¼ è¾“åˆ°æ–°ç®¡é“ã€‚

```py
from diffusers import AutoPipelineForText2Image
import torch

pipeline = AutoPipelineForText2Image.from_pretrained(
    "runwayml/stable-diffusion-v1-5", torch_dtype=torch.float16, use_safetensors=True
).to("cuda")
prompt = "Astronaut in a jungle, cold color palette, muted colors, detailed, 8k"

image = pipeline(prompt, num_inference_steps=25).images[0]
```

æŸ¥çœ‹ AutoPipeline æ•™ç¨‹ï¼Œäº†è§£å¦‚ä½•ä½¿ç”¨æ­¤ APIï¼

`AutoPipeline` æ”¯æŒä»¥ä¸‹æ‰©æ•£æ¨¡å‹çš„æ–‡æœ¬åˆ°å›¾åƒã€å›¾åƒåˆ°å›¾åƒå’Œä¿®è¡¥åŠŸèƒ½ï¼š

+   ç¨³å®šæ‰©æ•£

+   ControlNet

+   ç¨³å®šæ‰©æ•£ XL (SDXL)

+   DeepFloyd IF

+   Kandinsky 2.1

+   Kandinsky 2.2

## AutoPipelineForText2Image

### `class diffusers.AutoPipelineForText2Image`

[<æ¥æº>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/pipelines/auto_pipeline.py#L175)

```py
( *args **kwargs )
```

AutoPipelineForText2Image æ˜¯ä¸€ä¸ªé€šç”¨çš„ç®¡é“ç±»ï¼Œå®ä¾‹åŒ–ä¸€ä¸ªæ–‡æœ¬åˆ°å›¾åƒçš„ç®¡é“ç±»ã€‚å…·ä½“çš„åº•å±‚ç®¡é“ç±»ä¼šè‡ªåŠ¨ä» from_pretrained() æˆ– from_pipe() æ–¹æ³•ä¸­é€‰æ‹©ã€‚

è¿™ä¸ªç±»ä¸èƒ½ä½¿ç”¨ `__init__()` å®ä¾‹åŒ–ï¼ˆä¼šæŠ›å‡ºé”™è¯¯ï¼‰ã€‚

ç±»å±æ€§:

+   `config_name` (`str`) â€” å­˜å‚¨æ‰€æœ‰æ‰©æ•£ç®¡é“ç»„ä»¶ç±»å’Œæ¨¡å—åç§°çš„é…ç½®æ–‡ä»¶åã€‚

#### `from_pretrained`

[<æ¥æº>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/pipelines/auto_pipeline.py#L200)

```py
( pretrained_model_or_path **kwargs )
```

å‚æ•°

+   `pretrained_model_name_or_path` (`str` æˆ– `os.PathLike`, *å¯é€‰*) â€” å¯ä»¥æ˜¯:

    +   ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé¢„è®­ç»ƒç®¡é“çš„ *repo id*ï¼ˆä¾‹å¦‚ `CompVis/ldm-text2im-large-256`ï¼‰ã€‚

    +   ä¸€ä¸ª*ç›®å½•*è·¯å¾„ï¼ˆä¾‹å¦‚ `./my_pipeline_directory/`ï¼‰ï¼Œå…¶ä¸­åŒ…å«ä½¿ç”¨ save_pretrained() ä¿å­˜çš„ç®¡é“æƒé‡ã€‚

+   `torch_dtype` (`str` æˆ– `torch.dtype`, *å¯é€‰*) â€” è¦†ç›–é»˜è®¤çš„ `torch.dtype` å¹¶ä½¿ç”¨å¦ä¸€ç§ dtype åŠ è½½æ¨¡å‹ã€‚å¦‚æœä¼ é€’â€œautoâ€ï¼Œdtype å°†è‡ªåŠ¨ä»æ¨¡å‹çš„æƒé‡ä¸­æ´¾ç”Ÿã€‚

+   `force_download` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦å¼ºåˆ¶ï¼ˆé‡æ–°ï¼‰ä¸‹è½½æ¨¡å‹æƒé‡å’Œé…ç½®æ–‡ä»¶ï¼Œè¦†ç›–ç¼“å­˜ç‰ˆæœ¬ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚

+   `cache_dir` (`Union[str, os.PathLike]`, *å¯é€‰*) â€” ä¸‹è½½é¢„è®­ç»ƒæ¨¡å‹é…ç½®çš„ç¼“å­˜è·¯å¾„ï¼Œå¦‚æœä¸ä½¿ç”¨æ ‡å‡†ç¼“å­˜ã€‚

+   `resume_download` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦æ¢å¤ä¸‹è½½æ¨¡å‹æƒé‡å’Œé…ç½®æ–‡ä»¶ã€‚å¦‚æœè®¾ç½®ä¸º `False`ï¼Œåˆ™åˆ é™¤ä»»ä½•æœªå®Œå…¨ä¸‹è½½çš„æ–‡ä»¶ã€‚

+   `proxies` (`Dict[str, str]`, *å¯é€‰*) â€” ä¸€ä¸ªä»£ç†æœåŠ¡å™¨å­—å…¸ï¼ŒæŒ‰åè®®æˆ–ç«¯ç‚¹ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼Œ`{'http': 'foo.bar:3128', 'http://hostname': 'foo.bar:4012'}`ã€‚è¿™äº›ä»£ç†ä¼šåœ¨æ¯ä¸ªè¯·æ±‚ä¸­ä½¿ç”¨ã€‚

+   `output_loading_info(bool,` *å¯é€‰*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦è¿”å›ä¸€ä¸ªåŒ…å«ç¼ºå¤±é”®ã€æ„å¤–é”®å’Œé”™è¯¯æ¶ˆæ¯çš„å­—å…¸ã€‚

+   `local_files_only` (`bool`, *optional*, defaults to `False`) â€” æ˜¯å¦ä»…åŠ è½½æœ¬åœ°æ¨¡å‹æƒé‡å’Œé…ç½®æ–‡ä»¶ã€‚å¦‚æœè®¾ç½®ä¸º`True`ï¼Œåˆ™ä¸ä¼šä» Hub ä¸‹è½½æ¨¡å‹ã€‚

+   `token` (`str` or *bool*, *optional*) â€” ç”¨ä½œè¿œç¨‹æ–‡ä»¶çš„ HTTP ä»¤ç‰Œã€‚å¦‚æœä¸º`True`ï¼Œåˆ™ä½¿ç”¨ä»`diffusers-cli login`ç”Ÿæˆçš„ä»¤ç‰Œï¼ˆå­˜å‚¨åœ¨`~/.huggingface`ä¸­ï¼‰ã€‚

+   `revision` (`str`, *optional*, defaults to `"main"`) â€” è¦ä½¿ç”¨çš„ç‰¹å®šæ¨¡å‹ç‰ˆæœ¬ã€‚å¯ä»¥æ˜¯åˆ†æ”¯åç§°ã€æ ‡ç­¾åç§°ã€æäº¤ ID æˆ– Git å…è®¸çš„ä»»ä½•æ ‡è¯†ç¬¦ã€‚

+   `custom_revision` (`str`, *optional*, defaults to `"main"`) â€” è¦ä½¿ç”¨çš„ç‰¹å®šæ¨¡å‹ç‰ˆæœ¬ã€‚å½“ä» Hub åŠ è½½è‡ªå®šä¹‰ç®¡é“æ—¶ï¼Œå¯ä»¥æ˜¯åˆ†æ”¯åç§°ã€æ ‡ç­¾åç§°æˆ–æäº¤ IDã€‚å½“ä» GitHub åŠ è½½è‡ªå®šä¹‰ç®¡é“æ—¶ï¼Œå¯ä»¥æ˜¯ğŸ¤— Diffusers ç‰ˆæœ¬ï¼Œå¦åˆ™åœ¨ä» Hub åŠ è½½æ—¶é»˜è®¤ä¸º`"main"`ã€‚

+   `mirror` (`str`, *optional*) â€” é•œåƒæºä»¥è§£å†³åœ¨ä¸­å›½ä¸‹è½½æ¨¡å‹æ—¶çš„å¯è®¿é—®æ€§é—®é¢˜ã€‚æˆ‘ä»¬ä¸ä¿è¯æºçš„åŠæ—¶æ€§æˆ–å®‰å…¨æ€§ï¼Œæ‚¨åº”å‚è€ƒé•œåƒç«™ç‚¹è·å–æ›´å¤šä¿¡æ¯ã€‚

+   `device_map` (`str` or `Dict[str, Union[int, str, torch.device]]`, *optional*) â€” æŒ‡å®šæ¯ä¸ªå­æ¨¡å—åº”è¯¥æ”¾åœ¨å“ªé‡Œçš„æ˜ å°„ã€‚ä¸éœ€è¦ä¸ºæ¯ä¸ªå‚æ•°/ç¼“å†²åŒºåç§°å®šä¹‰å®ƒï¼›ä¸€æ—¦ç»™å®šæ¨¡å—åç§°åœ¨å†…éƒ¨ï¼Œå®ƒçš„æ¯ä¸ªå­æ¨¡å—éƒ½å°†å‘é€åˆ°ç›¸åŒçš„è®¾å¤‡ã€‚

    è®¾ç½®`device_map="auto"`ä»¥ä½¿ğŸ¤— Accelerate è‡ªåŠ¨è®¡ç®—æœ€ä¼˜åŒ–çš„`device_map`ã€‚æœ‰å…³æ¯ä¸ªé€‰é¡¹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…[è®¾è®¡è®¾å¤‡æ˜ å°„](https://hf.co/docs/accelerate/main/en/usage_guides/big_modeling#designing-a-device-map)ã€‚

+   `max_memory` (`Dict`, *optional*) â€” ç”¨äºæœ€å¤§å†…å­˜çš„å­—å…¸è®¾å¤‡æ ‡è¯†ç¬¦ã€‚å¦‚æœæœªè®¾ç½®ï¼Œå°†é»˜è®¤ä¸ºæ¯ä¸ª GPU å’Œå¯ç”¨ CPU RAM çš„æœ€å¤§å†…å­˜ã€‚

+   `offload_folder` (`str` or `os.PathLike`, *optional*) â€” å¦‚æœ`device_map`åŒ…å«å€¼`"disk"`ï¼Œåˆ™ä¸ºå¸è½½æƒé‡çš„è·¯å¾„ã€‚

+   `offload_state_dict` (`bool`, *optional*) â€” å¦‚æœä¸º`True`ï¼Œåˆ™ä¸´æ—¶å°† CPU çŠ¶æ€å­—å…¸å¸è½½åˆ°ç¡¬ç›˜ï¼Œä»¥é¿å… CPU RAM ä¸è¶³ï¼Œå¦‚æœ CPU çŠ¶æ€å­—å…¸çš„æƒé‡+æ£€æŸ¥ç‚¹çš„æœ€å¤§åˆ†ç‰‡ä¸é€‚åˆã€‚å½“å­˜åœ¨ä¸€äº›ç£ç›˜å¸è½½æ—¶ï¼Œé»˜è®¤ä¸º`True`ã€‚

+   `low_cpu_mem_usage` (`bool`, *optional*, defaults to `True` if torch version >= 1.9.0 else `False`) â€” ä»…åŠ è½½é¢„è®­ç»ƒæƒé‡è€Œä¸åˆå§‹åŒ–æƒé‡ä»¥åŠ å¿«æ¨¡å‹åŠ è½½é€Ÿåº¦ã€‚åœ¨åŠ è½½æ¨¡å‹æ—¶ï¼Œå°è¯•ä¸ä½¿ç”¨è¶…è¿‡ 1 å€æ¨¡å‹å¤§å°çš„ CPU å†…å­˜ï¼ˆåŒ…æ‹¬å³°å€¼å†…å­˜ï¼‰ã€‚ä»…æ”¯æŒ PyTorch >= 1.9.0ã€‚å¦‚æœæ‚¨ä½¿ç”¨è¾ƒæ—§ç‰ˆæœ¬çš„ PyTorchï¼Œå°†æ­¤å‚æ•°è®¾ç½®ä¸º`True`å°†å¼•å‘é”™è¯¯ã€‚

+   `use_safetensors` (`bool`, *optional*, defaults to `None`) â€” å¦‚æœè®¾ç½®ä¸º`None`ï¼Œåˆ™åœ¨å¯ç”¨æ—¶ä¸‹è½½ safetensors æƒé‡ **å¹¶ä¸”** å¦‚æœå·²å®‰è£… safetensors åº“ã€‚å¦‚æœè®¾ç½®ä¸º`True`ï¼Œåˆ™å¼ºåˆ¶ä» safetensors æƒé‡åŠ è½½æ¨¡å‹ã€‚å¦‚æœè®¾ç½®ä¸º`False`ï¼Œåˆ™ä¸åŠ è½½ safetensors æƒé‡ã€‚

+   `kwargs`ï¼ˆå‰©ä½™çš„å…³é”®å­—å‚æ•°å­—å…¸ï¼Œ*å¯é€‰*ï¼‰ â€” å¯ç”¨äºè¦†ç›–åŠ è½½å’Œå¯ä¿å­˜å˜é‡ï¼ˆç‰¹å®šç®¡é“ç±»çš„ç®¡é“ç»„ä»¶ï¼‰ã€‚è¢«è¦†ç›–çš„ç»„ä»¶ç›´æ¥ä¼ é€’ç»™ç®¡é“çš„`__init__`æ–¹æ³•ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ä¸‹é¢çš„ç¤ºä¾‹ã€‚

+   `variant` (`str`, *optional*) â€” ä»æŒ‡å®šçš„å˜ä½“æ–‡ä»¶åï¼ˆå¦‚`"fp16"`æˆ–`"ema"`ï¼‰åŠ è½½æƒé‡ã€‚åœ¨åŠ è½½`from_flax`æ—¶ä¼šè¢«å¿½ç•¥ã€‚

ä»é¢„è®­ç»ƒç®¡é“æƒé‡å®ä¾‹åŒ–ä¸€ä¸ªæ–‡æœ¬åˆ°å›¾åƒçš„ Pytorch æ‰©æ•£ç®¡é“ã€‚

from_pretrained()æ–¹æ³•è´Ÿè´£é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿”å›æ­£ç¡®çš„ç®¡é“ç±»å®ä¾‹ï¼š

1.  æ ¹æ®å…¶é…ç½®å¯¹è±¡çš„ _class_name å±æ€§æ£€æµ‹é¢„è®­ç»ƒæ¨¡å‹æˆ–è·¯å¾„çš„ç®¡é“ç±»

1.  é€šè¿‡å¯¹ç®¡é“ç±»åç§°è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œæ‰¾åˆ°ä¸ç®¡é“ç±»ç›¸å…³è”çš„æ–‡æœ¬åˆ°å›¾åƒç®¡é“ã€‚

å¦‚æœä¼ é€’äº†ä¸€ä¸ª `controlnet` å‚æ•°ï¼Œå®ƒå°†å®ä¾‹åŒ–ä¸€ä¸ª StableDiffusionControlNetPipeline å¯¹è±¡ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œç®¡é“è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼ (`model.eval()`)ã€‚

å¦‚æœæ”¶åˆ°ä»¥ä¸‹é”™è¯¯æ¶ˆæ¯ï¼Œåˆ™éœ€è¦ä¸ºä¸‹æ¸¸ä»»åŠ¡å¾®è°ƒæƒé‡:

```py
Some weights of UNet2DConditionModel were not initialized from the model checkpoint at runwayml/stable-diffusion-v1-5 and are newly initialized because the shapes did not match:
- conv_in.weight: found shape torch.Size([320, 4, 3, 3]) in the checkpoint and torch.Size([320, 9, 3, 3]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
```

è¦ä½¿ç”¨ç§æœ‰æˆ–[é—¨æ§](https://huggingface.co/docs/hub/models-gated#gated-models)æ¨¡å‹ï¼Œè¯·ä½¿ç”¨ `huggingface-cli login` ç™»å½•ã€‚

ç¤ºä¾‹:

```py
>>> from diffusers import AutoPipelineForText2Image

>>> pipeline = AutoPipelineForText2Image.from_pretrained("runwayml/stable-diffusion-v1-5")
>>> image = pipeline(prompt).images[0]
```

#### `from_pipe`

[<æ¥æº>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/pipelines/auto_pipeline.py#L346)

```py
( pipeline **kwargs )
```

å‚æ•°

+   `pipeline` (`DiffusionPipeline`) â€” ä¸€ä¸ªå®ä¾‹åŒ–çš„ `DiffusionPipeline` å¯¹è±¡

ä»å¦ä¸€ä¸ªå®ä¾‹åŒ–çš„æ‰©æ•£ç®¡é“ç±»å®ä¾‹åŒ–ä¸€ä¸ªæ–‡æœ¬åˆ°å›¾åƒ Pytorch æ‰©æ•£ç®¡é“ã€‚

from_pipe() æ–¹æ³•è´Ÿè´£é€šè¿‡åœ¨ç®¡é“ç±»åç§°ä¸Šè¿›è¡Œæ¨¡å¼åŒ¹é…æ‰¾åˆ°ä¸ç®¡é“ç±»é“¾æ¥çš„æ–‡æœ¬åˆ°å›¾åƒç®¡é“çš„æ­£ç¡®ç®¡é“ç±»å®ä¾‹ã€‚

ç®¡é“åŒ…å«çš„æ‰€æœ‰æ¨¡å—å°†ç”¨äºåˆå§‹åŒ–æ–°ç®¡é“ï¼Œè€Œä¸é‡æ–°åˆ†é…é¢å¤–çš„å†…å­˜ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œç®¡é“è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼ (`model.eval()`)ã€‚

```py
>>> from diffusers import AutoPipelineForText2Image, AutoPipelineForImage2Image

>>> pipe_i2i = AutoPipelineForImage2Image.from_pretrained(
...     "runwayml/stable-diffusion-v1-5", requires_safety_checker=False
... )

>>> pipe_t2i = AutoPipelineForText2Image.from_pipe(pipe_i2i)
>>> image = pipe_t2i(prompt).images[0]
```

## AutoPipelineForImage2Image

### `class diffusers.AutoPipelineForImage2Image`

[<æ¥æº>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/pipelines/auto_pipeline.py#L447)

```py
( *args **kwargs )
```

AutoPipelineForImage2Image æ˜¯ä¸€ä¸ªé€šç”¨ç®¡é“ç±»ï¼Œå®ä¾‹åŒ–ä¸€ä¸ªå›¾åƒåˆ°å›¾åƒç®¡é“ç±»ã€‚å…·ä½“çš„åº•å±‚ç®¡é“ç±»ä¼šè‡ªåŠ¨ä» from_pretrained() æˆ– from_pipe() æ–¹æ³•ä¸­é€‰æ‹©ã€‚

æ­¤ç±»ä¸èƒ½ä½¿ç”¨ `__init__()` å®ä¾‹åŒ–ï¼ˆä¼šæŠ›å‡ºé”™è¯¯ï¼‰ã€‚

ç±»å±æ€§:

+   `config_name` (`str`) â€” å­˜å‚¨æ‰€æœ‰æ‰©æ•£ç®¡é“ç»„ä»¶çš„ç±»å’Œæ¨¡å—åç§°çš„é…ç½®æ–‡ä»¶åã€‚

#### `from_pretrained`

[<æ¥æº>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/pipelines/auto_pipeline.py#L472)

```py
( pretrained_model_or_path **kwargs )
```

å‚æ•°

+   `pretrained_model_name_or_path` (`str` æˆ– `os.PathLike`, *å¯é€‰*) â€” å¯ä»¥æ˜¯:

    +   ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé¢„è®­ç»ƒç®¡é“çš„ *repo id*ï¼ˆä¾‹å¦‚ `CompVis/ldm-text2im-large-256`ï¼‰ï¼Œæ‰˜ç®¡åœ¨ Hub ä¸Šã€‚

    +   ä¸€ä¸ª *ç›®å½•* è·¯å¾„ï¼ˆä¾‹å¦‚ `./my_pipeline_directory/`ï¼‰ï¼Œå…¶ä¸­åŒ…å«ä½¿ç”¨ save_pretrained() ä¿å­˜çš„ç®¡é“æƒé‡ã€‚

+   `torch_dtype` (`str` æˆ– `torch.dtype`, *å¯é€‰*) â€” è¦†ç›–é»˜è®¤çš„ `torch.dtype` å¹¶ä½¿ç”¨å¦ä¸€ç§ dtype åŠ è½½æ¨¡å‹ã€‚å¦‚æœä¼ é€’â€œautoâ€ï¼Œdtype å°†ä»æ¨¡å‹çš„æƒé‡è‡ªåŠ¨æ¨å¯¼ã€‚

+   `force_download` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦å¼ºåˆ¶ï¼ˆé‡æ–°ï¼‰ä¸‹è½½æ¨¡å‹æƒé‡å’Œé…ç½®æ–‡ä»¶ï¼Œè¦†ç›–ç¼“å­˜ç‰ˆæœ¬ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚

+   `cache_dir` (`Union[str, os.PathLike]`, *å¯é€‰*) â€” ä¸‹è½½çš„é¢„è®­ç»ƒæ¨¡å‹é…ç½®ç¼“å­˜åœ¨æ ‡å‡†ç¼“å­˜æœªä½¿ç”¨æ—¶çš„ç›®å½•è·¯å¾„ã€‚

+   `resume_download` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦æ¢å¤ä¸‹è½½æ¨¡å‹æƒé‡å’Œé…ç½®æ–‡ä»¶ã€‚å¦‚æœè®¾ç½®ä¸º `False`ï¼Œåˆ™åˆ é™¤ä»»ä½•æœªå®Œå…¨ä¸‹è½½çš„æ–‡ä»¶ã€‚

+   `proxies` (`Dict[str, str]`, *å¯é€‰*) â€” ä¸€ä¸ªæŒ‰åè®®æˆ–ç«¯ç‚¹ä½¿ç”¨çš„ä»£ç†æœåŠ¡å™¨å­—å…¸ï¼Œä¾‹å¦‚ï¼Œ`{'http': 'foo.bar:3128', 'http://hostname': 'foo.bar:4012'}`ã€‚ä»£ç†åœ¨æ¯ä¸ªè¯·æ±‚ä¸Šä½¿ç”¨ã€‚

+   `output_loading_info(bool,` *å¯é€‰*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦è¿”å›ä¸€ä¸ªåŒ…å«ç¼ºå¤±é”®ã€æ„å¤–é”®å’Œé”™è¯¯æ¶ˆæ¯çš„å­—å…¸ã€‚

+   `local_files_only`ï¼ˆ`bool`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`False`ï¼‰â€” æ˜¯å¦ä»…åŠ è½½æœ¬åœ°æ¨¡å‹æƒé‡å’Œé…ç½®æ–‡ä»¶ã€‚å¦‚æœè®¾ç½®ä¸º`True`ï¼Œåˆ™ä¸ä¼šä» Hub ä¸‹è½½æ¨¡å‹ã€‚

+   `token`ï¼ˆ`str`æˆ–*bool*ï¼Œ*å¯é€‰*ï¼‰â€” ç”¨ä½œè¿œç¨‹æ–‡ä»¶çš„ HTTP bearer æˆæƒçš„ä»¤ç‰Œã€‚å¦‚æœä¸º`True`ï¼Œåˆ™ä½¿ç”¨ä»`diffusers-cli login`ç”Ÿæˆçš„ä»¤ç‰Œï¼ˆå­˜å‚¨åœ¨`~/.huggingface`ä¸­ï¼‰ã€‚

+   `revision`ï¼ˆ`str`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`"main"`ï¼‰â€” è¦ä½¿ç”¨çš„ç‰¹å®šæ¨¡å‹ç‰ˆæœ¬ã€‚å¯ä»¥æ˜¯åˆ†æ”¯åç§°ã€æ ‡ç­¾åç§°ã€æäº¤ ID æˆ– Git å…è®¸çš„ä»»ä½•æ ‡è¯†ç¬¦ã€‚

+   `custom_revision`ï¼ˆ`str`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`"main"`ï¼‰â€” è¦ä½¿ç”¨çš„ç‰¹å®šæ¨¡å‹ç‰ˆæœ¬ã€‚å¯ä»¥æ˜¯åˆ†æ”¯åç§°ã€æ ‡ç­¾åç§°æˆ–æäº¤ IDï¼Œç±»ä¼¼äºä» Hub åŠ è½½è‡ªå®šä¹‰ç®¡é“æ—¶çš„`revision`ã€‚åœ¨ä» GitHub åŠ è½½è‡ªå®šä¹‰ç®¡é“æ—¶å¯ä»¥æ˜¯ğŸ¤— Diffusers ç‰ˆæœ¬ï¼Œå¦åˆ™åœ¨ä» Hub åŠ è½½æ—¶é»˜è®¤ä¸º`"main"`ã€‚

+   `mirror`ï¼ˆ`str`ï¼Œ*å¯é€‰*ï¼‰â€” é•œåƒæºä»¥è§£å†³åœ¨ä¸­å›½ä¸‹è½½æ¨¡å‹æ—¶çš„å¯è®¿é—®æ€§é—®é¢˜ã€‚æˆ‘ä»¬ä¸ä¿è¯æºçš„åŠæ—¶æ€§æˆ–å®‰å…¨æ€§ï¼Œæ‚¨åº”å‚è€ƒé•œåƒç«™ç‚¹è·å–æ›´å¤šä¿¡æ¯ã€‚

+   `device_map`ï¼ˆ`str`æˆ–`Dict[strï¼ŒUnion[intï¼Œstrï¼Œtorch.device]]`ï¼Œ*å¯é€‰*ï¼‰â€” æŒ‡å®šæ¯ä¸ªå­æ¨¡å—åº”æ”¾ç½®åœ¨ä½•å¤„çš„æ˜ å°„ã€‚ä¸éœ€è¦ä¸ºæ¯ä¸ªå‚æ•°/ç¼“å†²åŒºåç§°å®šä¹‰å®ƒï¼›ä¸€æ—¦ç»™å®šæ¨¡å—åç§°åœ¨å†…éƒ¨ï¼Œå®ƒçš„æ¯ä¸ªå­æ¨¡å—éƒ½å°†å‘é€åˆ°ç›¸åŒçš„è®¾å¤‡ã€‚

    è®¾ç½®`device_map="auto"`ä»¥ä½¿ğŸ¤— Accelerate è‡ªåŠ¨è®¡ç®—æœ€ä¼˜åŒ–çš„`device_map`ã€‚æœ‰å…³æ¯ä¸ªé€‰é¡¹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§[è®¾è®¡è®¾å¤‡æ˜ å°„](https://hf.co/docs/accelerate/main/en/usage_guides/big_modeling#designing-a-device-map)ã€‚

+   `max_memory`ï¼ˆ`Dict`ï¼Œ*å¯é€‰*ï¼‰â€” ç”¨äºæœ€å¤§å†…å­˜çš„å­—å…¸è®¾å¤‡æ ‡è¯†ç¬¦ã€‚å¦‚æœæœªè®¾ç½®ï¼Œå°†é»˜è®¤ä¸ºæ¯ä¸ª GPU å’Œå¯ç”¨ CPU RAM çš„æœ€å¤§å†…å­˜ã€‚

+   `offload_folder`ï¼ˆ`str`æˆ–`os.PathLike`ï¼Œ*å¯é€‰*ï¼‰â€” å¦‚æœ`device_map`åŒ…å«å€¼`"disk"`ï¼Œåˆ™ä¸ºå¸è½½æƒé‡çš„è·¯å¾„ã€‚

+   `offload_state_dict`ï¼ˆ`bool`ï¼Œ*å¯é€‰*ï¼‰â€” å¦‚æœä¸º`True`ï¼Œåˆ™ä¸´æ—¶å°† CPU çŠ¶æ€å­—å…¸å¸è½½åˆ°ç¡¬ç›˜ï¼Œä»¥é¿å… CPU RAM çš„æƒé‡ + æ£€æŸ¥ç‚¹çš„æœ€å¤§åˆ†ç‰‡ä¸é€‚åˆçš„æƒ…å†µã€‚å½“å­˜åœ¨ä¸€äº›ç£ç›˜å¸è½½æ—¶ï¼Œé»˜è®¤ä¸º`True`ã€‚

+   `low_cpu_mem_usage`ï¼ˆ`bool`ï¼Œ*å¯é€‰*ï¼Œå¦‚æœ torch ç‰ˆæœ¬ >= 1.9.0 åˆ™é»˜è®¤ä¸º`True`ï¼Œå¦åˆ™ä¸º`False`ï¼‰â€” åŠ å¿«æ¨¡å‹åŠ è½½ï¼Œä»…åŠ è½½é¢„è®­ç»ƒæƒé‡è€Œä¸åˆå§‹åŒ–æƒé‡ã€‚åœ¨åŠ è½½æ¨¡å‹æ—¶ï¼Œè¿˜å°è¯•ä¸ä½¿ç”¨è¶…è¿‡ CPU å†…å­˜ä¸­çš„ 1 å€æ¨¡å‹å¤§å°ï¼ˆåŒ…æ‹¬å³°å€¼å†…å­˜ï¼‰ã€‚ä»…æ”¯æŒ PyTorch >= 1.9.0ã€‚å¦‚æœæ‚¨ä½¿ç”¨è¾ƒæ—§ç‰ˆæœ¬çš„ PyTorchï¼Œå°†æ­¤å‚æ•°è®¾ç½®ä¸º`True`å°†å¼•å‘é”™è¯¯ã€‚

+   `use_safetensors`ï¼ˆ`bool`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`None`ï¼‰â€” å¦‚æœè®¾ç½®ä¸º`None`ï¼Œåˆ™åœ¨å¯ç”¨æ—¶ä¸‹è½½ safetensors æƒé‡ **å¹¶ä¸”** å¦‚æœå·²å®‰è£… safetensors åº“ã€‚å¦‚æœè®¾ç½®ä¸º`True`ï¼Œåˆ™æ¨¡å‹å°†å¼ºåˆ¶ä» safetensors æƒé‡åŠ è½½ã€‚å¦‚æœè®¾ç½®ä¸º`False`ï¼Œåˆ™ä¸åŠ è½½ safetensors æƒé‡ã€‚

+   `kwargs`ï¼ˆå‰©ä½™çš„å…³é”®å­—å‚æ•°å­—å…¸ï¼Œ*å¯é€‰*ï¼‰â€” å¯ç”¨äºè¦†ç›–åŠ è½½å’Œä¿å­˜å˜é‡ï¼ˆç‰¹å®šç®¡é“ç±»çš„ç®¡é“ç»„ä»¶ï¼‰ã€‚è¢«è¦†ç›–çš„ç»„ä»¶ç›´æ¥ä¼ é€’ç»™ç®¡é“çš„`__init__`æ–¹æ³•ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§ä¸‹é¢çš„ç¤ºä¾‹ã€‚

+   `variant`ï¼ˆ`str`ï¼Œ*å¯é€‰*ï¼‰â€” ä»æŒ‡å®šçš„å˜ä½“æ–‡ä»¶åï¼ˆä¾‹å¦‚`"fp16"`æˆ–`"ema"`ï¼‰åŠ è½½æƒé‡ã€‚åœ¨åŠ è½½`from_flax`æ—¶ä¼šå¿½ç•¥æ­¤é€‰é¡¹ã€‚

ä»é¢„è®­ç»ƒç®¡é“æƒé‡å®ä¾‹åŒ–ä¸€ä¸ªå›¾åƒåˆ°å›¾åƒçš„ Pytorch æ‰©æ•£ç®¡é“ã€‚

`from_pretrained()`æ–¹æ³•è´Ÿè´£é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿”å›æ­£ç¡®çš„ç®¡é“ç±»å®ä¾‹ï¼š

1.  æ ¹æ®å…¶é…ç½®å¯¹è±¡çš„ _class_name å±æ€§æ£€æµ‹é¢„è®­ç»ƒæ¨¡å‹æˆ–è·¯å¾„çš„ç®¡é“ç±»

1.  é€šè¿‡åœ¨ç®¡é“ç±»åç§°ä¸Šè¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œæ‰¾åˆ°ä¸ç®¡é“ç±»ç›¸å…³è”çš„å›¾åƒåˆ°å›¾åƒç®¡é“ã€‚

å¦‚æœä¼ é€’äº† `controlnet` å‚æ•°ï¼Œå®ƒå°†å®ä¾‹åŒ–ä¸€ä¸ª StableDiffusionControlNetImg2ImgPipeline å¯¹è±¡ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œç®¡é“è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼ï¼ˆ`model.eval()`ï¼‰ã€‚

å¦‚æœæ‚¨æ”¶åˆ°ä»¥ä¸‹é”™è¯¯æ¶ˆæ¯ï¼Œåˆ™éœ€è¦ä¸ºä¸‹æ¸¸ä»»åŠ¡å¾®è°ƒæƒé‡ï¼š

```py
Some weights of UNet2DConditionModel were not initialized from the model checkpoint at runwayml/stable-diffusion-v1-5 and are newly initialized because the shapes did not match:
- conv_in.weight: found shape torch.Size([320, 4, 3, 3]) in the checkpoint and torch.Size([320, 9, 3, 3]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
```

è¦ä½¿ç”¨ç§æœ‰æˆ–[é—¨æ§](https://huggingface.co/docs/hub/models-gated#gated-models)æ¨¡å‹ï¼Œè¯·ä½¿ç”¨ `huggingface-cli login` ç™»å½•ã€‚

ç¤ºä¾‹ï¼š

```py
>>> from diffusers import AutoPipelineForImage2Image

>>> pipeline = AutoPipelineForImage2Image.from_pretrained("runwayml/stable-diffusion-v1-5")
>>> image = pipeline(prompt, image).images[0]
```

#### `from_pipe`

[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/pipelines/auto_pipeline.py#L619)

```py
( pipeline **kwargs )
```

å‚æ•°

+   `pipeline` (`DiffusionPipeline`) â€” ä¸€ä¸ªå®ä¾‹åŒ–çš„ `DiffusionPipeline` å¯¹è±¡

ä»å¦ä¸€ä¸ªå·²å®ä¾‹åŒ–çš„æ‰©æ•£ç®¡é“ç±»å®ä¾‹åŒ–ä¸€ä¸ªå›¾åƒåˆ°å›¾åƒçš„ Pytorch æ‰©æ•£ç®¡é“ã€‚

from_pipe() æ–¹æ³•è´Ÿè´£é€šè¿‡åœ¨ç®¡é“ç±»åç§°ä¸Šè¿›è¡Œæ¨¡å¼åŒ¹é…æ‰¾åˆ°ä¸ç®¡é“ç±»é“¾æ¥çš„å›¾åƒåˆ°å›¾åƒç®¡é“çš„æ­£ç¡®ç®¡é“ç±»å®ä¾‹ã€‚

ç®¡é“åŒ…å«çš„æ‰€æœ‰æ¨¡å—å°†ç”¨äºåˆå§‹åŒ–æ–°ç®¡é“ï¼Œè€Œæ— éœ€é‡æ–°åˆ†é…é¢å¤–çš„å†…å­˜ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œç®¡é“è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼ï¼ˆ`model.eval()`ï¼‰ã€‚

ç¤ºä¾‹ï¼š

```py
>>> from diffusers import AutoPipelineForText2Image, AutoPipelineForImage2Image

>>> pipe_t2i = AutoPipelineForText2Image.from_pretrained(
...     "runwayml/stable-diffusion-v1-5", requires_safety_checker=False
... )

>>> pipe_i2i = AutoPipelineForImage2Image.from_pipe(pipe_t2i)
>>> image = pipe_i2i(prompt, image).images[0]
```

## AutoPipelineForInpainting

### `class diffusers.AutoPipelineForInpainting`

[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/pipelines/auto_pipeline.py#L724)

```py
( *args **kwargs )
```

AutoPipelineForInpainting æ˜¯ä¸€ä¸ªé€šç”¨ç®¡é“ç±»ï¼Œå®ä¾‹åŒ–ä¸€ä¸ªä¿®å¤ç®¡é“ç±»ã€‚å…·ä½“çš„åº•å±‚ç®¡é“ç±»ä¼šè‡ªåŠ¨ä» from_pretrained() æˆ– from_pipe() æ–¹æ³•ä¸­é€‰æ‹©ã€‚

æ­¤ç±»ä¸èƒ½ä½¿ç”¨ `__init__()` å®ä¾‹åŒ–ï¼ˆä¼šæŠ›å‡ºé”™è¯¯ï¼‰ã€‚

ç±»å±æ€§ï¼š

+   `config_name` (`str`) â€” å­˜å‚¨æ‰€æœ‰æ‰©æ•£ç®¡é“ç»„ä»¶ç±»å’Œæ¨¡å—åç§°çš„é…ç½®æ–‡ä»¶åã€‚

#### `from_pretrained`

[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/pipelines/auto_pipeline.py#L749)

```py
( pretrained_model_or_path **kwargs )
```

å‚æ•°

+   `pretrained_model_name_or_path` (`str` or `os.PathLike`, *optional*) â€” å¯ä»¥æ˜¯ï¼š

    +   ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé¢„è®­ç»ƒç®¡é“çš„*repo id*ï¼ˆä¾‹å¦‚ `CompVis/ldm-text2im-large-256`ï¼‰ã€‚

    +   ä¸€ä¸ª*ç›®å½•*çš„è·¯å¾„ï¼ˆä¾‹å¦‚ `./my_pipeline_directory/`ï¼‰ï¼Œå…¶ä¸­åŒ…å«ä½¿ç”¨ save_pretrained() ä¿å­˜çš„ç®¡é“æƒé‡ã€‚

+   `torch_dtype` (`str` or `torch.dtype`, *optional*) â€” è¦†ç›–é»˜è®¤çš„ `torch.dtype` å¹¶ä½¿ç”¨å¦ä¸€ç§æ•°æ®ç±»å‹åŠ è½½æ¨¡å‹ã€‚å¦‚æœä¼ é€’â€œautoâ€ï¼Œæ•°æ®ç±»å‹å°†è‡ªåŠ¨ä»æ¨¡å‹çš„æƒé‡ä¸­æ´¾ç”Ÿã€‚

+   `force_download` (`bool`, *optional*, defaults to `False`) â€” æ˜¯å¦å¼ºåˆ¶ï¼ˆé‡æ–°ï¼‰ä¸‹è½½æ¨¡å‹æƒé‡å’Œé…ç½®æ–‡ä»¶ï¼Œè¦†ç›–ç¼“å­˜ç‰ˆæœ¬ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚

+   `cache_dir` (`Union[str, os.PathLike]`, *optional*) â€” ä¸‹è½½é¢„è®­ç»ƒæ¨¡å‹é…ç½®çš„ç¼“å­˜è·¯å¾„ï¼Œå¦‚æœä¸ä½¿ç”¨æ ‡å‡†ç¼“å­˜ã€‚

+   `resume_download` (`bool`, *optional*, defaults to `False`) â€” æ˜¯å¦æ¢å¤ä¸‹è½½æ¨¡å‹æƒé‡å’Œé…ç½®æ–‡ä»¶ã€‚å¦‚æœè®¾ç½®ä¸º `False`ï¼Œåˆ™åˆ é™¤ä»»ä½•æœªå®Œå…¨ä¸‹è½½çš„æ–‡ä»¶ã€‚

+   `proxies` (`Dict[str, str]`, *optional*) â€” ä¸€ä¸ªæŒ‰åè®®æˆ–ç«¯ç‚¹ä½¿ç”¨çš„ä»£ç†æœåŠ¡å™¨å­—å…¸ï¼Œä¾‹å¦‚ï¼Œ`{'http': 'foo.bar:3128', 'http://hostname': 'foo.bar:4012'}`ã€‚ä»£ç†æœåŠ¡å™¨åœ¨æ¯ä¸ªè¯·æ±‚ä¸Šä½¿ç”¨ã€‚

+   `output_loading_info(bool,` *optional*, defaults to `False`) â€” æ˜¯å¦è¿”å›åŒ…å«ç¼ºå¤±é”®ã€æ„å¤–é”®å’Œé”™è¯¯æ¶ˆæ¯çš„å­—å…¸ã€‚

+   `local_files_only` (`bool`, *optional*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦ä»…åŠ è½½æœ¬åœ°æ¨¡å‹æƒé‡å’Œé…ç½®æ–‡ä»¶ã€‚å¦‚æœè®¾ç½®ä¸º `True`ï¼Œæ¨¡å‹å°†ä¸ä¼šä» Hub ä¸‹è½½ã€‚

+   `token` (`str` æˆ– *bool*, *optional*) â€” ç”¨ä½œè¿œç¨‹æ–‡ä»¶çš„ HTTP bearer æˆæƒçš„ä»¤ç‰Œã€‚å¦‚æœä¸º `True`ï¼Œåˆ™ä½¿ç”¨ä» `diffusers-cli login` ç”Ÿæˆçš„ä»¤ç‰Œï¼ˆå­˜å‚¨åœ¨ `~/.huggingface` ä¸­ï¼‰ã€‚

+   `revision` (`str`, *optional*, é»˜è®¤ä¸º `"main"`) â€” è¦ä½¿ç”¨çš„ç‰¹å®šæ¨¡å‹ç‰ˆæœ¬ã€‚å®ƒå¯ä»¥æ˜¯åˆ†æ”¯åç§°ã€æ ‡ç­¾åç§°ã€æäº¤ ID æˆ– Git å…è®¸çš„ä»»ä½•æ ‡è¯†ç¬¦ã€‚

+   `custom_revision` (`str`, *optional*, é»˜è®¤ä¸º `"main"`) â€” è¦ä½¿ç”¨çš„ç‰¹å®šæ¨¡å‹ç‰ˆæœ¬ã€‚å®ƒå¯ä»¥æ˜¯åˆ†æ”¯åç§°ã€æ ‡ç­¾åç§°æˆ–æäº¤ IDï¼Œç±»ä¼¼äºä» Hub åŠ è½½è‡ªå®šä¹‰ç®¡é“æ—¶çš„ `revision`ã€‚å½“ä» GitHub åŠ è½½è‡ªå®šä¹‰ç®¡é“æ—¶ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ª ğŸ¤— Diffusers ç‰ˆæœ¬ï¼Œå¦åˆ™åœ¨ä» Hub åŠ è½½æ—¶é»˜è®¤ä¸º `"main"`ã€‚

+   `mirror` (`str`, *optional*) â€” é•œåƒæºä»¥è§£å†³åœ¨ä¸­å›½ä¸‹è½½æ¨¡å‹æ—¶çš„å¯è®¿é—®æ€§é—®é¢˜ã€‚æˆ‘ä»¬ä¸ä¿è¯æºçš„åŠæ—¶æ€§æˆ–å®‰å…¨æ€§ï¼Œæ‚¨åº”å‚è€ƒé•œåƒç«™ç‚¹è·å–æ›´å¤šä¿¡æ¯ã€‚

+   `device_map` (`str` æˆ– `Dict[str, Union[int, str, torch.device]]`, *optional*) â€” æŒ‡å®šæ¯ä¸ªå­æ¨¡å—åº”è¯¥å»çš„æ˜ å°„ã€‚ä¸éœ€è¦ä¸ºæ¯ä¸ªå‚æ•°/ç¼“å†²å™¨åç§°å®šä¹‰ï¼›ä¸€æ—¦ç»™å®šæ¨¡å—åç§°åœ¨å†…éƒ¨ï¼Œå®ƒçš„æ¯ä¸ªå­æ¨¡å—éƒ½å°†å‘é€åˆ°ç›¸åŒçš„è®¾å¤‡ã€‚

    è®¾ç½® `device_map="auto"` ä»¥ä½¿ ğŸ¤— Accelerate è‡ªåŠ¨è®¡ç®—æœ€ä¼˜åŒ–çš„ `device_map`ã€‚æœ‰å…³æ¯ä¸ªé€‰é¡¹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§[è®¾è®¡è®¾å¤‡æ˜ å°„](https://hf.co/docs/accelerate/main/en/usage_guides/big_modeling#designing-a-device-map)ã€‚

+   `max_memory` (`Dict`, *optional*) â€” ç”¨äºæœ€å¤§å†…å­˜çš„å­—å…¸è®¾å¤‡æ ‡è¯†ç¬¦ã€‚å¦‚æœæœªè®¾ç½®ï¼Œå°†é»˜è®¤ä¸ºæ¯ä¸ª GPU å¯ç”¨çš„æœ€å¤§å†…å­˜å’Œå¯ç”¨çš„ CPU RAMã€‚

+   `offload_folder` (`str` æˆ– `os.PathLike`, *optional*) â€” å¦‚æœ device_map åŒ…å«å€¼ `"disk"`ï¼Œåˆ™æ˜¯å¸è½½æƒé‡çš„è·¯å¾„ã€‚

+   `offload_state_dict` (`bool`, *optional*) â€” å¦‚æœä¸º `True`ï¼Œåˆ™ä¸´æ—¶å°† CPU çŠ¶æ€å­—å…¸è½¬ç§»åˆ°ç¡¬ç›˜ï¼Œä»¥é¿å… CPU RAM ä¸è¶³ï¼Œå¦‚æœ CPU çŠ¶æ€å­—å…¸çš„æƒé‡ + æ£€æŸ¥ç‚¹çš„æœ€å¤§åˆ†ç‰‡çš„æƒé‡ä¸é€‚åˆã€‚å½“å­˜åœ¨ä¸€äº›ç£ç›˜å¸è½½æ—¶ï¼Œé»˜è®¤ä¸º `True`ã€‚

+   `low_cpu_mem_usage` (`bool`, *optional*, å¦‚æœ torch ç‰ˆæœ¬ >= 1.9.0 åˆ™é»˜è®¤ä¸º `True`ï¼Œå¦åˆ™ä¸º `False`) â€” åŠ é€Ÿæ¨¡å‹åŠ è½½ï¼Œä»…åŠ è½½é¢„è®­ç»ƒæƒé‡è€Œä¸åˆå§‹åŒ–æƒé‡ã€‚è¿™ä¹Ÿå°è¯•åœ¨åŠ è½½æ¨¡å‹æ—¶ä¸ä½¿ç”¨è¶…è¿‡ CPU å†…å­˜ä¸­çš„ 1x æ¨¡å‹å¤§å°ï¼ˆåŒ…æ‹¬å³°å€¼å†…å­˜ï¼‰ã€‚ä»…æ”¯æŒ PyTorch >= 1.9.0ã€‚å¦‚æœæ‚¨ä½¿ç”¨è¾ƒæ—§ç‰ˆæœ¬çš„ PyTorchï¼Œå°†æ­¤å‚æ•°è®¾ç½®ä¸º `True` å°†å¼•å‘é”™è¯¯ã€‚

+   `use_safetensors` (`bool`, *optional*, é»˜è®¤ä¸º `None`) â€” å¦‚æœè®¾ç½®ä¸º `None`ï¼Œåˆ™åœ¨å¯ç”¨æ—¶ä¸‹è½½ safetensors æƒé‡ **å¹¶ä¸”** å¦‚æœå·²å®‰è£… safetensors åº“ã€‚å¦‚æœè®¾ç½®ä¸º `True`ï¼Œåˆ™å¼ºåˆ¶ä» safetensors æƒé‡åŠ è½½æ¨¡å‹ã€‚å¦‚æœè®¾ç½®ä¸º `False`ï¼Œåˆ™ä¸åŠ è½½ safetensors æƒé‡ã€‚

+   `kwargs`ï¼ˆå‰©ä½™çš„å…³é”®å­—å‚æ•°å­—å…¸ï¼Œ*optional*ï¼‰ â€” å¯ç”¨äºè¦†ç›–åŠ è½½å’Œå¯ä¿å­˜å˜é‡ï¼ˆç‰¹å®šç®¡é“ç±»çš„ç®¡é“ç»„ä»¶ï¼‰ã€‚è¢«è¦†ç›–çš„ç»„ä»¶å°†ç›´æ¥ä¼ é€’ç»™ç®¡é“çš„ `__init__` æ–¹æ³•ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§ä¸‹é¢çš„ç¤ºä¾‹ã€‚

+   `variant` (`str`, *optional*) â€” ä»æŒ‡å®šçš„å˜ä½“æ–‡ä»¶åï¼ˆå¦‚ `"fp16"` æˆ– `"ema"`ï¼‰åŠ è½½æƒé‡ã€‚åœ¨åŠ è½½ `from_flax` æ—¶ä¼šå¿½ç•¥æ­¤é€‰é¡¹ã€‚

ä»é¢„è®­ç»ƒç®¡é“æƒé‡å®ä¾‹åŒ–ä¸€ä¸ªä¿®å¤ Pytorch æ‰©æ•£ç®¡é“ã€‚

from_pretrained() æ–¹æ³•è´Ÿè´£é€šè¿‡è¿”å›æ­£ç¡®çš„ç®¡é“ç±»å®ä¾‹ï¼š

1.  åŸºäºå…¶é…ç½®å¯¹è±¡çš„ _class_name å±æ€§ï¼Œæ£€æµ‹ pretrained_model_or_path çš„ç®¡é“ç±»ã€‚

1.  ä½¿ç”¨ç®¡é“ç±»åç§°ä¸Šçš„æ¨¡å¼åŒ¹é…æ‰¾åˆ°ä¸ç®¡é“ç±»ç›¸å…³è”çš„ä¿®å¤ç®¡é“ã€‚

å¦‚æœä¼ é€’äº† `controlnet` å‚æ•°ï¼Œå®ƒå°†å®ä¾‹åŒ–ä¸€ä¸ª StableDiffusionControlNetInpaintPipeline å¯¹è±¡ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œç®¡é“è¢«è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼ (`model.eval()`)ã€‚

å¦‚æœæ‚¨æ”¶åˆ°ä¸‹é¢çš„é”™è¯¯æ¶ˆæ¯ï¼Œåˆ™éœ€è¦å¾®è°ƒæƒé‡ä»¥é€‚åº”æ‚¨çš„ä¸‹æ¸¸ä»»åŠ¡ï¼š

```py
Some weights of UNet2DConditionModel were not initialized from the model checkpoint at runwayml/stable-diffusion-v1-5 and are newly initialized because the shapes did not match:
- conv_in.weight: found shape torch.Size([320, 4, 3, 3]) in the checkpoint and torch.Size([320, 9, 3, 3]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
```

è¦ä½¿ç”¨ç§æœ‰æˆ– [é—¨æ§](https://huggingface.co/docs/hub/models-gated#gated-models) æ¨¡å‹ï¼Œè¯·ä½¿ç”¨ `huggingface-cli login` ç™»å½•ã€‚

ç¤ºä¾‹ï¼š

```py
>>> from diffusers import AutoPipelineForInpainting

>>> pipeline = AutoPipelineForInpainting.from_pretrained("runwayml/stable-diffusion-v1-5")
>>> image = pipeline(prompt, image=init_image, mask_image=mask_image).images[0]
```

#### `from_pipe`

[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/pipelines/auto_pipeline.py#L895)

```py
( pipeline **kwargs )
```

å‚æ•°

+   `pipeline` (`DiffusionPipeline`) â€” ä¸€ä¸ªå®ä¾‹åŒ–çš„ `DiffusionPipeline` å¯¹è±¡

ä»å¦ä¸€ä¸ªå®ä¾‹åŒ–çš„æ‰©æ•£ç®¡é“ç±»å®ä¾‹åŒ–ä¸€ä¸ªä¿®è¡¥ Pytorch æ‰©æ•£ç®¡é“ã€‚

from_pipe() æ–¹æ³•è´Ÿè´£é€šè¿‡åœ¨ç®¡é“ç±»åç§°ä¸Šè¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œæ‰¾åˆ°ä¸ç®¡é“ç±»ç›¸å…³è”çš„ä¿®è¡¥ç®¡é“ï¼Œä»è€Œè¿”å›æ­£ç¡®çš„ç®¡é“ç±»å®ä¾‹ã€‚

ç®¡é“ç±»åŒ…å«çš„æ‰€æœ‰æ¨¡å—å°†ç”¨äºåˆå§‹åŒ–æ–°ç®¡é“ï¼Œè€Œä¸éœ€è¦é‡æ–°åˆ†é…é¢å¤–çš„å†…å­˜ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œç®¡é“è¢«è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼ (`model.eval()`)ã€‚

ç¤ºä¾‹ï¼š

```py
>>> from diffusers import AutoPipelineForText2Image, AutoPipelineForInpainting

>>> pipe_t2i = AutoPipelineForText2Image.from_pretrained(
...     "DeepFloyd/IF-I-XL-v1.0", requires_safety_checker=False
... )

>>> pipe_inpaint = AutoPipelineForInpainting.from_pipe(pipe_t2i)
>>> image = pipe_inpaint(prompt, image=init_image, mask_image=mask_image).images[0]
```
