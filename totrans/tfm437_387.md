# æ—¶é—´åºåˆ—Transformer

> åŸå§‹æ–‡æœ¬ï¼š[https://huggingface.co/docs/transformers/v4.37.2/en/model_doc/time_series_transformer](https://huggingface.co/docs/transformers/v4.37.2/en/model_doc/time_series_transformer)

## æ¦‚è¿°

æ—¶é—´åºåˆ—Transformeræ¨¡å‹æ˜¯ç”¨äºæ—¶é—´åºåˆ—é¢„æµ‹çš„åŸºæœ¬ç¼–ç å™¨-è§£ç å™¨Transformerã€‚æ­¤æ¨¡å‹ç”±[kashif](https://huggingface.co/kashif)è´¡çŒ®ã€‚

## ä½¿ç”¨æç¤º

+   ä¸åº“ä¸­å…¶ä»–æ¨¡å‹ç±»ä¼¼ï¼Œ[TimeSeriesTransformerModel](/docs/transformers/v4.37.2/en/model_doc/time_series_transformer#transformers.TimeSeriesTransformerModel)æ˜¯æ²¡æœ‰é¡¶éƒ¨å¤´éƒ¨çš„åŸå§‹Transformerï¼Œè€Œ[TimeSeriesTransformerForPrediction](/docs/transformers/v4.37.2/en/model_doc/time_series_transformer#transformers.TimeSeriesTransformerForPrediction)åœ¨å‰è€…çš„é¡¶éƒ¨æ·»åŠ äº†ä¸€ä¸ªåˆ†å¸ƒå¤´éƒ¨ï¼Œå¯ç”¨äºæ—¶é—´åºåˆ—é¢„æµ‹ã€‚è¯·æ³¨æ„ï¼Œè¿™æ˜¯ä¸€ç§æ‰€è°“çš„æ¦‚ç‡é¢„æµ‹æ¨¡å‹ï¼Œè€Œä¸æ˜¯ç‚¹é¢„æµ‹æ¨¡å‹ã€‚è¿™æ„å‘³ç€æ¨¡å‹å­¦ä¹ ä¸€ä¸ªåˆ†å¸ƒï¼Œå¯ä»¥ä»ä¸­è¿›è¡Œé‡‡æ ·ã€‚è¯¥æ¨¡å‹ä¸ç›´æ¥è¾“å‡ºå€¼ã€‚

+   [TimeSeriesTransformerForPrediction](/docs/transformers/v4.37.2/en/model_doc/time_series_transformer#transformers.TimeSeriesTransformerForPrediction)ç”±2ä¸ªæ¨¡å—ç»„æˆï¼šç¼–ç å™¨ï¼Œæ¥å—æ—¶é—´åºåˆ—å€¼çš„`context_length`ä½œä¸ºè¾“å…¥ï¼ˆç§°ä¸º`past_values`ï¼‰ï¼Œè§£ç å™¨ï¼Œé¢„æµ‹æœªæ¥çš„`prediction_length`æ—¶é—´åºåˆ—å€¼ï¼ˆç§°ä¸º`future_values`ï¼‰ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œéœ€è¦å‘æ¨¡å‹æä¾›ï¼ˆ`past_values`å’Œ`future_values`ï¼‰çš„é…å¯¹æ•°æ®ã€‚

+   é™¤äº†åŸå§‹çš„ï¼ˆ`past_values`å’Œ`future_values`ï¼‰ä¹‹å¤–ï¼Œé€šå¸¸è¿˜å‘æ¨¡å‹æä¾›å…¶ä»–ç‰¹å¾ã€‚è¿™äº›å¯ä»¥æ˜¯ä»¥ä¸‹å†…å®¹ï¼š

    +   `past_time_features`ï¼šæ¨¡å‹å°†æ·»åŠ åˆ°`past_values`çš„æ—¶é—´ç‰¹å¾ã€‚è¿™äº›ä½œä¸ºTransformerç¼–ç å™¨çš„â€œä½ç½®ç¼–ç â€ã€‚ä¾‹å¦‚ï¼Œâ€œæœˆä»½çš„æ—¥æœŸâ€ï¼Œâ€œå¹´ä»½çš„æœˆä»½â€ç­‰ä½œä¸ºæ ‡é‡å€¼ï¼ˆç„¶åå †å åœ¨ä¸€èµ·å½¢æˆå‘é‡ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç»™å®šçš„æ—¶é—´åºåˆ—å€¼æ˜¯åœ¨8æœˆ11æ—¥è·å¾—çš„ï¼Œåˆ™å¯ä»¥å°†[11, 8]ä½œä¸ºæ—¶é—´ç‰¹å¾å‘é‡ï¼ˆ11ä»£è¡¨â€œæœˆä»½çš„æ—¥æœŸâ€ï¼Œ8ä»£è¡¨â€œå¹´ä»½çš„æœˆä»½â€ï¼‰ã€‚

    +   `future_time_features`ï¼šæ¨¡å‹å°†æ·»åŠ åˆ°`future_values`çš„æ—¶é—´ç‰¹å¾ã€‚è¿™äº›ä½œä¸ºTransformerè§£ç å™¨çš„â€œä½ç½®ç¼–ç â€ã€‚ä¾‹å¦‚ï¼Œâ€œæœˆä»½çš„æ—¥æœŸâ€ï¼Œâ€œå¹´ä»½çš„æœˆä»½â€ç­‰ä½œä¸ºæ ‡é‡å€¼ï¼ˆç„¶åå †å åœ¨ä¸€èµ·å½¢æˆå‘é‡ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç»™å®šçš„æ—¶é—´åºåˆ—å€¼æ˜¯åœ¨8æœˆ11æ—¥è·å¾—çš„ï¼Œåˆ™å¯ä»¥å°†[11, 8]ä½œä¸ºæ—¶é—´ç‰¹å¾å‘é‡ï¼ˆ11ä»£è¡¨â€œæœˆä»½çš„æ—¥æœŸâ€ï¼Œ8ä»£è¡¨â€œå¹´ä»½çš„æœˆä»½â€ï¼‰ã€‚

    +   `static_categorical_features`ï¼šéšæ—¶é—´ä¿æŒä¸å˜çš„åˆ†ç±»ç‰¹å¾ï¼ˆå³æ‰€æœ‰`past_values`å’Œ`future_values`å…·æœ‰ç›¸åŒçš„å€¼ï¼‰ã€‚ä¸€ä¸ªä¾‹å­æ˜¯æ ‡è¯†ç»™å®šæ—¶é—´åºåˆ—çš„å•†åº—IDæˆ–åœ°åŒºIDã€‚è¯·æ³¨æ„ï¼Œè¿™äº›ç‰¹å¾éœ€è¦å¯¹æ‰€æœ‰æ•°æ®ç‚¹ï¼ˆåŒ…æ‹¬æœªæ¥çš„æ•°æ®ç‚¹ï¼‰éƒ½æ˜¯å·²çŸ¥çš„ã€‚

    +   `static_real_features`ï¼šéšæ—¶é—´ä¿æŒä¸å˜çš„å®å€¼ç‰¹å¾ï¼ˆå³æ‰€æœ‰`past_values`å’Œ`future_values`å…·æœ‰ç›¸åŒçš„å€¼ï¼‰ã€‚ä¸€ä¸ªä¾‹å­æ˜¯äº§å“çš„å›¾åƒè¡¨ç¤ºï¼Œæ‚¨æ‹¥æœ‰è¯¥äº§å“çš„æ—¶é—´åºåˆ—å€¼ï¼ˆæ¯”å¦‚å…³äºé‹å­é”€å”®çš„æ—¶é—´åºåˆ—çš„[ResNet](resnet)åµŒå…¥çš„â€œé‹å­â€å›¾ç‰‡ï¼‰ã€‚è¯·æ³¨æ„ï¼Œè¿™äº›ç‰¹å¾éœ€è¦å¯¹æ‰€æœ‰æ•°æ®ç‚¹ï¼ˆåŒ…æ‹¬æœªæ¥çš„æ•°æ®ç‚¹ï¼‰éƒ½æ˜¯å·²çŸ¥çš„ã€‚

+   è¯¥æ¨¡å‹ä½¿ç”¨â€œteacher-forcingâ€è¿›è¡Œè®­ç»ƒï¼Œç±»ä¼¼äºTransformerç”¨äºæœºå™¨ç¿»è¯‘çš„è®­ç»ƒæ–¹å¼ã€‚è¿™æ„å‘³ç€åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå°†`future_values`å‘å³ç§»åŠ¨ä¸€ä¸ªä½ç½®ä½œä¸ºè§£ç å™¨çš„è¾“å…¥ï¼Œå‰é¢åŠ ä¸Š`past_values`çš„æœ€åä¸€ä¸ªå€¼ã€‚åœ¨æ¯ä¸ªæ—¶é—´æ­¥éª¤ï¼Œæ¨¡å‹éœ€è¦é¢„æµ‹ä¸‹ä¸€ä¸ªç›®æ ‡ã€‚å› æ­¤ï¼Œè®­ç»ƒçš„è®¾ç½®ç±»ä¼¼äºç”¨äºè¯­è¨€çš„GPTæ¨¡å‹ï¼Œåªæ˜¯æ²¡æœ‰`decoder_start_token_id`çš„æ¦‚å¿µï¼ˆæˆ‘ä»¬åªä½¿ç”¨ä¸Šä¸‹æ–‡çš„æœ€åä¸€ä¸ªå€¼ä½œä¸ºè§£ç å™¨çš„åˆå§‹è¾“å…¥ï¼‰ã€‚

+   åœ¨æ¨æ–­æ—¶ï¼Œæˆ‘ä»¬å°†`past_values`çš„æœ€ç»ˆå€¼ä½œä¸ºè¾“å…¥ä¼ é€’ç»™è§£ç å™¨ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä»æ¨¡å‹ä¸­è¿›è¡Œé‡‡æ ·ï¼Œä»¥åœ¨ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥éª¤è¿›è¡Œé¢„æµ‹ï¼Œç„¶åå°†å…¶é¦ˆé€ç»™è§£ç å™¨ä»¥è¿›è¡Œä¸‹ä¸€ä¸ªé¢„æµ‹ï¼ˆä¹Ÿç§°ä¸ºè‡ªå›å½’ç”Ÿæˆï¼‰ã€‚

## èµ„æº

ä¸€ç³»åˆ—å®˜æ–¹Hugging Faceå’Œç¤¾åŒºï¼ˆç”±ğŸŒè¡¨ç¤ºï¼‰èµ„æºï¼Œå¯å¸®åŠ©æ‚¨å…¥é—¨ã€‚å¦‚æœæ‚¨æœ‰å…´è¶£æäº¤èµ„æºä»¥åŒ…å«åœ¨æ­¤å¤„ï¼Œè¯·éšæ—¶æ‰“å¼€ä¸€ä¸ªPull Requestï¼Œæˆ‘ä»¬å°†è¿›è¡Œå®¡æŸ¥ï¼èµ„æºåº”è¯¥å±•ç¤ºä¸€äº›æ–°å†…å®¹ï¼Œè€Œä¸æ˜¯é‡å¤ç°æœ‰èµ„æºã€‚

+   åœ¨HuggingFaceåšå®¢ä¸­æŸ¥çœ‹æ—¶é—´åºåˆ—Transformeråšæ–‡ï¼š[ä½¿ç”¨ğŸ¤— Transformersè¿›è¡Œæ¦‚ç‡æ—¶é—´åºåˆ—é¢„æµ‹](https://huggingface.co/blog/time-series-transformers)

## TimeSeriesTransformerConfig

### `class transformers.TimeSeriesTransformerConfig`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/time_series_transformer/configuration_time_series_transformer.py#L33)

```py
( prediction_length: Optional = None context_length: Optional = None distribution_output: str = 'student_t' loss: str = 'nll' input_size: int = 1 lags_sequence: List = [1, 2, 3, 4, 5, 6, 7] scaling: Union = 'mean' num_dynamic_real_features: int = 0 num_static_categorical_features: int = 0 num_static_real_features: int = 0 num_time_features: int = 0 cardinality: Optional = None embedding_dimension: Optional = None encoder_ffn_dim: int = 32 decoder_ffn_dim: int = 32 encoder_attention_heads: int = 2 decoder_attention_heads: int = 2 encoder_layers: int = 2 decoder_layers: int = 2 is_encoder_decoder: bool = True activation_function: str = 'gelu' d_model: int = 64 dropout: float = 0.1 encoder_layerdrop: float = 0.1 decoder_layerdrop: float = 0.1 attention_dropout: float = 0.1 activation_dropout: float = 0.1 num_parallel_samples: int = 100 init_std: float = 0.02 use_cache = True **kwargs )
```

å‚æ•°

+   `prediction_length` (`int`) â€” è§£ç å™¨çš„é¢„æµ‹é•¿åº¦ã€‚æ¢å¥è¯è¯´ï¼Œæ¨¡å‹çš„é¢„æµ‹èŒƒå›´ã€‚æ­¤å€¼é€šå¸¸ç”±æ•°æ®é›†å†³å®šï¼Œæˆ‘ä»¬å»ºè®®é€‚å½“è®¾ç½®ã€‚

+   `context_length` (`int`, *å¯é€‰*, é»˜è®¤ä¸º`prediction_length`) â€” ç¼–ç å™¨çš„ä¸Šä¸‹æ–‡é•¿åº¦ã€‚å¦‚æœä¸º`None`ï¼Œä¸Šä¸‹æ–‡é•¿åº¦å°†ä¸`prediction_length`ç›¸åŒã€‚

+   `distribution_output` (`string`, *å¯é€‰*, é»˜è®¤ä¸º`"student_t"`) â€” æ¨¡å‹çš„åˆ†å¸ƒå‘å°„å¤´ã€‚å¯ä»¥æ˜¯`"student_t"`ã€â€œnormalâ€æˆ–â€œnegative_binomialâ€ä¹‹ä¸€ã€‚

+   `loss` (`string`, *å¯é€‰*, é»˜è®¤ä¸º`"nll"`) â€” ä¸`distribution_output`å¤´å¯¹åº”çš„æ¨¡å‹æŸå¤±å‡½æ•°ã€‚å¯¹äºå‚æ•°åˆ†å¸ƒï¼Œå®ƒæ˜¯è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼ˆnllï¼‰- ç›®å‰æ˜¯å”¯ä¸€æ”¯æŒçš„æŸå¤±å‡½æ•°ã€‚

+   `input_size` (`int`, *å¯é€‰*, é»˜è®¤ä¸º1) â€” ç›®æ ‡å˜é‡çš„å¤§å°ï¼Œé»˜è®¤æƒ…å†µä¸‹å¯¹äºå•å˜é‡ç›®æ ‡ä¸º1ã€‚å¯¹äºå¤šå˜é‡ç›®æ ‡ï¼Œå°†å¤§äº1ã€‚

+   `scaling` (`string`æˆ–`bool`, *å¯é€‰*, é»˜è®¤ä¸º`"mean"`) â€” æ˜¯å¦é€šè¿‡`"mean"`ç¼©æ”¾å™¨ã€â€œstdâ€ç¼©æ”¾å™¨æˆ–å¦‚æœä¸º`None`åˆ™ä¸è¿›è¡Œç¼©æ”¾æ¥ç¼©æ”¾è¾“å…¥ç›®æ ‡ã€‚å¦‚æœä¸º`True`ï¼Œåˆ™ç¼©æ”¾å™¨è®¾ç½®ä¸º`"mean"`ã€‚

+   `lags_sequence` (`list[int]`, *å¯é€‰*, é»˜è®¤ä¸º`[1, 2, 3, 4, 5, 6, 7]`) â€” è¾“å…¥æ—¶é—´åºåˆ—çš„æ»åä½œä¸ºåå˜é‡çš„æ»åï¼Œé€šå¸¸ç”±æ•°æ®çš„é¢‘ç‡å†³å®šã€‚é»˜è®¤ä¸º`[1, 2, 3, 4, 5, 6, 7]`ï¼Œä½†æˆ‘ä»¬å»ºè®®æ ¹æ®æ•°æ®é›†é€‚å½“åœ°è¿›è¡Œæ›´æ”¹ã€‚

+   `num_time_features` (`int`, *å¯é€‰*, é»˜è®¤ä¸º0) â€” è¾“å…¥æ—¶é—´åºåˆ—ä¸­çš„æ—¶é—´ç‰¹å¾æ•°é‡ã€‚

+   `num_dynamic_real_features` (`int`, *å¯é€‰*, é»˜è®¤ä¸º0) â€” åŠ¨æ€å®å€¼ç‰¹å¾çš„æ•°é‡ã€‚

+   `num_static_categorical_features` (`int`, *å¯é€‰*, é»˜è®¤ä¸º0) â€” é™æ€åˆ†ç±»ç‰¹å¾çš„æ•°é‡ã€‚

+   `num_static_real_features` (`int`, *å¯é€‰*, é»˜è®¤ä¸º0) â€” é™æ€å®å€¼ç‰¹å¾çš„æ•°é‡ã€‚

+   `cardinality` (`list[int]`, *å¯é€‰*) â€” æ¯ä¸ªé™æ€åˆ†ç±»ç‰¹å¾çš„åŸºæ•°ï¼ˆä¸åŒå€¼çš„æ•°é‡ï¼‰ã€‚åº”è¯¥æ˜¯ä¸€ä¸ªæ•´æ•°åˆ—è¡¨ï¼Œé•¿åº¦ä¸`num_static_categorical_features`ç›¸åŒã€‚å¦‚æœ`num_static_categorical_features`å¤§äº0ï¼Œåˆ™ä¸èƒ½ä¸º`None`ã€‚

+   `embedding_dimension` (`list[int]`, *å¯é€‰*) â€” æ¯ä¸ªé™æ€åˆ†ç±»ç‰¹å¾çš„åµŒå…¥ç»´åº¦ã€‚åº”è¯¥æ˜¯ä¸€ä¸ªæ•´æ•°åˆ—è¡¨ï¼Œé•¿åº¦ä¸`num_static_categorical_features`ç›¸åŒã€‚å¦‚æœ`num_static_categorical_features`å¤§äº0ï¼Œåˆ™ä¸èƒ½ä¸º`None`ã€‚

+   `d_model` (`int`, *å¯é€‰*, é»˜è®¤ä¸º64) â€” Transformerå±‚çš„ç»´åº¦ã€‚

+   `encoder_layers` (`int`, *å¯é€‰*, é»˜è®¤ä¸º2) â€” ç¼–ç å™¨å±‚æ•°ã€‚

+   `decoder_layers` (`int`, *å¯é€‰*, é»˜è®¤ä¸º2) â€” è§£ç å™¨å±‚æ•°ã€‚

+   `encoder_attention_heads` (`int`, *å¯é€‰*, é»˜è®¤ä¸º2) â€” Transformerç¼–ç å™¨ä¸­æ¯ä¸ªæ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›å¤´æ•°ã€‚

+   `decoder_attention_heads` (`int`, *optional*, defaults to 2) â€” Transformerè§£ç å™¨ä¸­æ¯ä¸ªæ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›å¤´æ•°ã€‚

+   `encoder_ffn_dim` (`int`, *optional*, defaults to 32) â€” ç¼–ç å™¨ä¸­â€œä¸­é—´â€ï¼ˆé€šå¸¸ç§°ä¸ºå‰é¦ˆï¼‰å±‚çš„ç»´åº¦ã€‚

+   `decoder_ffn_dim` (`int`, *optional*, defaults to 32) â€” è§£ç å™¨ä¸­â€œä¸­é—´â€ï¼ˆé€šå¸¸ç§°ä¸ºå‰é¦ˆï¼‰å±‚çš„ç»´åº¦ã€‚

+   `activation_function` (`str` or `function`, *optional*, defaults to `"gelu"`) â€” ç¼–ç å™¨å’Œè§£ç å™¨ä¸­çš„éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆå‡½æ•°æˆ–å­—ç¬¦ä¸²ï¼‰ã€‚å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œæ”¯æŒ`"gelu"`å’Œ`"relu"`ã€‚

+   `dropout` (`float`, *optional*, defaults to 0.1) â€” ç¼–ç å™¨å’Œè§£ç å™¨ä¸­æ‰€æœ‰å…¨è¿æ¥å±‚çš„dropoutæ¦‚ç‡ã€‚

+   `encoder_layerdrop` (`float`, *optional*, defaults to 0.1) â€” æ¯ä¸ªç¼–ç å™¨å±‚çš„æ³¨æ„åŠ›å’Œå…¨è¿æ¥å±‚çš„dropoutæ¦‚ç‡ã€‚

+   `decoder_layerdrop` (`float`, *optional*, defaults to 0.1) â€” æ¯ä¸ªè§£ç å™¨å±‚çš„æ³¨æ„åŠ›å’Œå…¨è¿æ¥å±‚çš„dropoutæ¦‚ç‡ã€‚

+   `attention_dropout` (`float`, *optional*, defaults to 0.1) â€” æ³¨æ„åŠ›æ¦‚ç‡çš„dropoutæ¦‚ç‡ã€‚

+   `activation_dropout` (`float`, *optional*, defaults to 0.1) â€” åœ¨å‰é¦ˆç½‘ç»œçš„ä¸¤ä¸ªå±‚ä¹‹é—´ä½¿ç”¨çš„dropoutæ¦‚ç‡ã€‚

+   `num_parallel_samples` (`int`, *optional*, defaults to 100) â€” æ¯ä¸ªæ¨ç†æ—¶é—´æ­¥ç”Ÿæˆçš„å¹¶è¡Œæ ·æœ¬æ•°ã€‚

+   `init_std` (`float`, *optional*, defaults to 0.02) â€” æˆªæ–­æ­£æ€æƒé‡åˆå§‹åŒ–åˆ†å¸ƒçš„æ ‡å‡†å·®ã€‚

+   `use_cache` (`bool`, *optional*, defaults to `True`) â€” æ˜¯å¦ä½¿ç”¨è¿‡å»çš„é”®/å€¼æ³¨æ„åŠ›ï¼ˆå¦‚æœé€‚ç”¨äºæ¨¡å‹ï¼‰ä»¥åŠ é€Ÿè§£ç ã€‚

    ç¤ºä¾‹ â€”

è¿™æ˜¯ç”¨äºå­˜å‚¨[TimeSeriesTransformerModel](/docs/transformers/v4.37.2/en/model_doc/time_series_transformer#transformers.TimeSeriesTransformerModel)é…ç½®çš„é…ç½®ç±»ã€‚æ ¹æ®æŒ‡å®šçš„å‚æ•°å®ä¾‹åŒ–ä¸€ä¸ªæ—¶é—´åºåˆ—Transformeræ¨¡å‹ï¼Œå®šä¹‰æ¨¡å‹æ¶æ„ã€‚ä½¿ç”¨é»˜è®¤å€¼å®ä¾‹åŒ–é…ç½®å°†äº§ç”Ÿç±»ä¼¼äºTime Series Transformer [huggingface/time-series-transformer-tourism-monthly](https://huggingface.co/huggingface/time-series-transformer-tourism-monthly)æ¶æ„çš„é…ç½®ã€‚

ç»§æ‰¿è‡ª[PretrainedConfig](/docs/transformers/v4.37.2/en/main_classes/configuration#transformers.PretrainedConfig)çš„é…ç½®å¯¹è±¡å¯ç”¨äºæ§åˆ¶æ¨¡å‹è¾“å‡ºã€‚é˜…è¯»[PretrainedConfig](/docs/transformers/v4.37.2/en/main_classes/configuration#transformers.PretrainedConfig)çš„æ–‡æ¡£ä»¥è·å–æ›´å¤šä¿¡æ¯ã€‚

```py
>>> from transformers import TimeSeriesTransformerConfig, TimeSeriesTransformerModel

>>> # Initializing a Time Series Transformer configuration with 12 time steps for prediction
>>> configuration = TimeSeriesTransformerConfig(prediction_length=12)

>>> # Randomly initializing a model (with random weights) from the configuration
>>> model = TimeSeriesTransformerModel(configuration)

>>> # Accessing the model configuration
>>> configuration = model.config
```

## TimeSeriesTransformerModel

### `class transformers.TimeSeriesTransformerModel`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/time_series_transformer/modeling_time_series_transformer.py#L1182)

```py
( config: TimeSeriesTransformerConfig )
```

å‚æ•°

+   `config` ([TimeSeriesTransformerConfig](/docs/transformers/v4.37.2/en/model_doc/time_series_transformer#transformers.TimeSeriesTransformerConfig)) â€” å…·æœ‰æ¨¡å‹æ‰€æœ‰å‚æ•°çš„æ¨¡å‹é…ç½®ç±»ã€‚ä½¿ç”¨é…ç½®æ–‡ä»¶åˆå§‹åŒ–ä¸ä¼šåŠ è½½ä¸æ¨¡å‹å…³è”çš„æƒé‡ï¼Œåªä¼šåŠ è½½é…ç½®ã€‚æŸ¥çœ‹[from_pretrained()](/docs/transformers/v4.37.2/en/main_classes/model#transformers.PreTrainedModel.from_pretrained)æ–¹æ³•ä»¥åŠ è½½æ¨¡å‹æƒé‡ã€‚

è£¸çš„æ—¶é—´åºåˆ—Transformeræ¨¡å‹ï¼Œåœ¨é¡¶éƒ¨æ²¡æœ‰ç‰¹å®šçš„å¤´è¾“å‡ºåŸå§‹éšè—çŠ¶æ€ã€‚æ­¤æ¨¡å‹ç»§æ‰¿è‡ª[PreTrainedModel](/docs/transformers/v4.37.2/en/main_classes/model#transformers.PreTrainedModel)ã€‚æŸ¥çœ‹è¶…ç±»æ–‡æ¡£ä»¥äº†è§£åº“ä¸ºæ‰€æœ‰æ¨¡å‹å®ç°çš„é€šç”¨æ–¹æ³•ï¼ˆå¦‚ä¸‹è½½æˆ–ä¿å­˜ã€è°ƒæ•´è¾“å…¥åµŒå…¥ã€ä¿®å‰ªå¤´ç­‰ï¼‰ã€‚

è¿™ä¸ªæ¨¡å‹ä¹Ÿæ˜¯PyTorch [torch.nn.Module](https://pytorch.org/docs/stable/nn.html#torch.nn.Module)å­ç±»ã€‚å°†å…¶ç”¨ä½œå¸¸è§„çš„PyTorchæ¨¡å—ï¼Œå¹¶å‚è€ƒPyTorchæ–‡æ¡£ä»¥è·å–ä¸ä¸€èˆ¬ç”¨æ³•å’Œè¡Œä¸ºç›¸å…³çš„æ‰€æœ‰äº‹é¡¹ã€‚

#### `forward`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/time_series_transformer/modeling_time_series_transformer.py#L1324)

```py
( past_values: Tensor past_time_features: Tensor past_observed_mask: Tensor static_categorical_features: Optional = None static_real_features: Optional = None future_values: Optional = None future_time_features: Optional = None decoder_attention_mask: Optional = None head_mask: Optional = None decoder_head_mask: Optional = None cross_attn_head_mask: Optional = None encoder_outputs: Optional = None past_key_values: Optional = None output_hidden_states: Optional = None output_attentions: Optional = None use_cache: Optional = None return_dict: Optional = None ) â†’ export const metadata = 'undefined';transformers.modeling_outputs.Seq2SeqTSModelOutput or tuple(torch.FloatTensor)
```

å‚æ•°

+   `past_values`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length)`æˆ–`(batch_size, sequence_length, input_size)`çš„`torch.FloatTensor`ï¼‰- æ—¶é—´åºåˆ—çš„è¿‡å»å€¼ï¼Œä½œä¸ºä¸Šä¸‹æ–‡ä»¥é¢„æµ‹æœªæ¥ã€‚è¿™ä¸ªå¼ é‡çš„åºåˆ—å¤§å°å¿…é¡»å¤§äºæ¨¡å‹çš„`context_length`ï¼Œå› ä¸ºæ¨¡å‹å°†ä½¿ç”¨æ›´å¤§çš„å¤§å°æ¥æ„å»ºæ»åç‰¹å¾ï¼Œå³ä»è¿‡å»æ·»åŠ çš„é¢å¤–å€¼ï¼Œä»¥å……å½“â€œé¢å¤–ä¸Šä¸‹æ–‡â€ã€‚

    è¿™é‡Œçš„`sequence_length`ç­‰äº`config.context_length` + `max(config.lags_sequence)`ï¼Œå¦‚æœæ²¡æœ‰é…ç½®`lags_sequence`ï¼Œåˆ™ç­‰äº`config.context_length` + 7ï¼ˆå› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œ`config.lags_sequence`ä¸­æœ€å¤§çš„å›æº¯ç´¢å¼•æ˜¯7ï¼‰ã€‚å±æ€§`_past_length`è¿”å›è¿‡å»çš„å®é™…é•¿åº¦ã€‚

    `past_values` æ˜¯Transformerç¼–ç å™¨çš„è¾“å…¥ï¼ˆå¯é€‰çš„é™„åŠ ç‰¹å¾ï¼Œå¦‚`static_categorical_features`ã€`static_real_features`ã€`past_time_features`å’Œlagsï¼‰ã€‚

    å¯é€‰åœ°ï¼Œç¼ºå¤±å€¼éœ€è¦ç”¨é›¶æ›¿æ¢ï¼Œå¹¶é€šè¿‡`past_observed_mask`æŒ‡ç¤ºã€‚

    å¯¹äºå¤šå˜é‡æ—¶é—´åºåˆ—ï¼Œ`input_size` > 1ç»´æ˜¯å¿…éœ€çš„ï¼Œå¹¶ä¸”å¯¹åº”äºæ¯ä¸ªæ—¶é—´æ­¥ä¸­æ—¶é—´åºåˆ—ä¸­çš„å˜é‡æ•°ã€‚

+   `past_time_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length, num_features)`çš„`torch.FloatTensor`ï¼‰- æ¨¡å‹å†…éƒ¨å°†æ·»åŠ åˆ°`past_values`ä¸­çš„å¿…éœ€æ—¶é—´ç‰¹å¾ã€‚è¿™äº›å¯èƒ½æ˜¯åƒâ€œå¹´ä»½çš„æœˆä»½â€ã€â€œæœˆä»½çš„æ—¥æœŸâ€ç­‰ç¼–ç ä¸ºå‘é‡ï¼ˆä¾‹å¦‚å‚…ç«‹å¶ç‰¹å¾ï¼‰çš„ä¸œè¥¿ã€‚è¿™äº›ä¹Ÿå¯ä»¥æ˜¯æ‰€è°“çš„â€œå¹´é¾„â€ç‰¹å¾ï¼ŒåŸºæœ¬ä¸Šå¸®åŠ©æ¨¡å‹çŸ¥é“æ—¶é—´åºåˆ—å¤„äºâ€œç”Ÿæ´»ä¸­çš„å“ªä¸ªæ—¶åˆ»â€ã€‚å¹´é¾„ç‰¹å¾å¯¹äºè¿œå¤„çš„è¿‡å»æ—¶é—´æ­¥å…·æœ‰è¾ƒå°çš„å€¼ï¼Œå¹¶ä¸”éšç€æˆ‘ä»¬æ¥è¿‘å½“å‰æ—¶é—´æ­¥è€Œå•è°ƒå¢åŠ ã€‚å‡æœŸç‰¹å¾ä¹Ÿæ˜¯æ—¶é—´ç‰¹å¾çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚

    è¿™äº›ç‰¹å¾ä½œä¸ºè¾“å…¥çš„â€œä½ç½®ç¼–ç â€ã€‚å› æ­¤ï¼Œä¸åƒBERTè¿™æ ·çš„æ¨¡å‹ä¸åŒï¼ŒBERTçš„ä½ç½®ç¼–ç æ˜¯ä»å¤´å¼€å§‹å†…éƒ¨ä½œä¸ºæ¨¡å‹çš„å‚æ•°å­¦ä¹ çš„ï¼Œæ—¶é—´åºåˆ—Transformeréœ€è¦æä¾›é¢å¤–çš„æ—¶é—´ç‰¹å¾ã€‚æ—¶é—´åºåˆ—Transformerä»…ä¸º`static_categorical_features`å­¦ä¹ é¢å¤–çš„åµŒå…¥ã€‚

    é¢å¤–çš„åŠ¨æ€å®æ•°åå˜é‡å¯ä»¥è¿æ¥åˆ°è¿™ä¸ªå¼ é‡ä¸­ï¼Œä½†è¿™äº›ç‰¹å¾å¿…é¡»åœ¨é¢„æµ‹æ—¶å·²çŸ¥ã€‚

    è¿™é‡Œçš„`num_features`ç­‰äº`config.num_time_features`+`config.num_dynamic_real_features`ã€‚

+   `past_observed_mask`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length)`æˆ–`(batch_size, sequence_length, input_size)`çš„`torch.BoolTensor`ï¼Œ*å¯é€‰*ï¼‰- ç”¨äºæŒ‡ç¤ºå“ªäº›`past_values`æ˜¯è§‚å¯Ÿåˆ°çš„ï¼Œå“ªäº›æ˜¯ç¼ºå¤±çš„å¸ƒå°”æ©ç ã€‚æ©ç å€¼é€‰æ‹©åœ¨`[0, 1]`ä¸­ï¼š

    +   å¯¹äº`observed`çš„å€¼ä¸º1ï¼Œ

    +   å¯¹äº`missing`çš„å€¼ï¼ˆå³ç”¨é›¶æ›¿æ¢çš„NaNå€¼ï¼‰ï¼Œä¸º0ã€‚

+   `static_categorical_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, number of static categorical features)`çš„`torch.LongTensor`ï¼Œ*å¯é€‰*ï¼‰- æ¨¡å‹å°†å­¦ä¹ ä¸€ä¸ªåµŒå…¥ï¼Œå°†å…¶æ·»åŠ åˆ°æ—¶é—´åºåˆ—å€¼ä¸­çš„å¯é€‰é™æ€åˆ†ç±»ç‰¹å¾ã€‚

    é™æ€åˆ†ç±»ç‰¹å¾æ˜¯æ‰€æœ‰æ—¶é—´æ­¥é•¿ä¸Šå…·æœ‰ç›¸åŒå€¼çš„ç‰¹å¾ï¼ˆéšæ—¶é—´ä¿æŒä¸å˜ï¼‰ã€‚

    é™æ€åˆ†ç±»ç‰¹å¾çš„å…¸å‹ç¤ºä¾‹æ˜¯æ—¶é—´åºåˆ—IDã€‚

+   `static_real_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, number of static real features)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰- æ¨¡å‹å°†æ·»åŠ åˆ°æ—¶é—´åºåˆ—å€¼ä¸­çš„å¯é€‰é™æ€å®æ•°ç‰¹å¾ã€‚

    é™æ€å®æ•°ç‰¹å¾æ˜¯æ‰€æœ‰æ—¶é—´æ­¥é•¿ä¸Šå…·æœ‰ç›¸åŒå€¼çš„ç‰¹å¾ï¼ˆéšæ—¶é—´ä¿æŒä¸å˜ï¼‰ã€‚

    é™æ€å®é™…ç‰¹å¾çš„å…¸å‹ç¤ºä¾‹æ˜¯ä¿ƒé”€ä¿¡æ¯ã€‚

+   `future_values`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, prediction_length)`æˆ–`(batch_size, prediction_length, input_size)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰â€” æ—¶é—´åºåˆ—çš„æœªæ¥å€¼ï¼Œç”¨ä½œæ¨¡å‹çš„æ ‡ç­¾ã€‚`future_values`æ˜¯Transformeråœ¨è®­ç»ƒæœŸé—´éœ€è¦å­¦ä¹ è¾“å‡ºçš„å†…å®¹ï¼Œç»™å®š`past_values`ã€‚

    è¿™é‡Œçš„åºåˆ—é•¿åº¦ç­‰äº`prediction_length`ã€‚

    æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ¼”ç¤ºç¬”è®°æœ¬å’Œä»£ç ç‰‡æ®µã€‚

    åœ¨è®­ç»ƒæœŸé—´ï¼Œä»»ä½•ç¼ºå¤±å€¼éƒ½éœ€è¦ç”¨é›¶æ›¿æ¢ï¼Œå¹¶é€šè¿‡`future_observed_mask`æŒ‡ç¤ºã€‚

    å¯¹äºå¤šå˜é‡æ—¶é—´åºåˆ—ï¼Œéœ€è¦`input_size` > 1ç»´ï¼Œå¹¶ä¸”å¯¹åº”äºæ—¶é—´åºåˆ—ä¸­æ¯ä¸ªæ—¶é—´æ­¥çš„å˜é‡æ•°é‡ã€‚

+   `future_time_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, prediction_length, num_features)`çš„`torch.FloatTensor`ï¼‰â€” é¢„æµ‹çª—å£æ‰€éœ€çš„æ—¶é—´ç‰¹å¾ï¼Œæ¨¡å‹å†…éƒ¨å°†è¿™äº›ç‰¹å¾æ·»åŠ åˆ°`future_values`ä¸­ã€‚è¿™äº›ç‰¹å¾å¯ä»¥æ˜¯è¯¸å¦‚â€œå¹´ä»½æœˆä»½â€ã€â€œæ¯æœˆæ—¥æœŸâ€ç­‰çš„å‘é‡ç¼–ç ï¼ˆä¾‹å¦‚å‚…ç«‹å¶ç‰¹å¾ï¼‰ã€‚è¿™äº›ä¹Ÿå¯ä»¥æ˜¯æ‰€è°“çš„â€œå¹´é¾„â€ç‰¹å¾ï¼ŒåŸºæœ¬ä¸Šå¸®åŠ©æ¨¡å‹äº†è§£æ—¶é—´åºåˆ—å¤„äºâ€œç”Ÿå‘½å‘¨æœŸçš„å“ªä¸ªé˜¶æ®µâ€ã€‚å¹´é¾„ç‰¹å¾å¯¹äºé¥è¿œçš„è¿‡å»æ—¶é—´æ­¥å…·æœ‰è¾ƒå°çš„å€¼ï¼Œå¹¶ä¸”éšç€æˆ‘ä»¬æ¥è¿‘å½“å‰æ—¶é—´æ­¥ï¼Œå€¼ä¼šå•è°ƒå¢åŠ ã€‚å‡æœŸç‰¹å¾ä¹Ÿæ˜¯æ—¶é—´ç‰¹å¾çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚

    è¿™äº›ç‰¹å¾ä½œä¸ºè¾“å…¥çš„â€œä½ç½®ç¼–ç â€ã€‚ä¸BERTç­‰æ¨¡å‹ä¸åŒï¼ŒBERTçš„ä½ç½®ç¼–ç æ˜¯ä»å¤´å¼€å§‹å†…éƒ¨ä½œä¸ºæ¨¡å‹çš„å‚æ•°å­¦ä¹ çš„ï¼Œæ—¶é—´åºåˆ—Transformeréœ€è¦æä¾›é¢å¤–çš„æ—¶é—´ç‰¹å¾ã€‚æ—¶é—´åºåˆ—Transformerä»…ä¸º`static_categorical_features`å­¦ä¹ é¢å¤–çš„åµŒå…¥ã€‚

    å¯ä»¥å°†é¢å¤–çš„åŠ¨æ€å®é™…åå˜é‡è¿æ¥åˆ°æ­¤å¼ é‡ä¸­ï¼Œä½†å¿…é¡»åœ¨é¢„æµ‹æ—¶äº†è§£è¿™äº›ç‰¹å¾ã€‚

    è¿™é‡Œçš„`num_features`ç­‰äº`config.num_time_features`+`config.num_dynamic_real_features`ã€‚

+   `future_observed_mask`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length)`æˆ–`(batch_size, sequence_length, input_size)`çš„`torch.BoolTensor`ï¼Œ*å¯é€‰*ï¼‰â€” å¸ƒå°”è’™ç‰ˆï¼ŒæŒ‡ç¤ºå“ªäº›`future_values`è¢«è§‚å¯Ÿåˆ°ï¼Œå“ªäº›æ˜¯ç¼ºå¤±çš„ã€‚è’™ç‰ˆå€¼é€‰åœ¨`[0, 1]`èŒƒå›´å†…ï¼š

    +   1è¡¨ç¤ºå€¼è¢«è§‚å¯Ÿåˆ°ï¼Œ

    +   å¯¹äºå€¼ä¸º`missing`ï¼ˆå³è¢«é›¶æ›¿æ¢çš„NaNï¼‰çš„æƒ…å†µã€‚

    æ­¤è’™ç‰ˆç”¨äºè¿‡æ»¤æœ€ç»ˆæŸå¤±è®¡ç®—ä¸­çš„ç¼ºå¤±å€¼ã€‚

+   `attention_mask`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length)`çš„`torch.Tensor`ï¼Œ*å¯é€‰*ï¼‰â€” ç”¨äºé¿å…åœ¨æŸäº›æ ‡è®°ç´¢å¼•ä¸Šæ‰§è¡Œæ³¨æ„åŠ›çš„è’™ç‰ˆã€‚è’™ç‰ˆå€¼é€‰åœ¨`[0, 1]`èŒƒå›´å†…ï¼š

    +   1è¡¨ç¤ºæœªè¢«è’™ç‰ˆçš„æ ‡è®°ï¼Œ

    +   0è¡¨ç¤ºè¢«è’™ç‰ˆçš„æ ‡è®°ã€‚

    [ä»€ä¹ˆæ˜¯æ³¨æ„åŠ›è’™ç‰ˆï¼Ÿ](../glossary#attention-mask)

+   `decoder_attention_mask`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, target_sequence_length)`çš„`torch.LongTensor`ï¼Œ*å¯é€‰*ï¼‰â€” ç”¨äºé¿å…åœ¨æŸäº›æ ‡è®°ç´¢å¼•ä¸Šæ‰§è¡Œæ³¨æ„åŠ›çš„è’™ç‰ˆã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†ä½¿ç”¨å› æœè’™ç‰ˆï¼Œä»¥ç¡®ä¿æ¨¡å‹åªèƒ½æŸ¥çœ‹ä»¥å‰çš„è¾“å…¥ä»¥é¢„æµ‹æœªæ¥ã€‚

+   `head_mask`ï¼ˆå½¢çŠ¶ä¸º`(encoder_layers, encoder_attention_heads)`çš„`torch.Tensor`ï¼Œ*å¯é€‰*ï¼‰â€” ç”¨äºä½¿ç¼–ç å™¨ä¸­æ³¨æ„åŠ›æ¨¡å—çš„ç‰¹å®šå¤´éƒ¨å¤±æ•ˆçš„è’™ç‰ˆã€‚è’™ç‰ˆå€¼é€‰åœ¨`[0, 1]`èŒƒå›´å†…ï¼š

    +   1è¡¨ç¤ºå¤´éƒ¨æœªè¢«è’™ç‰ˆï¼Œ

    +   0è¡¨ç¤ºå¤´éƒ¨è¢«è’™ç‰ˆã€‚

+   `decoder_head_mask`ï¼ˆå½¢çŠ¶ä¸º`(decoder_layers, decoder_attention_heads)`çš„`torch.Tensor`ï¼Œ*å¯é€‰*ï¼‰â€” ç”¨äºä½¿è§£ç å™¨ä¸­æ³¨æ„åŠ›æ¨¡å—çš„ç‰¹å®šå¤´éƒ¨å¤±æ•ˆçš„è’™ç‰ˆã€‚è’™ç‰ˆå€¼é€‰åœ¨`[0, 1]`èŒƒå›´å†…ï¼š

    +   1è¡¨ç¤ºå¤´éƒ¨æœªè¢«è’™ç‰ˆï¼Œ

    +   0è¡¨ç¤ºå¤´éƒ¨è¢«è’™ç‰ˆã€‚

+   `cross_attn_head_mask`ï¼ˆå½¢çŠ¶ä¸º`(decoder_layers, decoder_attention_heads)`çš„`torch.Tensor`ï¼Œ*å¯é€‰*ï¼‰â€” ç”¨äºä½¿äº¤å‰æ³¨æ„åŠ›æ¨¡å—çš„ç‰¹å®šå¤´éƒ¨å¤±æ•ˆçš„è’™ç‰ˆã€‚è’™ç‰ˆå€¼é€‰åœ¨`[0, 1]`èŒƒå›´å†…ï¼š

    +   1è¡¨ç¤ºå¤´éƒ¨æœªè¢«è’™ç‰ˆï¼Œ

    +   0è¡¨ç¤ºå¤´éƒ¨è¢«è’™ç‰ˆã€‚

+   `encoder_outputs` (`tuple(tuple(torch.FloatTensor)`, *optional*) â€” å…ƒç»„åŒ…å«`last_hidden_state`ã€`hidden_states`ï¼ˆ*å¯é€‰*ï¼‰å’Œ`attentions`ï¼ˆ*å¯é€‰*ï¼‰`last_hidden_state`çš„å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`ï¼ˆ*å¯é€‰*ï¼‰ï¼Œæ˜¯ç¼–ç å™¨æœ€åä¸€å±‚è¾“å‡ºçš„éšè—çŠ¶æ€åºåˆ—ã€‚ç”¨äºè§£ç å™¨çš„äº¤å‰æ³¨æ„åŠ›ã€‚

+   `past_key_values` (`tuple(tuple(torch.FloatTensor))`, *optional*, å½“ä¼ é€’`use_cache=True`æˆ–`config.use_cache=True`æ—¶è¿”å›ï¼Œç±»å‹ä¸º`tuple(tuple(torch.FloatTensor))`ï¼Œé•¿åº¦ä¸º`config.n_layers`ï¼Œæ¯ä¸ªå…ƒç»„åŒ…å«2ä¸ªå½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, embed_size_per_head)`çš„å¼ é‡å’Œ2ä¸ªé¢å¤–çš„å½¢çŠ¶ä¸º`(batch_size, num_heads, encoder_sequence_length, embed_size_per_head)`çš„å¼ é‡ã€‚

    åŒ…å«é¢„å…ˆè®¡ç®—çš„éšè—çŠ¶æ€ï¼ˆè‡ªæ³¨æ„åŠ›å—å’Œäº¤å‰æ³¨æ„åŠ›å—ä¸­çš„é”®å’Œå€¼ï¼‰ï¼Œå¯ç”¨äºåŠ é€Ÿé¡ºåºè§£ç ï¼ˆå‚è§`past_key_values`è¾“å…¥ï¼‰ã€‚

    å¦‚æœä½¿ç”¨`past_key_values`ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©ä»…è¾“å…¥å½¢çŠ¶ä¸º`(batch_size, 1)`çš„æœ€åä¸€ä¸ª`decoder_input_ids`ï¼ˆè¿™äº›æ²¡æœ‰å°†å…¶è¿‡å»çš„é”®å€¼çŠ¶æ€æä¾›ç»™æ­¤æ¨¡å‹ï¼‰è€Œä¸æ˜¯å½¢çŠ¶ä¸º`(batch_size, sequence_length)`çš„æ‰€æœ‰`decoder_input_ids`ã€‚

+   `inputs_embeds` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`ï¼Œ*å¯é€‰*ï¼‰ â€” å¯é€‰åœ°ï¼Œæ‚¨å¯ä»¥ç›´æ¥ä¼ é€’åµŒå…¥è¡¨ç¤ºè€Œä¸æ˜¯ä¼ é€’`input_ids`ã€‚å¦‚æœæ‚¨æƒ³è¦æ›´å¤šæ§åˆ¶å¦‚ä½•å°†`input_ids`ç´¢å¼•è½¬æ¢ä¸ºç›¸å…³å‘é‡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ¨¡å‹çš„å†…éƒ¨åµŒå…¥æŸ¥æ‰¾çŸ©é˜µï¼Œåˆ™è¿™å¾ˆæœ‰ç”¨ã€‚

+   `use_cache` (`bool`, *optional*) â€” å¦‚æœè®¾ç½®ä¸º`True`ï¼Œåˆ™è¿”å›`past_key_values`é”®å€¼çŠ¶æ€ï¼Œå¯ç”¨äºåŠ é€Ÿè§£ç ï¼ˆå‚è§`past_key_values`ï¼‰ã€‚

+   `output_attentions` (`bool`, *optional*) â€” æ˜¯å¦è¿”å›æ‰€æœ‰æ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›å¼ é‡ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§è¿”å›å¼ é‡ä¸­çš„`attentions`ã€‚

+   `output_hidden_states` (`bool`, *optional*) â€” æ˜¯å¦è¿”å›æ‰€æœ‰å±‚çš„éšè—çŠ¶æ€ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§è¿”å›å¼ é‡ä¸­çš„`hidden_states`ã€‚

+   `return_dict` (`bool`, *optional*) â€” æ˜¯å¦è¿”å›[ModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.utils.ModelOutput)è€Œä¸æ˜¯æ™®é€šå…ƒç»„ã€‚

è¿”å›

[transformers.modeling_outputs.Seq2SeqTSModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.modeling_outputs.Seq2SeqTSModelOutput) æˆ– `tuple(torch.FloatTensor)`

[transformers.modeling_outputs.Seq2SeqTSModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.modeling_outputs.Seq2SeqTSModelOutput) æˆ–ä¸€ä¸ª`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœä¼ é€’`return_dict=False`æˆ–`config.return_dict=False`æ—¶ï¼‰åŒ…å«æ ¹æ®é…ç½®ï¼ˆ[TimeSeriesTransformerConfig](/docs/transformers/v4.37.2/en/model_doc/time_series_transformer#transformers.TimeSeriesTransformerConfig)ï¼‰å’Œè¾“å…¥çš„ä¸åŒå…ƒç´ ã€‚

+   `last_hidden_state` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`) â€” æ¨¡å‹è§£ç å™¨æœ€åä¸€å±‚çš„éšè—çŠ¶æ€åºåˆ—ã€‚

    å¦‚æœä»…ä½¿ç”¨`past_key_values`ï¼Œåˆ™è¾“å‡ºå½¢çŠ¶ä¸º`(batch_size, 1, hidden_size)`çš„åºåˆ—çš„æœ€åä¸€ä¸ªéšè—çŠ¶æ€ã€‚

+   `past_key_values` (`tuple(tuple(torch.FloatTensor))`, *optional*, returned when `use_cache=True` is passed or when `config.use_cache=True`) â€” å½“ä¼ é€’`use_cache=True`æˆ–`config.use_cache=True`æ—¶è¿”å›ï¼Œç±»å‹ä¸º`tuple(tuple(torch.FloatTensor))`ï¼Œé•¿åº¦ä¸º`config.n_layers`ï¼Œæ¯ä¸ªå…ƒç»„åŒ…å«2ä¸ªå½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, embed_size_per_head)`çš„å¼ é‡å’Œ2ä¸ªé¢å¤–çš„å½¢çŠ¶ä¸º`(batch_size, num_heads, encoder_sequence_length, embed_size_per_head)`çš„å¼ é‡ã€‚

    åŒ…å«é¢„å…ˆè®¡ç®—çš„éšè—çŠ¶æ€ï¼ˆè‡ªæ³¨æ„åŠ›å—å’Œäº¤å‰æ³¨æ„åŠ›å—ä¸­çš„é”®å’Œå€¼ï¼‰ï¼Œå¯ç”¨äºåŠ é€Ÿé¡ºåºè§£ç ï¼ˆå‚è§`past_key_values`è¾“å…¥ï¼‰ã€‚

+   `decoder_hidden_states` (`tuple(torch.FloatTensor)`, *å¯é€‰*, å½“ä¼ é€’`output_hidden_states=True`æˆ–`config.output_hidden_states=True`æ—¶è¿”å›) â€” å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœæ¨¡å‹æœ‰åµŒå…¥å±‚ï¼Œåˆ™ä¸ºåµŒå…¥å±‚çš„è¾“å‡º+æ¯å±‚çš„è¾“å‡ºï¼‰ã€‚

    è§£ç å™¨åœ¨æ¯ä¸€å±‚è¾“å‡ºçš„éšè—çŠ¶æ€åŠ ä¸Šå¯é€‰çš„åˆå§‹åµŒå…¥è¾“å‡ºã€‚

+   `decoder_attentions` (`tuple(torch.FloatTensor)`, *å¯é€‰*, å½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›) â€” å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    è§£ç å™¨çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—è‡ªæ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `cross_attentions` (`tuple(torch.FloatTensor)`, *å¯é€‰*, å½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›) â€” å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    è§£ç å™¨çš„äº¤å‰æ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—äº¤å‰æ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `encoder_last_hidden_state` (`å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`, *å¯é€‰*) â€” æ¨¡å‹ç¼–ç å™¨æœ€åä¸€å±‚çš„éšè—çŠ¶æ€åºåˆ—ã€‚

+   `encoder_hidden_states` (`tuple(torch.FloatTensor)`, *å¯é€‰*, å½“ä¼ é€’`output_hidden_states=True`æˆ–`config.output_hidden_states=True`æ—¶è¿”å›) â€” å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœæ¨¡å‹æœ‰åµŒå…¥å±‚ï¼Œåˆ™ä¸ºåµŒå…¥å±‚çš„è¾“å‡º+æ¯å±‚çš„è¾“å‡ºï¼‰ã€‚

    ç¼–ç å™¨åœ¨æ¯ä¸€å±‚è¾“å‡ºçš„éšè—çŠ¶æ€åŠ ä¸Šå¯é€‰çš„åˆå§‹åµŒå…¥è¾“å‡ºã€‚

+   `encoder_attentions` (`tuple(torch.FloatTensor)`, *å¯é€‰*, å½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›) â€” å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    ç¼–ç å™¨çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—è‡ªæ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `loc` (`å½¢çŠ¶ä¸º`(batch_size,)`æˆ–`(batch_size, input_size)`çš„`torch.FloatTensor`, *å¯é€‰*) â€” æ¯ä¸ªæ—¶é—´åºåˆ—çš„ä¸Šä¸‹æ–‡çª—å£çš„åç§»å€¼ï¼Œç”¨äºç»™æ¨¡å‹è¾“å…¥ç›¸åŒæ•°é‡çº§çš„è¾“å…¥ï¼Œç„¶åç”¨äºå°†å…¶åç§»å›åŸå§‹æ•°é‡çº§ã€‚

+   `scale` (`å½¢çŠ¶ä¸º`(batch_size,)`æˆ–`(batch_size, input_size)`çš„`torch.FloatTensor`, *å¯é€‰*) â€” æ¯ä¸ªæ—¶é—´åºåˆ—çš„ä¸Šä¸‹æ–‡çª—å£çš„ç¼©æ”¾å€¼ï¼Œç”¨äºç»™æ¨¡å‹è¾“å…¥ç›¸åŒæ•°é‡çº§çš„è¾“å…¥ï¼Œç„¶åç”¨äºå°†å…¶é‡æ–°ç¼©æ”¾å›åŸå§‹æ•°é‡çº§ã€‚

+   `static_features` (`å½¢çŠ¶ä¸º`(batch_size, feature size)`çš„`torch.FloatTensor`, *å¯é€‰*) â€” æ¯ä¸ªæ—¶é—´åºåˆ—çš„é™æ€ç‰¹å¾ï¼Œåœ¨æ¨æ–­æ—¶å¤åˆ¶åˆ°åå˜é‡ä¸­ã€‚

[TimeSeriesTransformerModel](/docs/transformers/v4.37.2/en/model_doc/time_series_transformer#transformers.TimeSeriesTransformerModel)çš„å‰å‘æ–¹æ³•ï¼Œè¦†ç›–äº†`__call__`ç‰¹æ®Šæ–¹æ³•ã€‚

è™½ç„¶å‰å‘ä¼ é€’çš„æ­¥éª¤éœ€è¦åœ¨æ­¤å‡½æ•°å†…å®šä¹‰ï¼Œä½†åº”è¯¥åœ¨æ­¤ä¹‹åè°ƒç”¨`Module`å®ä¾‹ï¼Œè€Œä¸æ˜¯è¿™ä¸ªï¼Œå› ä¸ºå‰è€…è´Ÿè´£è¿è¡Œé¢„å¤„ç†å’Œåå¤„ç†æ­¥éª¤ï¼Œè€Œåè€…ä¼šé»˜é»˜åœ°å¿½ç•¥å®ƒä»¬ã€‚

ç¤ºä¾‹ï¼š

```py
>>> from huggingface_hub import hf_hub_download
>>> import torch
>>> from transformers import TimeSeriesTransformerModel

>>> file = hf_hub_download(
...     repo_id="hf-internal-testing/tourism-monthly-batch", filename="train-batch.pt", repo_type="dataset"
... )
>>> batch = torch.load(file)

>>> model = TimeSeriesTransformerModel.from_pretrained("huggingface/time-series-transformer-tourism-monthly")

>>> # during training, one provides both past and future values
>>> # as well as possible additional features
>>> outputs = model(
...     past_values=batch["past_values"],
...     past_time_features=batch["past_time_features"],
...     past_observed_mask=batch["past_observed_mask"],
...     static_categorical_features=batch["static_categorical_features"],
...     static_real_features=batch["static_real_features"],
...     future_values=batch["future_values"],
...     future_time_features=batch["future_time_features"],
... )

>>> last_hidden_state = outputs.last_hidden_state
```

## TimeSeriesTransformerForPrediction

`class transformers.TimeSeriesTransformerForPrediction`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/time_series_transformer/modeling_time_series_transformer.py#L1443)

```py
( config: TimeSeriesTransformerConfig )
```

å‚æ•°

+   `config` ([TimeSeriesTransformerConfig](/docs/transformers/v4.37.2/en/model_doc/time_series_transformer#transformers.TimeSeriesTransformerConfig)) â€” æ¨¡å‹çš„é…ç½®ç±»ï¼ŒåŒ…å«æ‰€æœ‰æ¨¡å‹çš„å‚æ•°ã€‚ä½¿ç”¨é…ç½®æ–‡ä»¶åˆå§‹åŒ–ä¸ä¼šåŠ è½½ä¸æ¨¡å‹ç›¸å…³çš„æƒé‡ï¼Œåªä¼šåŠ è½½é…ç½®ã€‚æŸ¥çœ‹[from_pretrained()](/docs/transformers/v4.37.2/en/main_classes/model#transformers.PreTrainedModel.from_pretrained)æ–¹æ³•ä»¥åŠ è½½æ¨¡å‹æƒé‡ã€‚

å¸¦æœ‰æ—¶é—´åºåˆ—é¢„æµ‹åˆ†å¸ƒå¤´çš„æ—¶é—´åºåˆ—å˜æ¢å™¨æ¨¡å‹ã€‚æ­¤æ¨¡å‹ç»§æ‰¿è‡ª[PreTrainedModel](/docs/transformers/v4.37.2/en/main_classes/model#transformers.PreTrainedModel)ã€‚æŸ¥çœ‹è¶…ç±»æ–‡æ¡£ä»¥è·å–åº“ä¸ºæ‰€æœ‰æ¨¡å‹å®ç°çš„é€šç”¨æ–¹æ³•ï¼ˆå¦‚ä¸‹è½½æˆ–ä¿å­˜ã€è°ƒæ•´è¾“å…¥åµŒå…¥ã€ä¿®å‰ªå¤´ç­‰ï¼‰ã€‚

è¿™ä¸ªæ¨¡å‹ä¹Ÿæ˜¯ä¸€ä¸ªPyTorch [torch.nn.Module](https://pytorch.org/docs/stable/nn.html#torch.nn.Module)å­ç±»ã€‚å°†å…¶ç”¨ä½œå¸¸è§„çš„PyTorchæ¨¡å—ï¼Œå¹¶å‚è€ƒPyTorchæ–‡æ¡£ä»¥è·å–ä¸ä¸€èˆ¬ç”¨æ³•å’Œè¡Œä¸ºç›¸å…³çš„æ‰€æœ‰å†…å®¹ã€‚

#### `forward`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/time_series_transformer/modeling_time_series_transformer.py#L1487)

```py
( past_values: Tensor past_time_features: Tensor past_observed_mask: Tensor static_categorical_features: Optional = None static_real_features: Optional = None future_values: Optional = None future_time_features: Optional = None future_observed_mask: Optional = None decoder_attention_mask: Optional = None head_mask: Optional = None decoder_head_mask: Optional = None cross_attn_head_mask: Optional = None encoder_outputs: Optional = None past_key_values: Optional = None output_hidden_states: Optional = None output_attentions: Optional = None use_cache: Optional = None return_dict: Optional = None ) â†’ export const metadata = 'undefined';transformers.modeling_outputs.Seq2SeqTSModelOutput or tuple(torch.FloatTensor)
```

å‚æ•°

+   `past_values`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length)`æˆ–`(batch_size, sequence_length, input_size)`çš„`torch.FloatTensor`ï¼‰ â€” æ—¶é—´åºåˆ—çš„è¿‡å»å€¼ï¼Œç”¨ä½œä¸Šä¸‹æ–‡ä»¥é¢„æµ‹æœªæ¥ã€‚æ­¤å¼ é‡çš„åºåˆ—å¤§å°å¿…é¡»å¤§äºæ¨¡å‹çš„`context_length`ï¼Œå› ä¸ºæ¨¡å‹å°†ä½¿ç”¨è¾ƒå¤§çš„å¤§å°æ¥æ„å»ºæ»åç‰¹å¾ï¼Œå³ä»è¿‡å»æ·»åŠ çš„é¢å¤–å€¼ï¼Œä»¥å……å½“â€œé¢å¤–ä¸Šä¸‹æ–‡â€ã€‚

    è¿™é‡Œçš„`sequence_length`ç­‰äº`config.context_length` + `max(config.lags_sequence)`ï¼Œå¦‚æœæ²¡æœ‰é…ç½®`lags_sequence`ï¼Œåˆ™ç­‰äº`config.context_length` + 7ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œ`config.lags_sequence`ä¸­æœ€å¤§çš„å›é¡¾ç´¢å¼•ä¸º7ï¼‰ã€‚å±æ€§`_past_length`è¿”å›è¿‡å»çš„å®é™…é•¿åº¦ã€‚

    `past_values`æ˜¯Transformerç¼–ç å™¨ä½œä¸ºè¾“å…¥çš„å†…å®¹ï¼ˆå¸¦æœ‰å¯é€‰çš„é™„åŠ ç‰¹å¾ï¼Œå¦‚`static_categorical_features`ã€`static_real_features`ã€`past_time_features`å’Œæ»åï¼‰ã€‚

    å¯é€‰åœ°ï¼Œç¼ºå¤±å€¼éœ€è¦ç”¨é›¶æ›¿æ¢ï¼Œå¹¶é€šè¿‡`past_observed_mask`æŒ‡ç¤ºã€‚

    å¯¹äºå¤šå˜é‡æ—¶é—´åºåˆ—ï¼Œéœ€è¦`input_size` > 1ç»´ï¼Œå¹¶å¯¹åº”äºæ¯ä¸ªæ—¶é—´æ­¥é•¿ä¸­æ—¶é—´åºåˆ—çš„å˜é‡æ•°é‡ã€‚

+   `past_time_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length, num_features)`çš„`torch.FloatTensor`ï¼‰ â€” å¿…éœ€çš„æ—¶é—´ç‰¹å¾ï¼Œæ¨¡å‹å†…éƒ¨å°†å…¶æ·»åŠ åˆ°`past_values`ä¸­ã€‚è¿™äº›å¯èƒ½æ˜¯è¯¸å¦‚â€œå¹´ä»½ä¸­çš„æœˆä»½â€ã€â€œæœˆä»½ä¸­çš„æ—¥æœŸâ€ç­‰ç¼–ç ä¸ºå‘é‡ï¼ˆä¾‹å¦‚ä½œä¸ºå‚…ç«‹å¶ç‰¹å¾ï¼‰çš„å†…å®¹ã€‚è¿™ä¹Ÿå¯ä»¥æ˜¯æ‰€è°“çš„â€œå¹´é¾„â€ç‰¹å¾ï¼ŒåŸºæœ¬ä¸Šå¸®åŠ©æ¨¡å‹çŸ¥é“æ—¶é—´åºåˆ—å¤„äºâ€œç”Ÿæ´»ä¸­çš„å“ªä¸ªé˜¶æ®µâ€ã€‚å¹´é¾„ç‰¹å¾å¯¹äºè¿œå¤„çš„è¿‡å»æ—¶é—´æ­¥å…·æœ‰è¾ƒå°çš„å€¼ï¼Œå¹¶ä¸”éšç€æˆ‘ä»¬æ¥è¿‘å½“å‰æ—¶é—´æ­¥è€Œå•è°ƒå¢åŠ ã€‚å‡æœŸç‰¹å¾ä¹Ÿæ˜¯æ—¶é—´ç‰¹å¾çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚

    è¿™äº›ç‰¹å¾ç”¨ä½œè¾“å…¥çš„â€œä½ç½®ç¼–ç â€ã€‚ä¸åƒBERTè¿™æ ·çš„æ¨¡å‹ç›¸åï¼ŒBERTä¸­çš„ä½ç½®ç¼–ç æ˜¯ä»å¤´å¼€å§‹å†…éƒ¨ä½œä¸ºæ¨¡å‹çš„å‚æ•°å­¦ä¹ çš„ï¼Œè€Œæ—¶é—´åºåˆ—å˜æ¢å™¨éœ€è¦æä¾›é¢å¤–çš„æ—¶é—´ç‰¹å¾ã€‚æ—¶é—´åºåˆ—å˜æ¢å™¨ä»…ä¸º`static_categorical_features`å­¦ä¹ é¢å¤–çš„åµŒå…¥ã€‚

    å¯ä»¥å°†é¢å¤–çš„åŠ¨æ€å®é™…åå˜é‡è¿æ¥åˆ°æ­¤å¼ é‡ä¸­ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯è¿™äº›ç‰¹å¾å¿…é¡»åœ¨é¢„æµ‹æ—¶å·²çŸ¥ã€‚

    è¿™é‡Œçš„`num_features`ç­‰äº`config.num_time_features`+`config.num_dynamic_real_features`ã€‚

+   `past_observed_mask` (`torch.BoolTensor` of shape `(batch_size, sequence_length)` or `(batch_size, sequence_length, input_size)`, *optional*) â€” å¸ƒå°”æ©ç ï¼ŒæŒ‡ç¤ºå“ªäº›`past_values`æ˜¯è§‚å¯Ÿåˆ°çš„ï¼Œå“ªäº›æ˜¯ç¼ºå¤±çš„ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºâ€œè§‚å¯Ÿåˆ°â€çš„å€¼ï¼Œ

    +   0è¡¨ç¤ºâ€œç¼ºå¤±â€çš„å€¼ï¼ˆå³è¢«é›¶æ›¿æ¢çš„NaNï¼‰ã€‚

+   `static_categorical_features` (`torch.LongTensor` of shape `(batch_size, number of static categorical features)`, *optional*) â€” æ¨¡å‹å°†å­¦ä¹ åµŒå…¥è¿™äº›é™æ€åˆ†ç±»ç‰¹å¾ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°æ—¶é—´åºåˆ—çš„å€¼ä¸­ã€‚

    é™æ€åˆ†ç±»ç‰¹å¾æ˜¯æ‰€æœ‰æ—¶é—´æ­¥çš„å€¼éƒ½ç›¸åŒçš„ç‰¹å¾ï¼ˆéšæ—¶é—´ä¿æŒé™æ€ï¼‰ã€‚

    é™æ€åˆ†ç±»ç‰¹å¾çš„å…¸å‹ç¤ºä¾‹æ˜¯æ—¶é—´åºåˆ—IDã€‚

+   `static_real_features` (`torch.FloatTensor` of shape `(batch_size, number of static real features)`, *optional*) â€” å¯é€‰çš„é™æ€å®æ•°ç‰¹å¾ï¼Œæ¨¡å‹å°†æŠŠè¿™äº›ç‰¹å¾æ·»åŠ åˆ°æ—¶é—´åºåˆ—çš„å€¼ä¸­ã€‚

    é™æ€å®æ•°ç‰¹å¾æ˜¯æ‰€æœ‰æ—¶é—´æ­¥çš„å€¼éƒ½ç›¸åŒçš„ç‰¹å¾ï¼ˆéšæ—¶é—´ä¿æŒé™æ€ï¼‰ã€‚

    é™æ€å®æ•°ç‰¹å¾çš„å…¸å‹ç¤ºä¾‹æ˜¯ä¿ƒé”€ä¿¡æ¯ã€‚

+   `future_values` (`torch.FloatTensor` of shape `(batch_size, prediction_length)` or `(batch_size, prediction_length, input_size)`, *optional*) â€” æ—¶é—´åºåˆ—çš„æœªæ¥å€¼ï¼Œä½œä¸ºæ¨¡å‹çš„æ ‡ç­¾ã€‚`future_values`æ˜¯Transformeråœ¨è®­ç»ƒæœŸé—´éœ€è¦å­¦ä¹ è¾“å‡ºçš„å†…å®¹ï¼Œç»™å®š`past_values`ã€‚

    è¿™é‡Œçš„åºåˆ—é•¿åº¦ç­‰äº`prediction_length`ã€‚

    æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ¼”ç¤ºç¬”è®°æœ¬å’Œä»£ç ç‰‡æ®µã€‚

    åœ¨è®­ç»ƒæœŸé—´ï¼Œä»»ä½•ç¼ºå¤±å€¼éƒ½éœ€è¦ç”¨é›¶æ›¿æ¢ï¼Œå¹¶é€šè¿‡`future_observed_mask`æŒ‡ç¤ºã€‚

    å¯¹äºå¤šå˜é‡æ—¶é—´åºåˆ—ï¼Œéœ€è¦`input_size` > 1ç»´ï¼Œå¹¶ä¸”å¯¹åº”äºæ—¶é—´åºåˆ—æ¯ä¸ªæ—¶é—´æ­¥ä¸­çš„å˜é‡æ•°é‡ã€‚

+   `future_time_features` (`torch.FloatTensor` of shape `(batch_size, prediction_length, num_features)`) â€” æ¨¡å‹åœ¨å†…éƒ¨å°†è¿™äº›ç‰¹å¾æ·»åŠ åˆ°`future_values`ä¸­ï¼Œè¿™äº›ç‰¹å¾æ˜¯é¢„æµ‹çª—å£æ‰€éœ€çš„æ—¶é—´ç‰¹å¾ã€‚è¿™äº›ç‰¹å¾å¯ä»¥æ˜¯è¯¸å¦‚â€œå¹´ä»½ä¸­çš„æœˆä»½â€ã€â€œæœˆä»½ä¸­çš„æ—¥æœŸâ€ç­‰ç¼–ç ä¸ºå‘é‡ï¼ˆä¾‹å¦‚å‚…ç«‹å¶ç‰¹å¾ï¼‰çš„å†…å®¹ã€‚è¿™äº›ä¹Ÿå¯ä»¥æ˜¯æ‰€è°“çš„â€œå¹´é¾„â€ç‰¹å¾ï¼ŒåŸºæœ¬ä¸Šå¸®åŠ©æ¨¡å‹äº†è§£æ—¶é—´åºåˆ—å¤„äºâ€œç”Ÿå‘½ä¸­çš„å“ªä¸ªé˜¶æ®µâ€ã€‚å¹´é¾„ç‰¹å¾å¯¹äºè¿œå¤„çš„è¿‡å»æ—¶é—´æ­¥å…·æœ‰è¾ƒå°çš„å€¼ï¼Œå¹¶ä¸”éšç€æˆ‘ä»¬æ¥è¿‘å½“å‰æ—¶é—´æ­¥è€Œå•è°ƒå¢åŠ ã€‚å‡æœŸç‰¹å¾ä¹Ÿæ˜¯æ—¶é—´ç‰¹å¾çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚

    è¿™äº›ç‰¹å¾ä½œä¸ºè¾“å…¥çš„â€œä½ç½®ç¼–ç â€ã€‚ä¸BERTç­‰æ¨¡å‹ä¸åŒï¼ŒBERTçš„ä½ç½®ç¼–ç æ˜¯ä»å¤´å¼€å§‹å†…éƒ¨ä½œä¸ºæ¨¡å‹çš„å‚æ•°å­¦ä¹ çš„ï¼Œæ—¶é—´åºåˆ—Transformeréœ€è¦æä¾›é¢å¤–çš„æ—¶é—´ç‰¹å¾ã€‚æ—¶é—´åºåˆ—Transformerä»…ä¸º`static_categorical_features`å­¦ä¹ é¢å¤–çš„åµŒå…¥ã€‚

    å¯ä»¥å°†é¢å¤–çš„åŠ¨æ€å®æ•°åå˜é‡è¿æ¥åˆ°è¿™ä¸ªå¼ é‡ä¸­ï¼Œä½†éœ€è¦æ³¨æ„è¿™äº›ç‰¹å¾å¿…é¡»åœ¨é¢„æµ‹æ—¶å·²çŸ¥ã€‚

    è¿™é‡Œçš„`num_features`ç­‰äº`config.num_time_features`+`config.num_dynamic_real_features`ã€‚

+   `future_observed_mask` (`torch.BoolTensor` of shape `(batch_size, sequence_length)` or `(batch_size, sequence_length, input_size)`, *optional*) â€” å¸ƒå°”æ©ç ï¼ŒæŒ‡ç¤ºå“ªäº›`future_values`æ˜¯è§‚å¯Ÿåˆ°çš„ï¼Œå“ªäº›æ˜¯ç¼ºå¤±çš„ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºâ€œè§‚å¯Ÿåˆ°â€çš„å€¼ï¼Œ

    +   0è¡¨ç¤ºâ€œç¼ºå¤±â€çš„å€¼ï¼ˆå³è¢«é›¶æ›¿æ¢çš„NaNï¼‰ã€‚

    è¿™ä¸ªæ©ç ç”¨äºåœ¨æœ€ç»ˆæŸå¤±è®¡ç®—ä¸­è¿‡æ»¤ç¼ºå¤±å€¼ã€‚

+   `attention_mask` (`torch.Tensor` of shape `(batch_size, sequence_length)`, *optional*) â€” ç”¨äºé¿å…åœ¨æŸäº›æ ‡è®°ç´¢å¼•ä¸Šæ‰§è¡Œæ³¨æ„åŠ›çš„æ©ç ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºâ€œæœªè¢«æ©ç â€çš„æ ‡è®°ï¼Œ

    +   0è¡¨ç¤ºâ€œè¢«æ©ç â€çš„æ ‡è®°ã€‚

    [ä»€ä¹ˆæ˜¯æ³¨æ„åŠ›æ©ç ï¼Ÿ](../glossary#attention-mask)

+   `decoder_attention_mask` (`torch.LongTensor` of shape `(batch_size, target_sequence_length)`, *optional*) â€” ç”¨äºé¿å…åœ¨æŸäº›æ ‡è®°ç´¢å¼•ä¸Šæ‰§è¡Œæ³¨æ„åŠ›çš„æ©ç ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†ä½¿ç”¨å› æœæ©ç ï¼Œä»¥ç¡®ä¿æ¨¡å‹åªèƒ½æŸ¥çœ‹ä»¥å‰çš„è¾“å…¥ä»¥é¢„æµ‹æœªæ¥ã€‚

+   `head_mask` (`torch.Tensor` of shape `(encoder_layers, encoder_attention_heads)`, *optional*) â€” ç”¨äºå°†ç¼–ç å™¨ä¸­æ³¨æ„åŠ›æ¨¡å—ä¸­é€‰æ‹©çš„å¤´éƒ¨ç½®é›¶çš„æ©ç ã€‚æ©ç å€¼åœ¨ `[0, 1]` ä¸­é€‰æ‹©ï¼š

    +   1 è¡¨ç¤ºå¤´éƒ¨æœªè¢«å±è”½ï¼Œ

    +   0 è¡¨ç¤ºå¤´éƒ¨è¢«å±è”½ã€‚

+   `decoder_head_mask` (`torch.Tensor` of shape `(decoder_layers, decoder_attention_heads)`, *optional*) â€” ç”¨äºå°†è§£ç å™¨ä¸­æ³¨æ„åŠ›æ¨¡å—ä¸­é€‰æ‹©çš„å¤´éƒ¨ç½®é›¶çš„æ©ç ã€‚æ©ç å€¼åœ¨ `[0, 1]` ä¸­é€‰æ‹©ï¼š

    +   1 è¡¨ç¤ºå¤´éƒ¨æœªè¢«å±è”½ï¼Œ

    +   0 è¡¨ç¤ºå¤´éƒ¨è¢«å±è”½ã€‚

+   `cross_attn_head_mask` (`torch.Tensor` of shape `(decoder_layers, decoder_attention_heads)`, *optional*) â€” ç”¨äºå°†äº¤å‰æ³¨æ„åŠ›æ¨¡å—ä¸­é€‰æ‹©çš„å¤´éƒ¨ç½®é›¶çš„æ©ç ã€‚æ©ç å€¼åœ¨ `[0, 1]` ä¸­é€‰æ‹©ï¼š

    +   1 è¡¨ç¤ºå¤´éƒ¨æœªè¢«å±è”½ï¼Œ

    +   0 è¡¨ç¤ºå¤´éƒ¨è¢«å±è”½ã€‚

+   `encoder_outputs` (`tuple(tuple(torch.FloatTensor)`, *optional*) â€” å…ƒç»„åŒ…æ‹¬ `last_hidden_state`ã€`hidden_states`ï¼ˆ*å¯é€‰*ï¼‰å’Œ `attentions`ï¼ˆ*å¯é€‰*ï¼‰`last_hidden_state` çš„å½¢çŠ¶ä¸º `(batch_size, sequence_length, hidden_size)`ï¼ˆ*å¯é€‰*ï¼‰æ˜¯ç¼–ç å™¨æœ€åä¸€å±‚çš„è¾“å‡ºçš„éšè—çŠ¶æ€åºåˆ—ã€‚ç”¨äºè§£ç å™¨çš„äº¤å‰æ³¨æ„åŠ›ã€‚

+   `past_key_values` (`tuple(tuple(torch.FloatTensor))`, *optional*, å½“ä¼ é€’ `use_cache=True` æˆ– `config.use_cache=True` æ—¶è¿”å›) â€” é•¿åº¦ä¸º `config.n_layers` çš„ `tuple(torch.FloatTensor)` å…ƒç»„ï¼Œæ¯ä¸ªå…ƒç»„åŒ…å« 2 ä¸ªå½¢çŠ¶ä¸º `(batch_size, num_heads, sequence_length, embed_size_per_head)` çš„å¼ é‡å’Œ 2 ä¸ªé¢å¤–çš„å½¢çŠ¶ä¸º `(batch_size, num_heads, encoder_sequence_length, embed_size_per_head)` çš„å¼ é‡ã€‚

    åŒ…å«é¢„å…ˆè®¡ç®—çš„éšè—çŠ¶æ€ï¼ˆè‡ªæ³¨æ„åŠ›å—å’Œäº¤å‰æ³¨æ„åŠ›å—ä¸­çš„é”®å’Œå€¼ï¼‰ï¼Œå¯ç”¨äºåŠ é€Ÿé¡ºåºè§£ç ï¼ˆå‚è§ `past_key_values` è¾“å…¥ï¼‰ã€‚

    å¦‚æœä½¿ç”¨äº† `past_key_values`ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©ä»…è¾“å…¥æœ€åçš„ `decoder_input_ids`ï¼ˆè¿™äº›æ²¡æœ‰å°†å…¶è¿‡å»çš„é”®å€¼çŠ¶æ€æä¾›ç»™æ­¤æ¨¡å‹ï¼‰çš„å½¢çŠ¶ä¸º `(batch_size, 1)`ï¼Œè€Œä¸æ˜¯æ‰€æœ‰å½¢çŠ¶ä¸º `(batch_size, sequence_length)` çš„ `decoder_input_ids`ã€‚

+   `inputs_embeds` (`torch.FloatTensor` of shape `(batch_size, sequence_length, hidden_size)`, *optional*) â€” å¯é€‰åœ°ï¼Œå¯ä»¥ç›´æ¥ä¼ é€’åµŒå…¥è¡¨ç¤ºï¼Œè€Œä¸æ˜¯ä¼ é€’ `input_ids`ã€‚å¦‚æœæ‚¨æƒ³è¦æ›´å¤šæ§åˆ¶æƒï¼Œä»¥ä¾¿å°† `input_ids` ç´¢å¼•è½¬æ¢ä¸ºç›¸å…³å‘é‡ï¼Œè€Œä¸æ˜¯æ¨¡å‹çš„å†…éƒ¨åµŒå…¥æŸ¥æ‰¾çŸ©é˜µï¼Œåˆ™è¿™å¾ˆæœ‰ç”¨ã€‚

+   `use_cache` (`bool`, *optional*) â€” å¦‚æœè®¾ç½®ä¸º `True`ï¼Œåˆ™è¿”å› `past_key_values` é”®å€¼çŠ¶æ€ï¼Œå¯ç”¨äºåŠ é€Ÿè§£ç ï¼ˆå‚è§ `past_key_values`ï¼‰ã€‚

+   `output_attentions` (`bool`, *optional*) â€” æ˜¯å¦è¿”å›æ‰€æœ‰æ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›å¼ é‡ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…è¿”å›å¼ é‡ä¸­çš„ `attentions`ã€‚

+   `output_hidden_states` (`bool`, *optional*) â€” æ˜¯å¦è¿”å›æ‰€æœ‰å±‚çš„éšè—çŠ¶æ€ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…è¿”å›å¼ é‡ä¸­çš„ `hidden_states`ã€‚

+   `return_dict` (`bool`, *optional*) â€” æ˜¯å¦è¿”å› [ModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.utils.ModelOutput) è€Œä¸æ˜¯æ™®é€šå…ƒç»„ã€‚

è¿”å›

[transformers.modeling_outputs.Seq2SeqTSModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.modeling_outputs.Seq2SeqTSModelOutput) æˆ– `tuple(torch.FloatTensor)`

ä¸€ä¸ª[transformers.modeling_outputs.Seq2SeqTSModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.modeling_outputs.Seq2SeqTSModelOutput)æˆ–ä¸€ä¸ª`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœä¼ é€’äº†`return_dict=False`æˆ–`config.return_dict=False`æ—¶ï¼‰åŒ…å«æ ¹æ®é…ç½®ï¼ˆ[TimeSeriesTransformerConfig](/docs/transformers/v4.37.2/en/model_doc/time_series_transformer#transformers.TimeSeriesTransformerConfig)ï¼‰å’Œè¾“å…¥çš„ä¸åŒå…ƒç´ ã€‚

+   `last_hidden_state`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`ï¼‰- æ¨¡å‹è§£ç å™¨æœ€åä¸€å±‚çš„éšè—çŠ¶æ€åºåˆ—ã€‚

    å¦‚æœä½¿ç”¨`past_key_values`ï¼Œåˆ™åªè¾“å‡ºå½¢çŠ¶ä¸º`(batch_size, 1, hidden_size)`çš„åºåˆ—çš„æœ€åä¸€ä¸ªéšè—çŠ¶æ€ã€‚

+   `past_key_values`ï¼ˆ`tuple(tuple(torch.FloatTensor))`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`use_cache=True`æˆ–`config.use_cache=True`æ—¶è¿”å›ï¼‰- é•¿åº¦ä¸º`config.n_layers`çš„`tuple(torch.FloatTensor)`å…ƒç»„ï¼Œæ¯ä¸ªå…ƒç»„æœ‰2ä¸ªå½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, embed_size_per_head)`çš„å¼ é‡å’Œ2ä¸ªé¢å¤–çš„å½¢çŠ¶ä¸º`(batch_size, num_heads, encoder_sequence_length, embed_size_per_head)`çš„å¼ é‡ã€‚

    åŒ…å«é¢„å…ˆè®¡ç®—çš„éšè—çŠ¶æ€ï¼ˆè‡ªæ³¨æ„åŠ›å—å’Œäº¤å‰æ³¨æ„åŠ›å—ä¸­çš„é”®å’Œå€¼ï¼‰ï¼Œå¯ç”¨äºåŠ é€Ÿé¡ºåºè§£ç ï¼ˆå‚è§`past_key_values`è¾“å…¥ï¼‰ã€‚

+   `decoder_hidden_states`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_hidden_states=True`æˆ–`config.output_hidden_states=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœæ¨¡å‹æœ‰åµŒå…¥å±‚ï¼Œåˆ™ä¸ºåµŒå…¥è¾“å‡ºçš„ä¸€ä¸ªåŠ ä¸Šæ¯ä¸€å±‚çš„è¾“å‡ºï¼‰ã€‚

    è§£ç å™¨åœ¨æ¯ä¸€å±‚çš„è¾“å‡ºçš„éšè—çŠ¶æ€ä»¥åŠå¯é€‰çš„åˆå§‹åµŒå…¥è¾“å‡ºã€‚

+   `decoder_attentions`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    è§£ç å™¨çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—è‡ªæ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `cross_attentions`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    è§£ç å™¨çš„äº¤å‰æ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—äº¤å‰æ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `encoder_last_hidden_state`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰- æ¨¡å‹ç¼–ç å™¨æœ€åä¸€å±‚çš„éšè—çŠ¶æ€åºåˆ—ã€‚

+   `encoder_hidden_states`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_hidden_states=True`æˆ–`config.output_hidden_states=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœæ¨¡å‹æœ‰åµŒå…¥å±‚ï¼Œåˆ™ä¸ºåµŒå…¥è¾“å‡ºçš„ä¸€ä¸ªåŠ ä¸Šæ¯ä¸€å±‚çš„è¾“å‡ºï¼‰ã€‚

    ç¼–ç å™¨åœ¨æ¯ä¸€å±‚çš„è¾“å‡ºçš„éšè—çŠ¶æ€ä»¥åŠå¯é€‰çš„åˆå§‹åµŒå…¥è¾“å‡ºã€‚

+   `encoder_attentions`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    ç¼–ç å™¨çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—è‡ªæ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `loc`ï¼ˆå½¢çŠ¶ä¸º`(batch_size,)`æˆ–`(batch_size, input_size)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰- ç”¨äºå°†æ¯ä¸ªæ—¶é—´åºåˆ—çš„ä¸Šä¸‹æ–‡çª—å£çš„å€¼ç§»ä½ï¼Œä»¥ä¾¿ä¸ºæ¨¡å‹æä¾›ç›¸åŒæ•°é‡çº§çš„è¾“å…¥ï¼Œç„¶åç”¨äºå°†å…¶ç§»ä½å›åŸå§‹æ•°é‡çº§ã€‚

+   `scale`ï¼ˆå½¢çŠ¶ä¸º`(batch_size,)`æˆ–`(batch_size, input_size)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰- ç”¨äºå°†æ¯ä¸ªæ—¶é—´åºåˆ—çš„ä¸Šä¸‹æ–‡çª—å£çš„ç¼©æ”¾å€¼ç§»ä½ï¼Œä»¥ä¾¿ä¸ºæ¨¡å‹æä¾›ç›¸åŒæ•°é‡çº§çš„è¾“å…¥ï¼Œç„¶åç”¨äºé‡æ–°ç¼©æ”¾å›åŸå§‹æ•°é‡çº§ã€‚

+   `static_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, feature size)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰- æ¯ä¸ªæ—¶é—´åºåˆ—åœ¨æ‰¹å¤„ç†ä¸­çš„é™æ€ç‰¹å¾ï¼Œåœ¨æ¨æ–­æ—¶å°†å¤åˆ¶åˆ°åå˜é‡ä¸­ã€‚

[TimeSeriesTransformerForPrediction](/docs/transformers/v4.37.2/en/model_doc/time_series_transformer#transformers.TimeSeriesTransformerForPrediction)çš„å‰å‘æ–¹æ³•é‡å†™äº†`__call__`ç‰¹æ®Šæ–¹æ³•ã€‚

è™½ç„¶å‰å‘ä¼ é€’çš„æ­¥éª¤éœ€è¦åœ¨æ­¤å‡½æ•°ä¸­å®šä¹‰ï¼Œä½†åº”è¯¥åœ¨æ­¤ä¹‹åè°ƒç”¨`Module`å®ä¾‹ï¼Œè€Œä¸æ˜¯åœ¨æ­¤ä¹‹åè°ƒç”¨ï¼Œå› ä¸ºå‰è€…ä¼šè´Ÿè´£è¿è¡Œé¢„å¤„ç†å’Œåå¤„ç†æ­¥éª¤ï¼Œè€Œåè€…ä¼šé»˜é»˜åœ°å¿½ç•¥å®ƒä»¬ã€‚

ç¤ºä¾‹ï¼š

```py
>>> from huggingface_hub import hf_hub_download
>>> import torch
>>> from transformers import TimeSeriesTransformerForPrediction

>>> file = hf_hub_download(
...     repo_id="hf-internal-testing/tourism-monthly-batch", filename="train-batch.pt", repo_type="dataset"
... )
>>> batch = torch.load(file)

>>> model = TimeSeriesTransformerForPrediction.from_pretrained(
...     "huggingface/time-series-transformer-tourism-monthly"
... )

>>> # during training, one provides both past and future values
>>> # as well as possible additional features
>>> outputs = model(
...     past_values=batch["past_values"],
...     past_time_features=batch["past_time_features"],
...     past_observed_mask=batch["past_observed_mask"],
...     static_categorical_features=batch["static_categorical_features"],
...     static_real_features=batch["static_real_features"],
...     future_values=batch["future_values"],
...     future_time_features=batch["future_time_features"],
... )

>>> loss = outputs.loss
>>> loss.backward()

>>> # during inference, one only provides past values
>>> # as well as possible additional features
>>> # the model autoregressively generates future values
>>> outputs = model.generate(
...     past_values=batch["past_values"],
...     past_time_features=batch["past_time_features"],
...     past_observed_mask=batch["past_observed_mask"],
...     static_categorical_features=batch["static_categorical_features"],
...     static_real_features=batch["static_real_features"],
...     future_time_features=batch["future_time_features"],
... )

>>> mean_prediction = outputs.sequences.mean(dim=1)
```
