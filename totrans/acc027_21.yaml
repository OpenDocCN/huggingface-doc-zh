- en: Tracking
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è·Ÿè¸ª
- en: 'Original text: [https://huggingface.co/docs/accelerate/usage_guides/tracking](https://huggingface.co/docs/accelerate/usage_guides/tracking)'
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸå§‹æ–‡æœ¬ï¼š[https://huggingface.co/docs/accelerate/usage_guides/tracking](https://huggingface.co/docs/accelerate/usage_guides/tracking)
- en: null
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: There are a large number of experiment tracking APIâ€™s available, however getting
    them all to work with in a multi-processing environment can oftentimes be complex.
    ğŸ¤— Accelerate provides a general tracking API that can be used to log useful items
    during your script through `Accelerator.log()`
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰å¤§é‡çš„å®éªŒè·Ÿè¸ªAPIå¯ç”¨ï¼Œä½†æ˜¯è®©å®ƒä»¬åœ¨å¤šè¿›ç¨‹ç¯å¢ƒä¸­ä¸€èµ·å·¥ä½œé€šå¸¸ä¼šå¾ˆå¤æ‚ã€‚ğŸ¤— Accelerateæä¾›äº†ä¸€ä¸ªé€šç”¨çš„è·Ÿè¸ªAPIï¼Œå¯ä»¥ç”¨æ¥é€šè¿‡`Accelerator.log()`è®°å½•è„šæœ¬ä¸­çš„æœ‰ç”¨é¡¹ç›®
- en: Integrated Trackers
  id: totrans-4
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é›†æˆè·Ÿè¸ªå™¨
- en: 'Currently `Accelerate` supports seven trackers out-of-the-box:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: ç›®å‰`Accelerate`æ”¯æŒä¸ƒç§å¼€ç®±å³ç”¨çš„è·Ÿè¸ªå™¨ï¼š
- en: TensorBoard
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: TensorBoard
- en: WandB
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: WandB
- en: CometML
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CometML
- en: Aim
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç›®æ ‡
- en: MLFlow
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MLFlow
- en: ClearML
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ClearML
- en: DVCLive
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: DVCLive
- en: 'To use any of them, pass in the selected type(s) to the `log_with` parameter
    in `Accelerate`:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: è¦ä½¿ç”¨å…¶ä¸­ä»»ä½•ä¸€ä¸ªï¼Œåªéœ€å°†æ‰€é€‰ç±»å‹ä¼ é€’ç»™`Accelerate`ä¸­çš„`log_with`å‚æ•°ï¼š
- en: '[PRE0]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'At the start of your experiment `Accelerator.init_trackers()` should be used
    to setup your project, and potentially add any experiment hyperparameters to be
    logged:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å®éªŒå¼€å§‹æ—¶ï¼Œåº”è¯¥ä½¿ç”¨`Accelerator.init_trackers()`æ¥è®¾ç½®æ‚¨çš„é¡¹ç›®ï¼Œå¹¶å¯èƒ½æ·»åŠ è¦è®°å½•çš„ä»»ä½•å®éªŒè¶…å‚æ•°ï¼š
- en: '[PRE1]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: When you are ready to log any data, `Accelerator.log()` should be used. A `step`
    can also be passed in to correlate the data with a particular step in the training
    loop.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æ‚¨å‡†å¤‡è®°å½•ä»»ä½•æ•°æ®æ—¶ï¼Œåº”è¯¥ä½¿ç”¨`Accelerator.log()`ã€‚è¿˜å¯ä»¥ä¼ é€’ä¸€ä¸ª`step`æ¥å°†æ•°æ®ä¸è®­ç»ƒå¾ªç¯ä¸­çš„ç‰¹å®šæ­¥éª¤ç›¸å…³è”ã€‚
- en: '[PRE2]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Once youâ€™ve finished training, make sure to run `Accelerator.end_training()`
    so that all the trackers can run their finish functionalities if they have any.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦è®­ç»ƒå®Œæˆï¼Œè¯·ç¡®ä¿è¿è¡Œ`Accelerator.end_training()`ï¼Œä»¥ä¾¿æ‰€æœ‰è·Ÿè¸ªå™¨å¯ä»¥è¿è¡Œå…¶å®ŒæˆåŠŸèƒ½ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚
- en: '[PRE3]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'A full example is below:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼š
- en: '[PRE4]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'If a tracker requires a directory to save data to, such as `TensorBoard`, then
    pass the directory path to `project_dir`. The `project_dir` parameter is useful
    when there are other configurations to be combined with in the [ProjectConfiguration](/docs/accelerate/v0.27.2/en/package_reference/utilities#accelerate.utils.ProjectConfiguration)
    data class. For example, you can save the TensorBoard data to `project_dir` and
    everything else can be logged in the `logging_dir` parameter of [`~utils.ProjectConfiguration`:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœè·Ÿè¸ªå™¨éœ€è¦ä¸€ä¸ªç›®å½•æ¥ä¿å­˜æ•°æ®ï¼Œæ¯”å¦‚`TensorBoard`ï¼Œé‚£ä¹ˆå°†ç›®å½•è·¯å¾„ä¼ é€’ç»™`project_dir`ã€‚å½“æœ‰å…¶ä»–é…ç½®éœ€è¦ä¸[ProjectConfiguration](/docs/accelerate/v0.27.2/en/package_reference/utilities#accelerate.utils.ProjectConfiguration)æ•°æ®ç±»ç»“åˆæ—¶ï¼Œ`project_dir`å‚æ•°éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å°†TensorBoardæ•°æ®ä¿å­˜åˆ°`project_dir`ï¼Œå…¶ä»–æ‰€æœ‰å†…å®¹å¯ä»¥è®°å½•åœ¨[`~utils.ProjectConfiguration`]çš„`logging_dir`å‚æ•°ä¸­ï¼š
- en: '[PRE5]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Implementing Custom Trackers
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å®ç°è‡ªå®šä¹‰è·Ÿè¸ªå™¨
- en: 'To implement a new tracker to be used in `Accelerator`, a new one can be made
    through implementing the `GeneralTracker` class. Every tracker must implement
    three functions and have three properties:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: è¦å®ç°ä¸€ä¸ªæ–°çš„è·Ÿè¸ªå™¨ä»¥åœ¨`Accelerator`ä¸­ä½¿ç”¨ï¼Œå¯ä»¥é€šè¿‡å®ç°`GeneralTracker`ç±»æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„è·Ÿè¸ªå™¨ã€‚æ¯ä¸ªè·Ÿè¸ªå™¨å¿…é¡»å®ç°ä¸‰ä¸ªå‡½æ•°å¹¶å…·æœ‰ä¸‰ä¸ªå±æ€§ï¼š
- en: '`__init__`:'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`__init__`ï¼š'
- en: Should store a `run_name` and initialize the tracker API of the integrated library.
  id: totrans-28
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: åº”è¯¥å­˜å‚¨ä¸€ä¸ª`run_name`å¹¶åˆå§‹åŒ–é›†æˆåº“çš„è·Ÿè¸ªå™¨APIã€‚
- en: If a tracker stores their data locally (such as TensorBoard), a `logging_dir`
    parameter can be added.
  id: totrans-29
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¦‚æœè·Ÿè¸ªå™¨å°†æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼ˆä¾‹å¦‚TensorBoardï¼‰ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ª`logging_dir`å‚æ•°ã€‚
- en: '`store_init_configuration`:'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`store_init_configuration`ï¼š'
- en: Should take in a `values` dictionary and store them as a one-time experiment
    configuration
  id: totrans-31
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: åº”è¯¥æ¥æ”¶ä¸€ä¸ª`values`å­—å…¸å¹¶å°†å…¶å­˜å‚¨ä¸ºä¸€æ¬¡æ€§å®éªŒé…ç½®
- en: '`log`:'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`log`ï¼š'
- en: Should take in a `values` dictionary and a `step`, and should log them to the
    run
  id: totrans-33
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: åº”è¯¥æ¥æ”¶ä¸€ä¸ª`values`å­—å…¸å’Œä¸€ä¸ª`step`ï¼Œå¹¶å°†å®ƒä»¬è®°å½•åˆ°è¿è¡Œä¸­
- en: '`name` (`str`):'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`name`ï¼ˆ`str`ï¼‰:'
- en: A unique string name for the tracker, such as `"wandb"` for the wandb tracker.
  id: totrans-35
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªå”¯ä¸€çš„å­—ç¬¦ä¸²åç§°ï¼Œä¾‹å¦‚`"wandb"`ç”¨äºwandbè·Ÿè¸ªå™¨ã€‚
- en: This will be used for interacting with this tracker specifically
  id: totrans-36
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™å°†ç”¨äºä¸“é—¨ä¸æ­¤è·Ÿè¸ªå™¨äº¤äº’
- en: '`requires_logging_directory` (`bool`):'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`requires_logging_directory`ï¼ˆ`bool`ï¼‰ï¼š'
- en: Whether a `logging_dir` is needed for this particular tracker and if it uses
    one.
  id: totrans-38
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™ä¸ªç‰¹å®šè·Ÿè¸ªå™¨æ˜¯å¦éœ€è¦`logging_dir`ï¼Œä»¥åŠå®ƒæ˜¯å¦ä½¿ç”¨ä¸€ä¸ªã€‚
- en: '`tracker`:'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`tracker`ï¼š'
- en: This should be implemented as a `@property` function
  id: totrans-40
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™åº”è¯¥å®ç°ä¸ºä¸€ä¸ª`@property`å‡½æ•°
- en: Should return the internal tracking mechanism the library uses, such as the
    `run` object for `wandb`.
  id: totrans-41
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: åº”è¯¥è¿”å›åº“ä½¿ç”¨çš„å†…éƒ¨è·Ÿè¸ªæœºåˆ¶ï¼Œä¾‹å¦‚`wandb`çš„`run`å¯¹è±¡ã€‚
- en: Each method should also utilize the [state.PartialState](/docs/accelerate/v0.27.2/en/package_reference/state#accelerate.PartialState)
    class if the logger should only be executed on the main process for instance.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœè®°å½•å™¨åº”è¯¥ä»…åœ¨ä¸»è¿›ç¨‹ä¸Šæ‰§è¡Œï¼Œåˆ™æ¯ä¸ªæ–¹æ³•è¿˜åº”è¯¥åˆ©ç”¨[state.PartialState](/docs/accelerate/v0.27.2/en/package_reference/state#accelerate.PartialState)ç±»ã€‚
- en: 'A brief example can be seen below with an integration with Weights and Biases,
    containing only the relevant information and logging just on the main process:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é¢å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç®€çŸ­çš„ç¤ºä¾‹ï¼Œä¸Weights and Biasesé›†æˆï¼Œä»…åŒ…å«ç›¸å…³ä¿¡æ¯å¹¶ä»…åœ¨ä¸»è¿›ç¨‹ä¸Šè®°å½•ï¼š
- en: '[PRE6]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'When you are ready to build your `Accelerator` object, pass in an **instance**
    of your tracker to `Accelerator.log_with` to have it automatically be used with
    the API:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æ‚¨å‡†å¤‡æ„å»ºæ‚¨çš„`Accelerator`å¯¹è±¡æ—¶ï¼Œè¯·å°†æ‚¨çš„è·Ÿè¸ªå™¨çš„**å®ä¾‹**ä¼ é€’ç»™`Accelerator.log_with`ï¼Œä»¥ä¾¿è‡ªåŠ¨ä¸APIä¸€èµ·ä½¿ç”¨ï¼š
- en: '[PRE7]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'These also can be mixed with existing trackers, including with `"all"`:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™äº›ä¹Ÿå¯ä»¥ä¸ç°æœ‰çš„è·Ÿè¸ªå™¨æ··åˆä½¿ç”¨ï¼ŒåŒ…æ‹¬`"all"`ï¼š
- en: '[PRE8]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Accessing the internal tracker
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®¿é—®å†…éƒ¨è·Ÿè¸ªå™¨
- en: If some custom interactions with a tracker might be wanted directly, you can
    quickly access one using the [Accelerator.get_tracker()](/docs/accelerate/v0.27.2/en/package_reference/accelerator#accelerate.Accelerator.get_tracker)
    method. Just pass in the string corresponding to a trackerâ€™s `.name` attribute
    and it will return that tracker on the main process.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœå¯èƒ½éœ€è¦ä¸è·Ÿè¸ªå™¨ç›´æ¥è¿›è¡Œä¸€äº›è‡ªå®šä¹‰äº¤äº’ï¼Œå¯ä»¥ä½¿ç”¨[Accelerator.get_tracker()](/docs/accelerate/v0.27.2/en/package_reference/accelerator#accelerate.Accelerator.get_tracker)æ–¹æ³•å¿«é€Ÿè®¿é—®ä¸€ä¸ªã€‚åªéœ€ä¼ é€’ä¸è·Ÿè¸ªå™¨çš„`.name`å±æ€§å¯¹åº”çš„å­—ç¬¦ä¸²ï¼Œå®ƒå°†è¿”å›ä¸»è¿›ç¨‹ä¸Šçš„è¯¥è·Ÿè¸ªå™¨ã€‚
- en: 'This example shows doing so with wandb:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨wandbï¼š
- en: '[PRE9]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'From there you can interact with `wandb`â€™s `run` object like normal:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: ä»é‚£é‡Œï¼Œæ‚¨å¯ä»¥åƒå¹³å¸¸ä¸€æ ·ä¸`wandb`çš„`run`å¯¹è±¡äº¤äº’ï¼š
- en: '[PRE10]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Trackers built in Accelerate will automatically execute on the correct process,
    so if a tracker is only meant to be ran on the main process it will do so automatically.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Accelerate ä¸­æ„å»ºçš„è·Ÿè¸ªå™¨å°†è‡ªåŠ¨åœ¨æ­£ç¡®çš„è¿›ç¨‹ä¸Šæ‰§è¡Œï¼Œå› æ­¤ï¼Œå¦‚æœä¸€ä¸ªè·Ÿè¸ªå™¨åªåº”åœ¨ä¸»è¿›ç¨‹ä¸Šè¿è¡Œï¼Œå®ƒå°†è‡ªåŠ¨æ‰§è¡Œã€‚
- en: 'If you want to truly remove Accelerateâ€™s wrapping entirely, you can achieve
    the same outcome with:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ‚¨æƒ³å®Œå…¨åˆ é™¤ Accelerate çš„åŒ…è£…ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ç›¸åŒçš„ç»“æœï¼š
- en: '[PRE11]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: When a wrapper cannot work
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å½“åŒ…è£…å™¨æ— æ³•å·¥ä½œ
- en: 'If a library has an API that does not follow a strict `.log` with an overall
    dictionary such as Neptune.AI, logging can be done manually under an `if accelerator.is_main_process`
    statement:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä¸€ä¸ªåº“çš„ API ä¸éµå¾ªä¸¥æ ¼çš„ `.log` ä¸ Neptune.AI è¿™æ ·çš„æ•´ä½“å­—å…¸ï¼Œæ—¥å¿—è®°å½•å¯ä»¥åœ¨ä¸€ä¸ª `if accelerator.is_main_process`
    è¯­å¥ä¸‹æ‰‹åŠ¨å®Œæˆã€‚
- en: '[PRE12]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
