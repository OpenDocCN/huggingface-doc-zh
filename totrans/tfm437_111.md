# å›è°ƒå‡½æ•°

> åŸå§‹æ–‡æœ¬ï¼š[https://huggingface.co/docs/transformers/v4.37.2/en/main_classes/callback](https://huggingface.co/docs/transformers/v4.37.2/en/main_classes/callback)

å›è°ƒå‡½æ•°æ˜¯å¯ä»¥è‡ªå®šä¹‰PyTorch [Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)è®­ç»ƒå¾ªç¯è¡Œä¸ºçš„å¯¹è±¡ï¼ˆæ­¤åŠŸèƒ½å°šæœªåœ¨TensorFlowä¸­å®ç°ï¼‰ï¼Œå¯ä»¥æ£€æŸ¥è®­ç»ƒå¾ªç¯çŠ¶æ€ï¼ˆç”¨äºè¿›åº¦æŠ¥å‘Šã€åœ¨TensorBoardæˆ–å…¶ä»–MLå¹³å°ä¸Šè®°å½•â€¦ï¼‰å¹¶åšå‡ºå†³ç­–ï¼ˆå¦‚æå‰åœæ­¢ï¼‰ã€‚

å›è°ƒå‡½æ•°æ˜¯â€œåªè¯»â€ä»£ç ç‰‡æ®µï¼Œé™¤äº†å®ƒä»¬è¿”å›çš„[TrainerControl](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerControl)å¯¹è±¡å¤–ï¼Œå®ƒä»¬ä¸èƒ½æ›´æ”¹è®­ç»ƒå¾ªç¯ä¸­çš„ä»»ä½•å†…å®¹ã€‚å¯¹äºéœ€è¦æ›´æ”¹è®­ç»ƒå¾ªç¯çš„è‡ªå®šä¹‰å†…å®¹ï¼Œæ‚¨åº”è¯¥å­ç±»åŒ–[Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)å¹¶è¦†ç›–æ‚¨éœ€è¦çš„æ–¹æ³•ï¼ˆè¯·å‚é˜…[trainer](trainer)ä»¥è·å–ç¤ºä¾‹ï¼‰ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`TrainingArguments.report_to`è®¾ç½®ä¸º`"all"`ï¼Œå› æ­¤[Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)å°†ä½¿ç”¨ä»¥ä¸‹å›è°ƒå‡½æ•°ã€‚

+   [DefaultFlowCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.DefaultFlowCallback)å¤„ç†æ—¥å¿—è®°å½•ã€ä¿å­˜å’Œè¯„ä¼°çš„é»˜è®¤è¡Œä¸ºã€‚

+   ä½¿ç”¨[PrinterCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.PrinterCallback)æˆ–[ProgressCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.ProgressCallback)æ˜¾ç¤ºè¿›åº¦å¹¶æ‰“å°æ—¥å¿—ï¼ˆå¦‚æœé€šè¿‡[TrainingArguments](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.TrainingArguments)åœç”¨tqdmï¼Œåˆ™ä½¿ç”¨ç¬¬ä¸€ä¸ªï¼Œå¦åˆ™ä½¿ç”¨ç¬¬äºŒä¸ªï¼‰ã€‚

+   å¦‚æœtensorboardå¯è®¿é—®ï¼ˆé€šè¿‡PyTorch >= 1.4æˆ–tensorboardXï¼‰ï¼Œåˆ™ä½¿ç”¨[TensorBoardCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.integrations.TensorBoardCallback)ã€‚

+   å¦‚æœå®‰è£…äº†[wandb](https://www.wandb.com/)ï¼Œåˆ™ä½¿ç”¨[WandbCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.integrations.WandbCallback)ã€‚

+   å¦‚æœå®‰è£…äº†[comet_ml](https://www.comet.ml/site/)ï¼Œåˆ™ä½¿ç”¨[CometCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.integrations.CometCallback)ã€‚

+   å¦‚æœå®‰è£…äº†[mlflow](https://www.mlflow.org/)ï¼Œåˆ™ä½¿ç”¨[MLflowCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.integrations.MLflowCallback)ã€‚

+   å¦‚æœå®‰è£…äº†[neptune](https://neptune.ai/)ï¼Œåˆ™ä½¿ç”¨[NeptuneCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.integrations.NeptuneCallback)ã€‚

+   å¦‚æœå®‰è£…äº†[azureml-sdk](https://pypi.org/project/azureml-sdk/)ï¼Œåˆ™ä½¿ç”¨[AzureMLCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.integrations.AzureMLCallback)ã€‚

+   å¦‚æœå®‰è£…äº†[codecarbon](https://pypi.org/project/codecarbon/)ï¼Œåˆ™ä½¿ç”¨[CodeCarbonCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.integrations.CodeCarbonCallback)ã€‚

+   å¦‚æœå®‰è£…äº†[clearml](https://github.com/allegroai/clearml)ï¼Œåˆ™ä½¿ç”¨[ClearMLCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.integrations.ClearMLCallback)ã€‚

+   å¦‚æœå®‰è£…äº†[dagshub](https://dagshub.com/)ï¼Œåˆ™ä½¿ç”¨[DagsHubCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.integrations.DagsHubCallback)ã€‚

+   å¦‚æœå®‰è£…äº†[flyte](https://flyte.org/)ï¼Œåˆ™ä½¿ç”¨[FlyteCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.integrations.FlyteCallback)ã€‚

+   å¦‚æœå®‰è£…äº†[dvclive](https://dvc.org/doc/dvclive)ï¼Œåˆ™ä½¿ç”¨[DVCLiveCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.integrations.DVCLiveCallback)ã€‚

å¦‚æœå®‰è£…äº†æŸä¸ªè½¯ä»¶åŒ…ï¼Œä½†æ‚¨ä¸å¸Œæœ›ä½¿ç”¨ç›¸åº”çš„é›†æˆï¼Œå¯ä»¥å°†`TrainingArguments.report_to`æ›´æ”¹ä¸ºæ‚¨æƒ³è¦ä½¿ç”¨çš„é›†æˆåˆ—è¡¨ï¼ˆä¾‹å¦‚`["azure_ml", "wandb"]`ï¼‰ã€‚

å®ç°å›è°ƒçš„ä¸»è¦ç±»æ˜¯[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ã€‚å®ƒè·å–ç”¨äºå®ä¾‹åŒ–[Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)çš„[TrainingArguments](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.TrainingArguments)ï¼Œå¯ä»¥é€šè¿‡[TrainerState](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerState)è®¿é—®è¯¥Trainerçš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶å¯ä»¥é€šè¿‡[TrainerControl](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerControl)å¯¹è®­ç»ƒå¾ªç¯é‡‡å–ä¸€äº›æ“ä½œã€‚

## å¯ç”¨çš„å›è°ƒ

ä»¥ä¸‹æ˜¯åº“ä¸­å¯ç”¨çš„[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)åˆ—è¡¨ï¼š

### `class transformers.integrations.CometCallback`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L833)

```py
( )
```

ä¸€ä¸ªå°†æ—¥å¿—å‘é€åˆ°[Comet ML](https://www.comet.ml/site/)çš„[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ã€‚

#### `setup`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L844)

```py
( args state model )
```

è®¾ç½®å¯é€‰çš„Comet.mlé›†æˆã€‚

ç¯å¢ƒï¼š

+   `COMET_MODE` (`str`, *å¯é€‰*ï¼Œé»˜è®¤ä¸º`ONLINE`): æ˜¯å¦åˆ›å»ºåœ¨çº¿ã€ç¦»çº¿å®éªŒæˆ–ç¦ç”¨Cometæ—¥å¿—è®°å½•ã€‚å¯ä»¥æ˜¯`OFFLINE`ã€`ONLINE`æˆ–`DISABLED`ã€‚

+   `COMET_PROJECT_NAME` (`str`, *å¯é€‰*): ç”¨äºå®éªŒçš„Cometé¡¹ç›®åç§°ã€‚

+   `COMET_OFFLINE_DIRECTORY` (`str`, *å¯é€‰*): åœ¨`COMET_MODE`ä¸º`OFFLINE`æ—¶ç”¨äºä¿å­˜ç¦»çº¿å®éªŒçš„æ–‡ä»¶å¤¹ã€‚

+   `COMET_LOG_ASSETS` (`str`, *å¯é€‰*ï¼Œé»˜è®¤ä¸º`TRUE`): æ˜¯å¦å°†è®­ç»ƒèµ„äº§ï¼ˆtfäº‹ä»¶æ—¥å¿—ã€æ£€æŸ¥ç‚¹ç­‰ï¼‰è®°å½•åˆ°Cometã€‚å¯ä»¥æ˜¯`TRUE`æˆ–`FALSE`ã€‚

æœ‰å…³ç¯å¢ƒä¸­å¯é…ç½®é¡¹ç›®çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[æ­¤å¤„](https://www.comet.ml/docs/python-sdk/advanced/#comet-configuration-variables)ã€‚

### `class transformers.DefaultFlowCallback`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L432)

```py
( )
```

å¤„ç†è®­ç»ƒå¾ªç¯çš„é»˜è®¤æµç¨‹ï¼ŒåŒ…æ‹¬æ—¥å¿—ã€è¯„ä¼°å’Œæ£€æŸ¥ç‚¹çš„[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ã€‚

### `class transformers.PrinterCallback`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L532)

```py
( )
```

ä¸€ä¸ªç®€å•çš„[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ï¼Œåªæ‰“å°æ—¥å¿—ã€‚

### `class transformers.ProgressCallback`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L482)

```py
( )
```

ä¸€ä¸ªæ˜¾ç¤ºè®­ç»ƒæˆ–è¯„ä¼°è¿›åº¦çš„[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ã€‚

### `class transformers.EarlyStoppingCallback`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L543)

```py
( early_stopping_patience: int = 1 early_stopping_threshold: Optional = 0.0 )
```

å‚æ•°

+   `early_stopping_patience` (`int`) â€” ä¸`metric_for_best_model`ä¸€èµ·ä½¿ç”¨ï¼Œå½“æŒ‡å®šçš„æŒ‡æ ‡åœ¨`early_stopping_patience`æ¬¡è¯„ä¼°è°ƒç”¨ä¸­æ¶åŒ–æ—¶åœæ­¢è®­ç»ƒã€‚

+   `early_stopping_threshold(float,` *å¯é€‰*) â€” ä¸TrainingArgumentsçš„`metric_for_best_model`å’Œ`early_stopping_patience`ä¸€èµ·ä½¿ç”¨ï¼Œè¡¨ç¤ºæŒ‡å®šæŒ‡æ ‡å¿…é¡»æ”¹å–„å¤šå°‘æ‰èƒ½æ»¡è¶³æå‰åœæ­¢æ¡ä»¶ã€‚

ä¸€ä¸ªå¤„ç†æå‰åœæ­¢çš„[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ã€‚

æ­¤å›è°ƒå–å†³äº[TrainingArguments](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.TrainingArguments)å‚æ•°*load_best_model_at_end*åŠŸèƒ½ï¼Œä»¥åœ¨[TrainerState](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerState)ä¸­è®¾ç½®best_metricã€‚è¯·æ³¨æ„ï¼Œå¦‚æœ[TrainingArguments](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.TrainingArguments)å‚æ•°*save_steps*ä¸*eval_steps*ä¸åŒï¼Œåˆ™ç›´åˆ°ä¸‹ä¸€ä¸ªä¿å­˜æ­¥éª¤æ‰ä¼šå‘ç”Ÿæ—©åœã€‚

### `class transformers.integrations.TensorBoardCallback`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L579)

```py
( tb_writer = None )
```

å‚æ•°

+   `tb_writer`ï¼ˆ`SummaryWriter`ï¼Œ*å¯é€‰*ï¼‰â€”è¦ä½¿ç”¨çš„å†™å…¥å™¨ã€‚å¦‚æœæœªè®¾ç½®ï¼Œå°†å®ä¾‹åŒ–ä¸€ä¸ªã€‚

ä¸€ä¸ª[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ï¼Œå°†æ—¥å¿—å‘é€åˆ°[TensorBoard](https://www.tensorflow.org/tensorboard)ã€‚

### `class transformers.integrations.WandbCallback`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L665)

```py
( )
```

ä¸€ä¸ª[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ï¼Œå°†æŒ‡æ ‡ã€åª’ä½“ã€æ¨¡å‹æ£€æŸ¥ç‚¹è®°å½•åˆ°[Weights and Biases](https://www.wandb.com/)ã€‚

#### `setup`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L690)

```py
( args state model **kwargs )
```

è®¾ç½®å¯é€‰çš„Weights & Biasesï¼ˆ*wandb*ï¼‰é›†æˆã€‚

å¦‚æœéœ€è¦ï¼Œå¯ä»¥å­ç±»åŒ–å¹¶é‡å†™æ­¤æ–¹æ³•ä»¥è‡ªå®šä¹‰è®¾ç½®ã€‚åœ¨[è¿™é‡Œ](https://docs.wandb.ai/guides/integrations/huggingface)æ‰¾åˆ°æ›´å¤šä¿¡æ¯ã€‚æ‚¨è¿˜å¯ä»¥é‡å†™ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

ç¯å¢ƒï¼š

+   `WANDB_LOG_MODEL`ï¼ˆ`str`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`"false"`ï¼‰ï¼šæ˜¯å¦åœ¨è®­ç»ƒæœŸé—´è®°å½•æ¨¡å‹å’Œæ£€æŸ¥ç‚¹ã€‚å¯ä»¥æ˜¯`"end"`ï¼Œ`"checkpoint"`æˆ–`"false"`ã€‚å¦‚æœè®¾ç½®ä¸º`"end"`ï¼Œæ¨¡å‹å°†åœ¨è®­ç»ƒç»“æŸæ—¶ä¸Šä¼ ã€‚å¦‚æœè®¾ç½®ä¸º`"checkpoint"`ï¼Œå°†åœ¨æ¯æ¬¡`args.save_steps`ä¿å­˜æ—¶ä¸Šä¼ æ£€æŸ¥ç‚¹ã€‚å¦‚æœè®¾ç½®ä¸º`"false"`ï¼Œæ¨¡å‹å°†ä¸ä¼šä¸Šä¼ ã€‚ä¸`load_best_model_at_end()`ä¸€èµ·ä½¿ç”¨ä»¥ä¸Šä¼ æœ€ä½³æ¨¡å‹ã€‚

    åœ¨5.0ä¸­å·²å¼ƒç”¨

    åœ¨ğŸ¤— Transformersçš„ç¬¬5ç‰ˆä¸­ï¼Œå°†åºŸå¼ƒå°†`WANDB_LOG_MODEL`è®¾ç½®ä¸º`bool`ã€‚

+   `WANDB_WATCH`ï¼ˆ`str`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`"false"`ï¼‰ï¼šå¯ä»¥æ˜¯`"gradients"`ï¼Œ`"all"`ï¼Œ`"parameters"`æˆ–`"false"`ã€‚è®¾ç½®ä¸º`"all"`ä»¥è®°å½•æ¢¯åº¦å’Œå‚æ•°ã€‚

+   `WANDB_PROJECT`ï¼ˆ`str`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`"huggingface"`ï¼‰ï¼šå°†å…¶è®¾ç½®ä¸ºè‡ªå®šä¹‰å­—ç¬¦ä¸²ä»¥å°†ç»“æœå­˜å‚¨åœ¨ä¸åŒçš„é¡¹ç›®ä¸­ã€‚

+   `WANDB_DISABLED`ï¼ˆ`bool`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`False`ï¼‰ï¼šæ˜¯å¦å®Œå…¨ç¦ç”¨wandbã€‚è®¾ç½®`WANDB_DISABLED=true`ä»¥ç¦ç”¨ã€‚

### `class transformers.integrations.MLflowCallback`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L933)

```py
( )
```

ä¸€ä¸ª[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ï¼Œå°†æ—¥å¿—å‘é€åˆ°[MLflow](https://www.mlflow.org/)ã€‚å¯ä»¥é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡`DISABLE_MLFLOW_INTEGRATION = TRUE`æ¥ç¦ç”¨ã€‚

#### `setup`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L952)

```py
( args state model )
```

è®¾ç½®å¯é€‰çš„MLflowé›†æˆã€‚

ç¯å¢ƒï¼š

+   `HF_MLFLOW_LOG_ARTIFACTS`ï¼ˆ`str`ï¼Œ*å¯é€‰*ï¼‰ï¼šæ˜¯å¦ä½¿ç”¨MLflowçš„`.log_artifact()`åŠŸèƒ½æ¥è®°å½•å·¥ä»¶ã€‚åªæœ‰åœ¨å°†æ—¥å¿—è®°å½•åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼ˆä¾‹å¦‚s3æˆ–GCSï¼‰æ—¶æ‰æœ‰æ„ä¹‰ã€‚å¦‚æœè®¾ç½®ä¸º`True`æˆ–*1*ï¼Œå°†åœ¨æ¯æ¬¡åœ¨[TrainingArguments](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.TrainingArguments)çš„`output_dir`ä¸­ä¿å­˜æ—¶å°†æ¯ä¸ªä¿å­˜çš„æ£€æŸ¥ç‚¹å¤åˆ¶åˆ°æœ¬åœ°æˆ–è¿œç¨‹å·¥ä»¶å­˜å‚¨ã€‚åœ¨æ²¡æœ‰è¿œç¨‹å­˜å‚¨çš„æƒ…å†µä¸‹ä½¿ç”¨å®ƒå°†åªæ˜¯å°†æ–‡ä»¶å¤åˆ¶åˆ°æ‚¨çš„å·¥ä»¶ä½ç½®ã€‚

+   `MLFLOW_EXPERIMENT_NAME` (`str`, *å¯é€‰*, é»˜è®¤ä¸º`None`)ï¼šæ˜¯å¦ä½¿ç”¨MLflowå®éªŒåç§°æ¥å¯åŠ¨è¿è¡Œã€‚é»˜è®¤ä¸º`None`ï¼Œå°†æŒ‡å‘MLflowä¸­çš„`Default`å®éªŒã€‚å¦åˆ™ï¼Œå®ƒæ˜¯è¦æ¿€æ´»çš„å®éªŒçš„åŒºåˆ†å¤§å°å†™åç§°ã€‚å¦‚æœä¸å­˜åœ¨å…·æœ‰æ­¤åç§°çš„å®éªŒï¼Œåˆ™å°†åˆ›å»ºä¸€ä¸ªå…·æœ‰æ­¤åç§°çš„æ–°å®éªŒã€‚

+   `MLFLOW_TAGS` (`str`, *å¯é€‰*)ï¼šè¦æ·»åŠ åˆ°MLflowè¿è¡Œä¸­çš„æ ‡ç­¾çš„é”®/å€¼å¯¹çš„å­—ç¬¦ä¸²è½¬å‚¨ã€‚ç¤ºä¾‹ï¼š`os.environ['MLFLOW_TAGS']='{"release.candidate": "RC1", "release.version": "2.2.0"}'`ã€‚

+   `MLFLOW_NESTED_RUN` (`str`, *å¯é€‰*)ï¼šæ˜¯å¦ä½¿ç”¨MLflowåµŒå¥—è¿è¡Œã€‚å¦‚æœè®¾ç½®ä¸º`True`æˆ–*1*ï¼Œå°†åœ¨å½“å‰è¿è¡Œå†…åˆ›å»ºä¸€ä¸ªåµŒå¥—è¿è¡Œã€‚

+   `MLFLOW_RUN_ID` (`str`, *å¯é€‰*)ï¼šå…è®¸é‡æ–°é™„åŠ åˆ°ç°æœ‰è¿è¡Œï¼Œè¿™åœ¨ä»æ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒæ—¶å¯èƒ½å¾ˆæœ‰ç”¨ã€‚å½“è®¾ç½®äº†`MLFLOW_RUN_ID`ç¯å¢ƒå˜é‡æ—¶ï¼Œ`start_run`å°è¯•æ¢å¤å…·æœ‰æŒ‡å®šè¿è¡ŒIDçš„è¿è¡Œï¼Œå…¶ä»–å‚æ•°å°†è¢«å¿½ç•¥ã€‚

+   `MLFLOW_FLATTEN_PARAMS` (`str`, *å¯é€‰*, é»˜è®¤ä¸º`False`)ï¼šæ˜¯å¦åœ¨è®°å½•ä¹‹å‰å±•å¹³å‚æ•°å­—å…¸ã€‚

### `class transformers.integrations.AzureMLCallback`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L910)

```py
( azureml_run = None )
```

ä¸€ä¸ª[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ï¼Œå°†æ—¥å¿—å‘é€åˆ°[AzureML](https://pypi.org/project/azureml-sdk/)ã€‚

### `class transformers.integrations.CodeCarbonCallback`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L1399)

```py
( )
```

ä¸€ä¸ª[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ï¼Œç”¨äºè·Ÿè¸ªè®­ç»ƒçš„CO2æ’æ”¾é‡ã€‚

### `class transformers.integrations.NeptuneCallback`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L1128)

```py
( api_token: Optional = None project: Optional = None name: Optional = None base_namespace: str = 'finetuning' run = None log_parameters: bool = True log_checkpoints: Optional = None **neptune_run_kwargs )
```

å‚æ•°

+   `api_token` (`str`, *å¯é€‰*) â€” åœ¨æ³¨å†Œæ—¶è·å¾—çš„Neptune APIä»¤ç‰Œã€‚å¦‚æœå·²å°†ä»¤ç‰Œä¿å­˜åˆ°`NEPTUNE_API_TOKEN`ç¯å¢ƒå˜é‡ä¸­ï¼Œå¯ä»¥çœç•¥æ­¤å‚æ•°ï¼ˆå¼ºçƒˆå»ºè®®ï¼‰ã€‚åœ¨[æ–‡æ¡£](https://docs.neptune.ai/setup/installation)ä¸­æŸ¥çœ‹å®Œæ•´çš„è®¾ç½®è¯´æ˜ã€‚

+   `project` (`str`, *å¯é€‰*) â€” Neptuneé¡¹ç›®çš„åç§°ï¼Œæ ¼å¼ä¸ºâ€œworkspace-name/project-nameâ€ã€‚æ‚¨å¯ä»¥åœ¨Neptuneä¸­çš„é¡¹ç›®è®¾ç½® -> å±æ€§ä¸­æ‰¾åˆ°å¹¶å¤åˆ¶åç§°ã€‚å¦‚æœä¸ºNoneï¼ˆé»˜è®¤ï¼‰ï¼Œåˆ™ä½¿ç”¨`NEPTUNE_PROJECT`ç¯å¢ƒå˜é‡çš„å€¼ã€‚

+   `name` (`str`, *å¯é€‰*) â€” è¿è¡Œçš„è‡ªå®šä¹‰åç§°ã€‚

+   `base_namespace` (`str`, å¯é€‰, é»˜è®¤ä¸ºâ€œfinetuningâ€) â€” åœ¨Neptuneè¿è¡Œä¸­ï¼Œå°†åŒ…å«å›è°ƒè®°å½•çš„æ‰€æœ‰å…ƒæ•°æ®çš„æ ¹å‘½åç©ºé—´ã€‚

+   `log_parameters` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º`True`) â€” å¦‚æœä¸ºTrueï¼Œåˆ™è®°å½•Traineræä¾›çš„æ‰€æœ‰å‚æ•°å’Œæ¨¡å‹å‚æ•°ã€‚

+   `log_checkpoints` (`str`, *å¯é€‰*) â€” å¦‚æœä¸ºâ€œsameâ€ï¼Œåˆ™åœ¨Trainerä¿å­˜æ£€æŸ¥ç‚¹æ—¶ä¸Šä¼ æ£€æŸ¥ç‚¹ã€‚å¦‚æœä¸ºâ€œlastâ€ï¼Œåˆ™ä»…ä¸Šä¼ æœ€è¿‘ä¿å­˜çš„æ£€æŸ¥ç‚¹ã€‚å¦‚æœä¸ºâ€œbestâ€ï¼Œåˆ™ä¸Šä¼ æœ€ä½³æ£€æŸ¥ç‚¹ï¼ˆåœ¨Trainerä¿å­˜çš„æ£€æŸ¥ç‚¹ä¸­é€‰æ‹©ï¼‰ã€‚å¦‚æœä¸º`None`ï¼Œåˆ™ä¸ä¸Šä¼ æ£€æŸ¥ç‚¹ã€‚

+   `run` (`Run`, *å¯é€‰*) â€” å¦‚æœè¦ç»§ç»­è®°å½•åˆ°ç°æœ‰è¿è¡Œä¸­ï¼Œè¯·ä¼ é€’ä¸€ä¸ªNeptuneè¿è¡Œå¯¹è±¡ã€‚åœ¨[æ–‡æ¡£](https://docs.neptune.ai/logging/to_existing_object)ä¸­äº†è§£æ›´å¤šå…³äºæ¢å¤è¿è¡Œçš„ä¿¡æ¯ã€‚

+   *`*neptune_run_kwargs` (*å¯é€‰*) â€” ä¼ é€’ç»™[`neptune.init_run()`](https://docs.neptune.ai/api/neptune#init_run)å‡½æ•°çš„å…¶ä»–å…³é”®å­—å‚æ•°ï¼Œå½“åˆ›å»ºæ–°è¿è¡Œæ—¶ã€‚

å°†æ—¥å¿—å‘é€åˆ°[Neptune](https://app.neptune.ai)çš„TrainerCallbackã€‚

æœ‰å…³è¯´æ˜å’Œç¤ºä¾‹ï¼Œè¯·å‚é˜…Neptuneæ–‡æ¡£ä¸­çš„[Transformersé›†æˆæŒ‡å—](https://docs.neptune.ai/integrations/transformers)ã€‚

### `class transformers.integrations.ClearMLCallback`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L1428)

```py
( )
```

ä¸€ä¸ªå°†æ—¥å¿—å‘é€åˆ°[ClearML](https://clear.ml/)çš„[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ã€‚

ç¯å¢ƒï¼š

+   `CLEARML_PROJECT` (`str`, *å¯é€‰*, é»˜è®¤ä¸º `HuggingFace Transformers`): ClearMLé¡¹ç›®åç§°ã€‚

+   `CLEARML_TASK` (`str`, *å¯é€‰*, é»˜è®¤ä¸º `Trainer`): ClearMLä»»åŠ¡åç§°ã€‚

+   `CLEARML_LOG_MODEL` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º `False`): æ˜¯å¦åœ¨è®­ç»ƒæœŸé—´å°†æ¨¡å‹è®°å½•ä¸ºå·¥ä»¶ã€‚

### `class transformers.integrations.DagsHubCallback`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L1068)

```py
( )
```

ä¸€ä¸ªå°†æ—¥å¿—è®°å½•åˆ°[DagsHub](https://dagshub.com/)çš„[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ã€‚æ‰©å±•`MLflowCallback`

### `setup`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L1082)

```py
( *args **kwargs )
```

è®¾ç½®DagsHubçš„æ—¥å¿—è®°å½•é›†æˆã€‚

ç¯å¢ƒï¼š

+   `HF_DAGSHUB_LOG_ARTIFACTS` (`str`, *å¯é€‰*): æ˜¯å¦ä¿å­˜å®éªŒçš„æ•°æ®å’Œæ¨¡å‹å·¥ä»¶ã€‚é»˜è®¤ä¸º`False`ã€‚

### `class transformers.integrations.FlyteCallback`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L1549)

```py
( save_log_history: bool = True sync_checkpoints: bool = True )
```

å‚æ•°

+   `save_log_history` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º `True`) â€” å½“è®¾ç½®ä¸ºTrueæ—¶ï¼Œè®­ç»ƒæ—¥å¿—å°†ä¿å­˜ä¸ºFlyte Deckã€‚

+   `sync_checkpoints` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º `True`) â€” å½“è®¾ç½®ä¸ºTrueæ—¶ï¼Œæ£€æŸ¥ç‚¹å°†ä¸FlyteåŒæ­¥ï¼Œå¹¶å¯ç”¨äºåœ¨ä¸­æ–­çš„æƒ…å†µä¸‹æ¢å¤è®­ç»ƒã€‚

ä¸€ä¸ªå°†æ—¥å¿—å‘é€åˆ°[Flyte](https://flyte.org/)çš„[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ã€‚æ³¨æ„ï¼šæ­¤å›è°ƒä»…åœ¨Flyteä»»åŠ¡å†…èµ·ä½œç”¨ã€‚

ç¤ºä¾‹ï¼š

```py
# Note: This example skips over some setup steps for brevity.
from flytekit import current_context, task

@task
def train_hf_transformer():
    cp = current_context().checkpoint
    trainer = Trainer(..., callbacks=[FlyteCallback()])
    output = trainer.train(resume_from_checkpoint=cp.restore())
```

### `class transformers.integrations.DVCLiveCallback`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L1612)

```py
( live: Optional = None log_model: Union = None **kwargs )
```

å‚æ•°

+   `live` (`dvclive.Live`, *å¯é€‰*, é»˜è®¤ä¸º `None`) â€” å¯é€‰çš„Liveå®ä¾‹ã€‚å¦‚æœä¸ºNoneï¼Œåˆ™å°†ä½¿ç”¨**kwargsåˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹ã€‚

+   `log_model` (Union[Literal[`"all"`], bool], *å¯é€‰*, é»˜è®¤ä¸º `None`) â€” æ˜¯å¦ä½¿ç”¨`dvclive.Live.log_artifact()`æ¥è®°å½•[Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)åˆ›å»ºçš„æ£€æŸ¥ç‚¹ã€‚å¦‚æœè®¾ç½®ä¸º`True`ï¼Œåˆ™åœ¨è®­ç»ƒç»“æŸæ—¶è®°å½•æœ€ç»ˆæ£€æŸ¥ç‚¹ã€‚å¦‚æœè®¾ç½®ä¸º`"all"`ï¼Œåˆ™åœ¨æ¯ä¸ªæ£€æŸ¥ç‚¹å¤„è®°å½•æ•´ä¸ª[TrainingArguments](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.TrainingArguments)çš„`output_dir`ã€‚

ä¸€ä¸ªå°†æ—¥å¿—å‘é€åˆ°[DVCLive](https://www.dvc.org/doc/dvclive)çš„[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ã€‚

åœ¨`setup`ä¸­ä½¿ç”¨ä¸‹é¢çš„ç¯å¢ƒå˜é‡æ¥é…ç½®é›†æˆã€‚è¦åœ¨è¿™äº›ç¯å¢ƒå˜é‡ä¹‹å¤–è‡ªå®šä¹‰æ­¤å›è°ƒï¼Œè¯·å‚é˜…[æ­¤å¤„](https://dvc.org/doc/dvclive/ml-frameworks/huggingface)ã€‚

#### `setup`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/integrations/integration_utils.py#L1648)

```py
( args state model )
```

è®¾ç½®å¯é€‰çš„DVCLiveé›†æˆã€‚è¦åœ¨ç¯å¢ƒå˜é‡ä¹‹å¤–è‡ªå®šä¹‰æ­¤å›è°ƒï¼Œè¯·å‚é˜…[æ­¤å¤„](https://dvc.org/doc/dvclive/ml-frameworks/huggingface)ã€‚

ç¯å¢ƒï¼š

+   `HF_DVCLIVE_LOG_MODEL` (`str`, *å¯é€‰*): æ˜¯å¦ä½¿ç”¨`dvclive.Live.log_artifact()`æ¥è®°å½•[Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)åˆ›å»ºçš„æ£€æŸ¥ç‚¹ã€‚å¦‚æœè®¾ç½®ä¸º`True`æˆ–*1*ï¼Œåˆ™åœ¨è®­ç»ƒç»“æŸæ—¶è®°å½•æœ€ç»ˆæ£€æŸ¥ç‚¹ã€‚å¦‚æœè®¾ç½®ä¸º`all`ï¼Œåˆ™åœ¨æ¯ä¸ªæ£€æŸ¥ç‚¹å¤„è®°å½•æ•´ä¸ª[TrainingArguments](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.TrainingArguments)çš„`output_dir`ã€‚

## TrainerCallback

### `class transformers.TrainerCallback`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L175)

```py
( )
```

å‚æ•°

+   `args` ([TrainingArguments](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.TrainingArguments)) â€” ç”¨äºå®ä¾‹åŒ–[Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)çš„è®­ç»ƒå‚æ•°ã€‚

+   `state` ([TrainerState](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerState)) â€” [Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)çš„å½“å‰çŠ¶æ€ã€‚

+   `control` ([TrainerControl](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerControl)) â€” è¿”å›ç»™[Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)å¹¶å¯ç”¨äºåšå‡ºä¸€äº›å†³ç­–çš„å¯¹è±¡ã€‚

+   `model` ([PreTrainedModel](/docs/transformers/v4.37.2/en/main_classes/model#transformers.PreTrainedModel)æˆ–`torch.nn.Module`) â€” æ­£åœ¨è®­ç»ƒçš„æ¨¡å‹ã€‚

+   `tokenizer` ([PreTrainedTokenizer](/docs/transformers/v4.37.2/en/main_classes/tokenizer#transformers.PreTrainedTokenizer)) â€” ç”¨äºç¼–ç æ•°æ®çš„åˆ†è¯å™¨ã€‚

+   `optimizer` (`torch.optim.Optimizer`) â€” ç”¨äºè®­ç»ƒæ­¥éª¤çš„ä¼˜åŒ–å™¨ã€‚

+   `lr_scheduler` (`torch.optim.lr_scheduler.LambdaLR`) â€” ç”¨äºè®¾ç½®å­¦ä¹ ç‡çš„è°ƒåº¦å™¨ã€‚

+   `train_dataloader` (`torch.utils.data.DataLoader`, *optional*) â€” ç”¨äºè®­ç»ƒçš„å½“å‰æ•°æ®åŠ è½½å™¨ã€‚

+   `eval_dataloader` (`torch.utils.data.DataLoader`, *optional*) â€” ç”¨äºè®­ç»ƒçš„å½“å‰æ•°æ®åŠ è½½å™¨ã€‚

+   `metrics` (`Dict[str, float]`) â€” ä¸Šæ¬¡è¯„ä¼°é˜¶æ®µè®¡ç®—çš„æŒ‡æ ‡ã€‚

    è¿™äº›åªèƒ½åœ¨äº‹ä»¶`on_evaluate`ä¸­è®¿é—®ã€‚

+   `logs` (`Dict[str, float]`) â€” è¦è®°å½•çš„å€¼ã€‚

    è¿™äº›åªèƒ½åœ¨äº‹ä»¶`on_log`ä¸­è®¿é—®ã€‚

ä¸€ä¸ªç”¨äºåœ¨æŸäº›äº‹ä»¶ä¸­æ£€æŸ¥è®­ç»ƒå¾ªç¯çŠ¶æ€å¹¶åšå‡ºä¸€äº›å†³ç­–çš„å¯¹è±¡ç±»ã€‚åœ¨æ¯ä¸ªäº‹ä»¶ä¸­ï¼Œä»¥ä¸‹å‚æ•°éƒ½æ˜¯å¯ç”¨çš„ï¼š

`control`å¯¹è±¡æ˜¯å”¯ä¸€å¯ä»¥è¢«å›è°ƒå‡½æ•°æ›´æ”¹çš„å¯¹è±¡ï¼Œå¦‚æœæ›´æ”¹äº†`control`çš„äº‹ä»¶åº”è¯¥è¿”å›ä¿®æ”¹åçš„ç‰ˆæœ¬ã€‚

å‚æ•°`args`ã€`state`å’Œ`control`å¯¹äºæ‰€æœ‰äº‹ä»¶éƒ½æ˜¯ä½ç½®å‚æ•°ï¼Œå…¶ä»–å‚æ•°éƒ½è¢«åˆ†ç»„åœ¨`kwargs`ä¸­ã€‚æ‚¨å¯ä»¥åœ¨äº‹ä»¶çš„ç­¾åä¸­è§£åŒ…æ‚¨éœ€è¦çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼ŒæŸ¥çœ‹ç®€å•çš„[PrinterCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.PrinterCallback)çš„ä»£ç ã€‚

ç¤ºä¾‹ï¼š

```py
class PrinterCallback(TrainerCallback):
    def on_log(self, args, state, control, logs=None, **kwargs):
        _ = logs.pop("total_flos", None)
        if state.is_local_process_zero:
            print(logs)
```

#### `on_epoch_begin`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L244)

```py
( args: TrainingArguments state: TrainerState control: TrainerControl **kwargs )
```

åœ¨ä¸€ä¸ªepochå¼€å§‹æ—¶è°ƒç”¨çš„äº‹ä»¶ã€‚

#### `on_epoch_end`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L250)

```py
( args: TrainingArguments state: TrainerState control: TrainerControl **kwargs )
```

åœ¨ä¸€ä¸ªepochç»“æŸæ—¶è°ƒç”¨çš„äº‹ä»¶ã€‚

#### `on_evaluate`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L276)

```py
( args: TrainingArguments state: TrainerState control: TrainerControl **kwargs )
```

åœ¨è¯„ä¼°é˜¶æ®µåè°ƒç”¨çš„äº‹ä»¶ã€‚

#### `on_init_end`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L226)

```py
( args: TrainingArguments state: TrainerState control: TrainerControl **kwargs )
```

åœ¨[Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)åˆå§‹åŒ–ç»“æŸæ—¶è°ƒç”¨çš„äº‹ä»¶ã€‚

#### `on_log`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L294)

```py
( args: TrainingArguments state: TrainerState control: TrainerControl **kwargs )
```

åœ¨è®°å½•æœ€åæ—¥å¿—åè°ƒç”¨çš„äº‹ä»¶ã€‚

#### `on_predict`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L282)

```py
( args: TrainingArguments state: TrainerState control: TrainerControl metrics **kwargs )
```

åœ¨æˆåŠŸé¢„æµ‹åè°ƒç”¨çš„äº‹ä»¶ã€‚

#### `on_prediction_step`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L300)

```py
( args: TrainingArguments state: TrainerState control: TrainerControl **kwargs )
```

åœ¨é¢„æµ‹æ­¥éª¤åè°ƒç”¨çš„äº‹ä»¶ã€‚

#### `on_save`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L288)

```py
( args: TrainingArguments state: TrainerState control: TrainerControl **kwargs )
```

åœ¨ä¿å­˜æ£€æŸ¥ç‚¹åè°ƒç”¨çš„äº‹ä»¶ã€‚

#### `on_step_begin`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L256)

```py
( args: TrainingArguments state: TrainerState control: TrainerControl **kwargs )
```

åœ¨è®­ç»ƒæ­¥éª¤å¼€å§‹æ—¶è°ƒç”¨çš„äº‹ä»¶ã€‚å¦‚æœä½¿ç”¨æ¢¯åº¦ç´¯ç§¯ï¼Œä¸€ä¸ªè®­ç»ƒæ­¥éª¤å¯èƒ½éœ€è¦å¤šä¸ªè¾“å…¥ã€‚

#### `on_step_end`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L269)

```py
( args: TrainingArguments state: TrainerState control: TrainerControl **kwargs )
```

åœ¨è®­ç»ƒæ­¥éª¤ç»“æŸæ—¶è°ƒç”¨çš„äº‹ä»¶ã€‚å¦‚æœä½¿ç”¨æ¢¯åº¦ç´¯ç§¯ï¼Œä¸€ä¸ªè®­ç»ƒæ­¥éª¤å¯èƒ½éœ€è¦å¤šä¸ªè¾“å…¥ã€‚

#### `on_substep_end`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L263)

```py
( args: TrainingArguments state: TrainerState control: TrainerControl **kwargs )
```

åœ¨æ¢¯åº¦ç´¯ç§¯æœŸé—´å­æ­¥éª¤ç»“æŸæ—¶è°ƒç”¨çš„äº‹ä»¶ã€‚

#### `on_train_begin`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L232)

```py
( args: TrainingArguments state: TrainerState control: TrainerControl **kwargs )
```

åœ¨è®­ç»ƒå¼€å§‹æ—¶è°ƒç”¨çš„äº‹ä»¶ã€‚

`on_train_end`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L238)

```py
( args: TrainingArguments state: TrainerState control: TrainerControl **kwargs )
```

åœ¨è®­ç»ƒç»“æŸæ—¶è°ƒç”¨çš„äº‹ä»¶ã€‚

è¿™æ˜¯ä¸€ä¸ªå¦‚ä½•åœ¨PyTorch [Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer) ä¸­æ³¨å†Œè‡ªå®šä¹‰å›è°ƒçš„ç¤ºä¾‹ï¼š

```py
class MyCallback(TrainerCallback):
    "A callback that prints a message at the beginning of training"

    def on_train_begin(self, args, state, control, **kwargs):
        print("Starting training")

trainer = Trainer(
    model,
    args,
    train_dataset=train_dataset,
    eval_dataset=eval_dataset,
    callbacks=[MyCallback],  # We can either pass the callback class this way or an instance of it (MyCallback())
)
```

å¦ä¸€ç§æ³¨å†Œå›è°ƒçš„æ–¹æ³•æ˜¯è°ƒç”¨`trainer.add_callback()`å¦‚ä¸‹ï¼š

```py
trainer = Trainer(...)
trainer.add_callback(MyCallback)
# Alternatively, we can pass an instance of the callback class
trainer.add_callback(MyCallback())
```

## TrainerState

### `class transformers.TrainerState`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L34)

```py
( epoch: Optional = None global_step: int = 0 max_steps: int = 0 logging_steps: int = 500 eval_steps: int = 500 save_steps: int = 500 train_batch_size: int = None num_train_epochs: int = 0 num_input_tokens_seen: int = 0 total_flos: float = 0 log_history: List = None best_metric: Optional = None best_model_checkpoint: Optional = None is_local_process_zero: bool = True is_world_process_zero: bool = True is_hyper_param_search: bool = False trial_name: str = None trial_params: Dict = None )
```

å‚æ•°

+   `epoch` (`float`, *å¯é€‰*) â€” ä»…åœ¨è®­ç»ƒæœŸé—´è®¾ç½®ï¼Œè¡¨ç¤ºè®­ç»ƒæ‰€å¤„çš„æ—¶ä»£ï¼ˆå°æ•°éƒ¨åˆ†è¡¨ç¤ºå½“å‰æ—¶ä»£å®Œæˆçš„ç™¾åˆ†æ¯”ï¼‰ã€‚

+   `global_step` (`int`, *å¯é€‰*, é»˜è®¤ä¸º0) â€” åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè¡¨ç¤ºå·²å®Œæˆçš„æ›´æ–°æ­¥éª¤æ•°é‡ã€‚

+   `max_steps` (`int`, *å¯é€‰*, é»˜è®¤ä¸º0) â€” å½“å‰è®­ç»ƒè¦æ‰§è¡Œçš„æ›´æ–°æ­¥éª¤æ•°é‡ã€‚

+   `logging_steps` (`int`, *å¯é€‰*, é»˜è®¤ä¸º500) â€” æ¯Xä¸ªæ›´æ–°æ­¥éª¤è®°å½•ä¸€æ¬¡æ—¥å¿—

+   `eval_steps` (`int`, *å¯é€‰*) â€” æ¯Xæ­¥è¿è¡Œä¸€æ¬¡è¯„ä¼°ã€‚

+   `save_steps` (`int`, *å¯é€‰*, é»˜è®¤ä¸º500) â€” æ¯Xä¸ªæ›´æ–°æ­¥éª¤ä¿å­˜ä¸€æ¬¡æ£€æŸ¥ç‚¹ã€‚

+   `train_batch_size` (`int`, *å¯é€‰*) â€” è®­ç»ƒæ•°æ®åŠ è½½å™¨çš„æ‰¹é‡å¤§å°ã€‚ä»…åœ¨ä½¿ç”¨`auto_find_batch_size`æ—¶éœ€è¦ã€‚

+   `num_input_tokens_seen` (`int`, *å¯é€‰*, é»˜è®¤ä¸º0) â€” è®­ç»ƒæœŸé—´çœ‹åˆ°çš„æ ‡è®°æ•°é‡ï¼ˆè¾“å…¥æ ‡è®°æ•°é‡ï¼Œè€Œä¸æ˜¯é¢„æµ‹æ ‡è®°æ•°é‡ï¼‰ã€‚

+   `total_flos` (`float`, *å¯é€‰*, é»˜è®¤ä¸º0) â€” è‡ªè®­ç»ƒå¼€å§‹ä»¥æ¥æ¨¡å‹æ‰§è¡Œçš„æµ®ç‚¹æ“ä½œæ€»æ•°ï¼ˆå­˜å‚¨ä¸ºæµ®ç‚¹æ•°ä»¥é¿å…æº¢å‡ºï¼‰ã€‚

+   `log_history` (`List[Dict[str, float]]`, *å¯é€‰*) â€” è‡ªè®­ç»ƒå¼€å§‹ä»¥æ¥å®Œæˆçš„æ—¥å¿—åˆ—è¡¨ã€‚

+   `best_metric` (`float`, *å¯é€‰*) â€” è·Ÿè¸ªæœ€ä½³æ¨¡å‹æ—¶ï¼Œè¿„ä»Šä¸ºæ­¢é‡åˆ°çš„æœ€ä½³æŒ‡æ ‡çš„å€¼ã€‚

+   `best_model_checkpoint` (`str`, *å¯é€‰*) â€” è·Ÿè¸ªæœ€ä½³æ¨¡å‹æ—¶ï¼Œè¿„ä»Šä¸ºæ­¢é‡åˆ°çš„æœ€ä½³æ¨¡å‹çš„æ£€æŸ¥ç‚¹åç§°çš„å€¼ã€‚

+   `is_local_process_zero` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º`True`) â€” æ˜¯å¦è¿™ä¸ªè¿›ç¨‹æ˜¯æœ¬åœ°ï¼ˆä¾‹å¦‚ï¼Œåœ¨å¤šå°æœºå™¨ä¸Šä»¥åˆ†å¸ƒå¼æ–¹å¼è®­ç»ƒæ—¶ï¼Œæ˜¯ä¸€å°æœºå™¨ä¸Šçš„ä¸»è¿›ç¨‹ï¼‰ã€‚

+   `is_world_process_zero` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º`True`) â€” æ˜¯å¦è¿™ä¸ªè¿›ç¨‹æ˜¯å…¨å±€ä¸»è¿›ç¨‹ï¼ˆåœ¨å¤šå°æœºå™¨ä¸Šä»¥åˆ†å¸ƒå¼æ–¹å¼è®­ç»ƒæ—¶ï¼Œåªæœ‰ä¸€ä¸ªè¿›ç¨‹ä¼šæ˜¯`True`ï¼‰ã€‚

+   `is_hyper_param_search` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º`False`) â€” æ˜¯å¦æ­£åœ¨ä½¿ç”¨Trainer.hyperparameter_searchè¿›è¡Œè¶…å‚æ•°æœç´¢ã€‚è¿™å°†å½±å“æ•°æ®åœ¨TensorBoardä¸­è®°å½•çš„æ–¹å¼ã€‚

ä¸€ä¸ªåŒ…å«å°†åœ¨æ£€æŸ¥ç‚¹æ—¶ä¿å­˜çš„[Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)å†…éƒ¨çŠ¶æ€çš„ç±»ï¼Œå¹¶ä¼ é€’ç»™[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ã€‚

åœ¨è¿™ä¸ªç±»ä¸­ï¼Œä¸€ä¸ªæ­¥éª¤è¢«ç†è§£ä¸ºä¸€ä¸ªæ›´æ–°æ­¥éª¤ã€‚å½“ä½¿ç”¨æ¢¯åº¦ç´¯ç§¯æ—¶ï¼Œä¸€ä¸ªæ›´æ–°æ­¥éª¤å¯èƒ½éœ€è¦å¤šæ¬¡å‰å‘å’Œåå‘ä¼ é€’ï¼šå¦‚æœä½¿ç”¨`gradient_accumulation_steps=n`ï¼Œåˆ™ä¸€ä¸ªæ›´æ–°æ­¥éª¤éœ€è¦é€šè¿‡*n*æ‰¹æ¬¡ã€‚

#### `load_from_json`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L117)

```py
( json_path: str )
```

ä»`json_path`çš„å†…å®¹åˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚

#### `save_to_json`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L111)

```py
( json_path: str )
```

å°†æ­¤å®ä¾‹çš„å†…å®¹ä»¥JSONæ ¼å¼ä¿å­˜åœ¨`json_path`ä¸­ã€‚

## TrainerControl

### `class transformers.TrainerControl`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/trainer_callback.py#L125)

```py
( should_training_stop: bool = False should_epoch_stop: bool = False should_save: bool = False should_evaluate: bool = False should_log: bool = False )
```

å‚æ•°

+   `should_training_stop`ï¼ˆ`bool`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`False`ï¼‰â€”æ˜¯å¦åº”ä¸­æ–­è®­ç»ƒã€‚

    å¦‚æœä¸º`True`ï¼Œåˆ™æ­¤å˜é‡ä¸ä¼šè¢«è®¾ç½®å›`False`ã€‚è®­ç»ƒå°†ç›´æ¥åœæ­¢ã€‚

+   `should_epoch_stop`ï¼ˆ`bool`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`False`ï¼‰â€”å½“å‰è½®æ˜¯å¦åº”ä¸­æ–­ã€‚

    å¦‚æœä¸º`True`ï¼Œåˆ™æ­¤å˜é‡å°†åœ¨ä¸‹ä¸€è½®å¼€å§‹æ—¶è®¾ç½®å›`False`ã€‚

+   `should_save`ï¼ˆ`bool`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`False`ï¼‰â€”æ¨¡å‹æ˜¯å¦åº”åœ¨æ­¤æ­¥éª¤ä¿å­˜ã€‚

    å¦‚æœä¸º`True`ï¼Œåˆ™æ­¤å˜é‡å°†åœ¨ä¸‹ä¸€æ­¥å¼€å§‹æ—¶è®¾ç½®å›`False`ã€‚

+   `should_evaluate`ï¼ˆ`bool`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`False`ï¼‰â€”æ¨¡å‹æ˜¯å¦åº”åœ¨æ­¤æ­¥éª¤è¿›è¡Œè¯„ä¼°ã€‚

    å¦‚æœä¸º`True`ï¼Œåˆ™æ­¤å˜é‡å°†åœ¨ä¸‹ä¸€æ­¥å¼€å§‹æ—¶è®¾ç½®å›`False`ã€‚

+   `should_log`ï¼ˆ`bool`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`False`ï¼‰â€”æ˜¯å¦åº”åœ¨æ­¤æ­¥éª¤æŠ¥å‘Šæ—¥å¿—ã€‚

    å¦‚æœä¸º`True`ï¼Œåˆ™æ­¤å˜é‡å°†åœ¨ä¸‹ä¸€æ­¥å¼€å§‹æ—¶è®¾ç½®å›`False`ã€‚

å¤„ç†[Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)æ§åˆ¶æµçš„ç±»ã€‚æ­¤ç±»ç”±[TrainerCallback](/docs/transformers/v4.37.2/en/main_classes/callback#transformers.TrainerCallback)ä½¿ç”¨ï¼Œä»¥åœ¨è®­ç»ƒå¾ªç¯ä¸­æ¿€æ´»ä¸€äº›å¼€å…³ã€‚
