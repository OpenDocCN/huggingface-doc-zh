- en: Polars
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Polars
- en: 'Original text: [https://huggingface.co/docs/datasets-server/polars](https://huggingface.co/docs/datasets-server/polars)'
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡é“¾æ¥ï¼š[https://huggingface.co/docs/datasets-server/polars](https://huggingface.co/docs/datasets-server/polars)
- en: null
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: '[Polars](https://pola-rs.github.io/polars-book/user-guide/) is a fast DataFrame
    library written in Rust with Arrow as its foundation.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[Polars](https://pola-rs.github.io/polars-book/user-guide/)æ˜¯ä¸€ä¸ªå¿«é€Ÿçš„DataFrameåº“ï¼Œç”¨Rustç¼–å†™ï¼Œä»¥Arrowä¸ºåŸºç¡€ã€‚'
- en: ğŸ’¡ Learn more about how to get the dataset URLs in the [List Parquet files](parquet)
    guide.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ğŸ’¡ äº†è§£å¦‚ä½•åœ¨[List Parquet files](parquet)æŒ‡å—ä¸­è·å–æ•°æ®é›†URLçš„æ›´å¤šä¿¡æ¯ã€‚
- en: 'Letâ€™s start by grabbing the URLs to the `train` split of the [`blog_authorship_corpus`](https://huggingface.co/datasets/blog_authorship_corpus)
    dataset from Datasets Server:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä»æ•°æ®é›†æœåŠ¡å™¨ä¸­è·å–[`blog_authorship_corpus`](https://huggingface.co/datasets/blog_authorship_corpus)æ•°æ®é›†çš„`train`æ‹†åˆ†çš„URLï¼š
- en: '[PRE0]'
  id: totrans-6
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'To read from a single Parquet file, use the [`read_parquet`](https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.read_parquet.html)
    function to read it into a DataFrame and then execute your query:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: è¦ä»å•ä¸ªParquetæ–‡ä»¶ä¸­è¯»å–ï¼Œè¯·ä½¿ç”¨[`read_parquet`](https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.read_parquet.html)å‡½æ•°å°†å…¶è¯»å…¥DataFrameï¼Œç„¶åæ‰§è¡Œæ‚¨çš„æŸ¥è¯¢ï¼š
- en: '[PRE1]'
  id: totrans-8
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'To read multiple Parquet files - for example, if the dataset is sharded - youâ€™ll
    need to use the [`concat`](https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.concat.html)
    function to concatenate the files into a single DataFrame:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: è¦è¯»å–å¤šä¸ªParquetæ–‡ä»¶ - ä¾‹å¦‚ï¼Œå¦‚æœæ•°æ®é›†è¢«åˆ†ç‰‡ - æ‚¨éœ€è¦ä½¿ç”¨[`concat`](https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.concat.html)å‡½æ•°å°†æ–‡ä»¶è¿æ¥æˆå•ä¸ªDataFrameï¼š
- en: '[PRE2]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Lazy API
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ‡’æƒ°çš„API
- en: Polars offers a [lazy API](https://pola-rs.github.io/polars-book/user-guide/lazy/using/)
    that is more performant and memory-efficient for large Parquet files. The LazyFrame
    API keeps track of what you want to do, and itâ€™ll only execute the entire query
    when youâ€™re ready. This way, the lazy API doesnâ€™t load everything into RAM beforehand,
    and it allows you to work with datasets larger than your available RAM.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: Polarsæä¾›äº†ä¸€ä¸ª[æ‡’æƒ°çš„API](https://pola-rs.github.io/polars-book/user-guide/lazy/using/)ï¼Œå¯¹äºå¤§å‹Parquetæ–‡ä»¶æ¥è¯´æ›´é«˜æ•ˆå’ŒèŠ‚çœå†…å­˜ã€‚LazyFrame
    APIä¼šè·Ÿè¸ªæ‚¨æƒ³è¦åšçš„äº‹æƒ…ï¼Œåªæœ‰åœ¨æ‚¨å‡†å¤‡å¥½æ—¶æ‰ä¼šæ‰§è¡Œæ•´ä¸ªæŸ¥è¯¢ã€‚è¿™æ ·ï¼Œæ‡’æƒ°çš„APIä¸ä¼šé¢„å…ˆå°†æ‰€æœ‰å†…å®¹åŠ è½½åˆ°RAMä¸­ï¼Œå®ƒå…è®¸æ‚¨å¤„ç†æ¯”å¯ç”¨RAMæ›´å¤§çš„æ•°æ®é›†ã€‚
- en: 'To lazily read a Parquet file, use the [`scan_parquet`](https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.scan_parquet.html)
    function instead. Then, execute the entire query with the [`collect`](https://pola-rs.github.io/polars/py-polars/html/reference/lazyframe/api/polars.LazyFrame.collect.html)
    function:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: è¦æƒ°æ€§åœ°è¯»å–Parquetæ–‡ä»¶ï¼Œè¯·æ”¹ç”¨[`scan_parquet`](https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.scan_parquet.html)å‡½æ•°ã€‚ç„¶åï¼Œä½¿ç”¨[`collect`](https://pola-rs.github.io/polars/py-polars/html/reference/lazyframe/api/polars.LazyFrame.collect.html)å‡½æ•°æ‰§è¡Œæ•´ä¸ªæŸ¥è¯¢ï¼š
- en: '[PRE3]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
