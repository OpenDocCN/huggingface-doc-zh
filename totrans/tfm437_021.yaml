- en: Causal language modeling
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å› æœè¯­è¨€å»ºæ¨¡
- en: 'Original text: [https://huggingface.co/docs/transformers/v4.37.2/en/tasks/language_modeling](https://huggingface.co/docs/transformers/v4.37.2/en/tasks/language_modeling)'
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸå§‹æ–‡æœ¬ï¼š[https://huggingface.co/docs/transformers/v4.37.2/en/tasks/language_modeling](https://huggingface.co/docs/transformers/v4.37.2/en/tasks/language_modeling)
- en: null
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: There are two types of language modeling, causal and masked. This guide illustrates
    causal language modeling. Causal language models are frequently used for text
    generation. You can use these models for creative applications like choosing your
    own text adventure or an intelligent coding assistant like Copilot or CodeParrot.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: è¯­è¨€å»ºæ¨¡æœ‰ä¸¤ç§ç±»å‹ï¼Œå› æœå’Œæ©ç ã€‚æœ¬æŒ‡å—è¯´æ˜äº†å› æœè¯­è¨€å»ºæ¨¡ã€‚å› æœè¯­è¨€æ¨¡å‹ç»å¸¸ç”¨äºæ–‡æœ¬ç”Ÿæˆã€‚æ‚¨å¯ä»¥å°†è¿™äº›æ¨¡å‹ç”¨äºåˆ›æ„åº”ç”¨ï¼Œå¦‚é€‰æ‹©è‡ªå·±çš„æ–‡æœ¬å†’é™©æˆ–æ™ºèƒ½ç¼–ç åŠ©æ‰‹ï¼Œå¦‚Copilotæˆ–CodeParrotã€‚
- en: '[https://www.youtube-nocookie.com/embed/Vpjb1lu0MDk](https://www.youtube-nocookie.com/embed/Vpjb1lu0MDk)'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.youtube-nocookie.com/embed/Vpjb1lu0MDk](https://www.youtube-nocookie.com/embed/Vpjb1lu0MDk)'
- en: Causal language modeling predicts the next token in a sequence of tokens, and
    the model can only attend to tokens on the left. This means the model cannot see
    future tokens. GPT-2 is an example of a causal language model.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: å› æœè¯­è¨€å»ºæ¨¡é¢„æµ‹ä»¤ç‰Œåºåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªä»¤ç‰Œï¼Œæ¨¡å‹åªèƒ½å…³æ³¨å·¦ä¾§çš„ä»¤ç‰Œã€‚è¿™æ„å‘³ç€æ¨¡å‹æ— æ³•çœ‹åˆ°æœªæ¥çš„ä»¤ç‰Œã€‚GPT-2æ˜¯å› æœè¯­è¨€æ¨¡å‹çš„ä¸€ä¸ªä¾‹å­ã€‚
- en: 'This guide will show you how to:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬æŒ‡å—å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ï¼š
- en: Finetune [DistilGPT2](https://huggingface.co/distilgpt2) on the [r/askscience](https://www.reddit.com/r/askscience/)
    subset of the [ELI5](https://huggingface.co/datasets/eli5) dataset.
  id: totrans-7
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åœ¨[ELI5](https://huggingface.co/datasets/eli5)æ•°æ®é›†çš„[r/askscience](https://www.reddit.com/r/askscience/)å­é›†ä¸Šå¾®è°ƒ[DistilGPT2](https://huggingface.co/distilgpt2)ã€‚
- en: Use your finetuned model for inference.
  id: totrans-8
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨æ‚¨å¾®è°ƒçš„æ¨¡å‹è¿›è¡Œæ¨ç†ã€‚
- en: 'You can finetune other architectures for causal language modeling following
    the same steps in this guide. Choose one of the following architectures:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: æ‚¨å¯ä»¥æŒ‰ç…§æœ¬æŒ‡å—ä¸­çš„ç›¸åŒæ­¥éª¤å¾®è°ƒå…¶ä»–æ¶æ„ä»¥è¿›è¡Œå› æœè¯­è¨€å»ºæ¨¡ã€‚é€‰æ‹©ä»¥ä¸‹æ¶æ„ä¹‹ä¸€ï¼š
- en: '[BART](../model_doc/bart), [BERT](../model_doc/bert), [Bert Generation](../model_doc/bert-generation),
    [BigBird](../model_doc/big_bird), [BigBird-Pegasus](../model_doc/bigbird_pegasus),
    [BioGpt](../model_doc/biogpt), [Blenderbot](../model_doc/blenderbot), [BlenderbotSmall](../model_doc/blenderbot-small),
    [BLOOM](../model_doc/bloom), [CamemBERT](../model_doc/camembert), [CodeLlama](../model_doc/code_llama),
    [CodeGen](../model_doc/codegen), [CPM-Ant](../model_doc/cpmant), [CTRL](../model_doc/ctrl),
    [Data2VecText](../model_doc/data2vec-text), [ELECTRA](../model_doc/electra), [ERNIE](../model_doc/ernie),
    [Falcon](../model_doc/falcon), [Fuyu](../model_doc/fuyu), [GIT](../model_doc/git),
    [GPT-Sw3](../model_doc/gpt-sw3), [OpenAI GPT-2](../model_doc/gpt2), [GPTBigCode](../model_doc/gpt_bigcode),
    [GPT Neo](../model_doc/gpt_neo), [GPT NeoX](../model_doc/gpt_neox), [GPT NeoX
    Japanese](../model_doc/gpt_neox_japanese), [GPT-J](../model_doc/gptj), [LLaMA](../model_doc/llama),
    [Marian](../model_doc/marian), [mBART](../model_doc/mbart), [MEGA](../model_doc/mega),
    [Megatron-BERT](../model_doc/megatron-bert), [Mistral](../model_doc/mistral),
    [Mixtral](../model_doc/mixtral), [MPT](../model_doc/mpt), [MusicGen](../model_doc/musicgen),
    [MVP](../model_doc/mvp), [OpenLlama](../model_doc/open-llama), [OpenAI GPT](../model_doc/openai-gpt),
    [OPT](../model_doc/opt), [Pegasus](../model_doc/pegasus), [Persimmon](../model_doc/persimmon),
    [Phi](../model_doc/phi), [PLBart](../model_doc/plbart), [ProphetNet](../model_doc/prophetnet),
    [QDQBert](../model_doc/qdqbert), [Qwen2](../model_doc/qwen2), [Reformer](../model_doc/reformer),
    [RemBERT](../model_doc/rembert), [RoBERTa](../model_doc/roberta), [RoBERTa-PreLayerNorm](../model_doc/roberta-prelayernorm),
    [RoCBert](../model_doc/roc_bert), [RoFormer](../model_doc/roformer), [RWKV](../model_doc/rwkv),
    [Speech2Text2](../model_doc/speech_to_text_2), [Transformer-XL](../model_doc/transfo-xl),
    [TrOCR](../model_doc/trocr), [Whisper](../model_doc/whisper), [XGLM](../model_doc/xglm),
    [XLM](../model_doc/xlm), [XLM-ProphetNet](../model_doc/xlm-prophetnet), [XLM-RoBERTa](../model_doc/xlm-roberta),
    [XLM-RoBERTa-XL](../model_doc/xlm-roberta-xl), [XLNet](../model_doc/xlnet), [X-MOD](../model_doc/xmod)'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '[BART](../model_doc/bart), [BERT](../model_doc/bert), [Bert Generation](../model_doc/bert-generation),
    [BigBird](../model_doc/big_bird), [BigBird-Pegasus](../model_doc/bigbird_pegasus),
    [BioGpt](../model_doc/biogpt), [Blenderbot](../model_doc/blenderbot), [BlenderbotSmall](../model_doc/blenderbot-small),
    [BLOOM](../model_doc/bloom), [CamemBERT](../model_doc/camembert), [CodeLlama](../model_doc/code_llama),
    [CodeGen](../model_doc/codegen), [CPM-Ant](../model_doc/cpmant), [CTRL](../model_doc/ctrl),
    [Data2VecText](../model_doc/data2vec-text), [ELECTRA](../model_doc/electra), [ERNIE](../model_doc/ernie),
    [Falcon](../model_doc/falcon), [Fuyu](../model_doc/fuyu), [GIT](../model_doc/git),
    [GPT-Sw3](../model_doc/gpt-sw3), [OpenAI GPT-2](../model_doc/gpt2), [GPTBigCode](../model_doc/gpt_bigcode),
    [GPT Neo](../model_doc/gpt_neo), [GPT NeoX](../model_doc/gpt_neox), [GPT NeoX
    Japanese](../model_doc/gpt_neox_japanese), [GPT-J](../model_doc/gptj), [LLaMA](../model_doc/llama),
    [Marian](../model_doc/marian), [mBART](../model_doc/mbart), [MEGA](../model_doc/mega),
    [Megatron-BERT](../model_doc/megatron-bert), [Mistral](../model_doc/mistral),
    [Mixtral](../model_doc/mixtral), [MPT](../model_doc/mpt), [MusicGen](../model_doc/musicgen),
    [MVP](../model_doc/mvp), [OpenLlama](../model_doc/open-llama), [OpenAI GPT](../model_doc/openai-gpt),
    [OPT](../model_doc/opt), [Pegasus](../model_doc/pegasus), [Persimmon](../model_doc/persimmon),
    [Phi](../model_doc/phi), [PLBart](../model_doc/plbart), [ProphetNet](../model_doc/prophetnet),
    [QDQBert](../model_doc/qdqbert), [Qwen2](../model_doc/qwen2), [Reformer](../model_doc/reformer),
    [RemBERT](../model_doc/rembert), [RoBERTa](../model_doc/roberta), [RoBERTa-PreLayerNorm](../model_doc/roberta-prelayernorm),
    [RoCBert](../model_doc/roc_bert), [RoFormer](../model_doc/roformer), [RWKV](../model_doc/rwkv),
    [Speech2Text2](../model_doc/speech_to_text_2), [Transformer-XL](../model_doc/transfo-xl),
    [TrOCR](../model_doc/trocr), [Whisper](../model_doc/whisper), [XGLM](../model_doc/xglm),
    [XLM](../model_doc/xlm), [XLM-ProphetNet](../model_doc/xlm-prophetnet), [XLM-RoBERTa](../model_doc/xlm-roberta),
    [XLM-RoBERTa-XL](../model_doc/xlm-roberta-xl), [XLNet](../model_doc/xlnet), [X-MOD](../model_doc/xmod)'
- en: 'Before you begin, make sure you have all the necessary libraries installed:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨å·²å®‰è£…æ‰€æœ‰å¿…è¦çš„åº“ã€‚
- en: '[PRE0]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'We encourage you to log in to your Hugging Face account so you can upload and
    share your model with the community. When prompted, enter your token to log in:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬é¼“åŠ±æ‚¨ç™»å½•æ‚¨çš„Hugging Faceå¸æˆ·ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥ä¸Šä¼ å’Œä¸ç¤¾åŒºåˆ†äº«æ‚¨çš„æ¨¡å‹ã€‚åœ¨æç¤ºæ—¶ï¼Œè¾“å…¥æ‚¨çš„ä»¤ç‰Œä»¥ç™»å½•ï¼š
- en: '[PRE1]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Load ELI5 dataset
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åŠ è½½ELI5æ•°æ®é›†
- en: Start by loading a smaller subset of the r/askscience subset of the ELI5 dataset
    from the ğŸ¤— Datasets library. Thisâ€™ll give you a chance to experiment and make
    sure everything works before spending more time training on the full dataset.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆåŠ è½½ğŸ¤—æ•°æ®é›†åº“ä¸­r/askscienceå­é›†çš„ELI5æ•°æ®é›†çš„è¾ƒå°å­é›†ã€‚è¿™å°†è®©æ‚¨æœ‰æœºä¼šè¿›è¡Œå®éªŒï¼Œå¹¶ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ï¼Œç„¶åå†èŠ±æ›´å¤šæ—¶é—´åœ¨å®Œæ•´æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒã€‚
- en: '[PRE2]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Split the datasetâ€™s `train_asks` split into a train and test set with the [train_test_split](https://huggingface.co/docs/datasets/v2.16.1/en/package_reference/main_classes#datasets.Dataset.train_test_split)
    method:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨[train_test_split](https://huggingface.co/docs/datasets/v2.16.1/en/package_reference/main_classes#datasets.Dataset.train_test_split)æ–¹æ³•å°†æ•°æ®é›†çš„`train_asks`æ‹†åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼š
- en: '[PRE3]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Then take a look at an example:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åçœ‹ä¸€ä¸ªä¾‹å­ï¼š
- en: '[PRE4]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: While this may look like a lot, youâ€™re only really interested in the `text`
    field. Whatâ€™s cool about language modeling tasks is you donâ€™t need labels (also
    known as an unsupervised task) because the next word *is* the label.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: è™½ç„¶è¿™çœ‹èµ·æ¥å¾ˆå¤šï¼Œä½†æ‚¨å®é™…ä¸Šåªå¯¹`text`å­—æ®µæ„Ÿå…´è¶£ã€‚è¯­è¨€å»ºæ¨¡ä»»åŠ¡çš„æœ‰è¶£ä¹‹å¤„åœ¨äºæ‚¨ä¸éœ€è¦æ ‡ç­¾ï¼ˆä¹Ÿç§°ä¸ºæ— ç›‘ç£ä»»åŠ¡ï¼‰ï¼Œå› ä¸ºä¸‹ä¸€ä¸ªè¯*å°±æ˜¯*æ ‡ç­¾ã€‚
- en: Preprocess
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é¢„å¤„ç†
- en: '[https://www.youtube-nocookie.com/embed/ma1TrR7gE7I](https://www.youtube-nocookie.com/embed/ma1TrR7gE7I)'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.youtube-nocookie.com/embed/ma1TrR7gE7I](https://www.youtube-nocookie.com/embed/ma1TrR7gE7I)'
- en: 'The next step is to load a DistilGPT2 tokenizer to process the `text` subfield:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹ä¸€æ­¥æ˜¯åŠ è½½ä¸€ä¸ªDistilGPT2åˆ†è¯å™¨æ¥å¤„ç†`text`å­å­—æ®µï¼š
- en: '[PRE5]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Youâ€™ll notice from the example above, the `text` field is actually nested inside
    `answers`. This means youâ€™ll need to extract the `text` subfield from its nested
    structure with the [`flatten`](https://huggingface.co/docs/datasets/process#flatten)
    method:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: ä»ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°`text`å­—æ®µå®é™…ä¸Šæ˜¯åµŒå¥—åœ¨`answers`ä¸­çš„ã€‚è¿™æ„å‘³ç€æ‚¨éœ€è¦ä½¿ç”¨[`flatten`](https://huggingface.co/docs/datasets/process#flatten)æ–¹æ³•ä»å…¶åµŒå¥—ç»“æ„ä¸­æå–`text`å­å­—æ®µï¼š
- en: '[PRE6]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Each subfield is now a separate column as indicated by the `answers` prefix,
    and the `text` field is a list now. Instead of tokenizing each sentence separately,
    convert the list to a string so you can jointly tokenize them.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæ¯ä¸ªå­å­—æ®µéƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„åˆ—ï¼Œç”±`answers`å‰ç¼€æŒ‡ç¤ºï¼Œè€Œ`text`å­—æ®µç°åœ¨æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚ä¸è¦å•ç‹¬å¯¹æ¯ä¸ªå¥å­è¿›è¡Œåˆ†è¯ï¼Œè€Œæ˜¯å°†åˆ—è¡¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä»¥ä¾¿å¯ä»¥è”åˆå¯¹å®ƒä»¬è¿›è¡Œåˆ†è¯ã€‚
- en: 'Here is a first preprocessing function to join the list of strings for each
    example and tokenize the result:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªç”¨äºè¿æ¥æ¯ä¸ªç¤ºä¾‹çš„å­—ç¬¦ä¸²åˆ—è¡¨å¹¶å¯¹ç»“æœè¿›è¡Œåˆ†è¯çš„ç¬¬ä¸€ä¸ªé¢„å¤„ç†å‡½æ•°ï¼š
- en: '[PRE7]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'To apply this preprocessing function over the entire dataset, use the ğŸ¤— Datasets
    [map](https://huggingface.co/docs/datasets/v2.16.1/en/package_reference/main_classes#datasets.Dataset.map)
    method. You can speed up the `map` function by setting `batched=True` to process
    multiple elements of the dataset at once, and increasing the number of processes
    with `num_proc`. Remove any columns you donâ€™t need:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: è¦åœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šåº”ç”¨æ­¤é¢„å¤„ç†å‡½æ•°ï¼Œè¯·ä½¿ç”¨ğŸ¤—æ•°æ®é›†çš„[map](https://huggingface.co/docs/datasets/v2.16.1/en/package_reference/main_classes#datasets.Dataset.map)æ–¹æ³•ã€‚é€šè¿‡è®¾ç½®`batched=True`ä»¥ä¸€æ¬¡å¤„ç†æ•°æ®é›†çš„å¤šä¸ªå…ƒç´ ï¼Œå¹¶ä½¿ç”¨`num_proc`å¢åŠ è¿›ç¨‹æ•°é‡ï¼Œå¯ä»¥åŠ å¿«`map`å‡½æ•°çš„é€Ÿåº¦ã€‚åˆ é™¤æ‚¨ä¸éœ€è¦çš„ä»»ä½•åˆ—ï¼š
- en: '[PRE8]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: This dataset contains the token sequences, but some of these are longer than
    the maximum input length for the model.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: è¯¥æ•°æ®é›†åŒ…å«ä»¤ç‰Œåºåˆ—ï¼Œä½†å…¶ä¸­ä¸€äº›æ¯”æ¨¡å‹çš„æœ€å¤§è¾“å…¥é•¿åº¦æ›´é•¿ã€‚
- en: You can now use a second preprocessing function to
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨å¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªé¢„å¤„ç†å‡½æ•°
- en: concatenate all the sequences
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿æ¥æ‰€æœ‰åºåˆ—
- en: split the concatenated sequences into shorter chunks defined by `block_size`,
    which should be both shorter than the maximum input length and short enough for
    your GPU RAM.
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å°†è¿æ¥çš„åºåˆ—æ‹†åˆ†ä¸ºç”±`block_size`å®šä¹‰çš„è¾ƒçŸ­å—ï¼Œè¯¥å—åº”æ¯”æœ€å¤§è¾“å…¥é•¿åº¦çŸ­ä¸”è¶³å¤ŸçŸ­ä»¥é€‚åº”æ‚¨çš„GPU RAMã€‚
- en: '[PRE9]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Apply the `group_texts` function over the entire dataset:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šåº”ç”¨`group_texts`å‡½æ•°ï¼š
- en: '[PRE10]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Now create a batch of examples using [DataCollatorForLanguageModeling](/docs/transformers/v4.37.2/en/main_classes/data_collator#transformers.DataCollatorForLanguageModeling).
    Itâ€™s more efficient to *dynamically pad* the sentences to the longest length in
    a batch during collation, instead of padding the whole dataset to the maximum
    length.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ä½¿ç”¨[DataCollatorForLanguageModeling](/docs/transformers/v4.37.2/en/main_classes/data_collator#transformers.DataCollatorForLanguageModeling)åˆ›å»ºä¸€æ‰¹ç¤ºä¾‹ã€‚åœ¨æ•´ç†è¿‡ç¨‹ä¸­ï¼Œå°†å¥å­åŠ¨æ€å¡«å……åˆ°æ‰¹æ¬¡ä¸­çš„æœ€é•¿é•¿åº¦ï¼Œè€Œä¸æ˜¯å°†æ•´ä¸ªæ•°æ®é›†å¡«å……åˆ°æœ€å¤§é•¿åº¦ã€‚
- en: PytorchHide Pytorch content
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: Pytorchéšè—Pytorchå†…å®¹
- en: 'Use the end-of-sequence token as the padding token and set `mlm=False`. This
    will use the inputs as labels shifted to the right by one element:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ç»“æŸåºåˆ—æ ‡è®°ä½œä¸ºå¡«å……æ ‡è®°ï¼Œå¹¶è®¾ç½®`mlm=False`ã€‚è¿™å°†ä½¿ç”¨è¾“å…¥ä½œä¸ºæ ‡ç­¾ï¼Œå‘å³ç§»åŠ¨ä¸€ä¸ªå…ƒç´ ï¼š
- en: '[PRE11]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: TensorFlowHide TensorFlow content
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: TensorFlowéšè—TensorFlowå†…å®¹
- en: 'Use the end-of-sequence token as the padding token and set `mlm=False`. This
    will use the inputs as labels shifted to the right by one element:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ç»“æŸåºåˆ—æ ‡è®°ä½œä¸ºå¡«å……æ ‡è®°ï¼Œå¹¶è®¾ç½®`mlm=False`ã€‚è¿™å°†ä½¿ç”¨è¾“å…¥ä½œä¸ºæ ‡ç­¾ï¼Œå‘å³ç§»åŠ¨ä¸€ä¸ªå…ƒç´ ï¼š
- en: '[PRE12]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Train
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®­ç»ƒ
- en: PytorchHide Pytorch content
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: Pytorchéšè—Pytorchå†…å®¹
- en: If you arenâ€™t familiar with finetuning a model with the [Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer),
    take a look at the [basic tutorial](../training#train-with-pytorch-trainer)!
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰ä½¿ç”¨[Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)å¾®è°ƒæ¨¡å‹ï¼Œè¯·æŸ¥çœ‹[åŸºæœ¬æ•™ç¨‹](../training#train-with-pytorch-trainer)!
- en: 'Youâ€™re ready to start training your model now! Load DistilGPT2 with [AutoModelForCausalLM](/docs/transformers/v4.37.2/en/model_doc/auto#transformers.AutoModelForCausalLM):'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: æ‚¨ç°åœ¨å¯ä»¥å¼€å§‹è®­ç»ƒæ¨¡å‹äº†ï¼ä½¿ç”¨[AutoModelForCausalLM](/docs/transformers/v4.37.2/en/model_doc/auto#transformers.AutoModelForCausalLM)åŠ è½½DistilGPT2ï¼š
- en: '[PRE13]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'At this point, only three steps remain:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤æ—¶ï¼Œåªå‰©ä¸‹ä¸‰ä¸ªæ­¥éª¤ï¼š
- en: Define your training hyperparameters in [TrainingArguments](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.TrainingArguments).
    The only required parameter is `output_dir` which specifies where to save your
    model. Youâ€™ll push this model to the Hub by setting `push_to_hub=True` (you need
    to be signed in to Hugging Face to upload your model).
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åœ¨[TrainingArguments](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.TrainingArguments)ä¸­å®šä¹‰æ‚¨çš„è®­ç»ƒè¶…å‚æ•°ã€‚å”¯ä¸€å¿…éœ€çš„å‚æ•°æ˜¯`output_dir`ï¼ŒæŒ‡å®šä¿å­˜æ¨¡å‹çš„ä½ç½®ã€‚é€šè¿‡è®¾ç½®`push_to_hub=True`å°†æ­¤æ¨¡å‹æ¨é€åˆ°Hubï¼ˆæ‚¨éœ€è¦ç™»å½•Hugging
    Faceæ‰èƒ½ä¸Šä¼ æ¨¡å‹ï¼‰ã€‚
- en: Pass the training arguments to [Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)
    along with the model, datasets, and data collator.
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å°†è®­ç»ƒå‚æ•°ä¼ é€’ç»™[Trainer](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer)ï¼Œä»¥åŠæ¨¡å‹ã€æ•°æ®é›†å’Œæ•°æ®æ•´ç†å™¨ã€‚
- en: Call [train()](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer.train)
    to finetune your model.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: è°ƒç”¨[train()](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer.train)æ¥å¾®è°ƒæ‚¨çš„æ¨¡å‹ã€‚
- en: '[PRE14]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Once training is completed, use the [evaluate()](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer.evaluate)
    method to evaluate your model and get its perplexity:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: è®­ç»ƒå®Œæˆåï¼Œä½¿ç”¨[evaluate()](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer.evaluate)æ–¹æ³•è¯„ä¼°æ‚¨çš„æ¨¡å‹å¹¶è·å–å…¶å›°æƒ‘åº¦ï¼š
- en: '[PRE15]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Then share your model to the Hub with the [push_to_hub()](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer.push_to_hub)
    method so everyone can use your model:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åä½¿ç”¨[push_to_hub()](/docs/transformers/v4.37.2/en/main_classes/trainer#transformers.Trainer.push_to_hub)æ–¹æ³•å°†æ‚¨çš„æ¨¡å‹åˆ†äº«åˆ°Hubï¼Œè¿™æ ·æ¯ä¸ªäººéƒ½å¯ä»¥ä½¿ç”¨æ‚¨çš„æ¨¡å‹ï¼š
- en: '[PRE16]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: TensorFlowHide TensorFlow content
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: TensorFlowéšè— TensorFlowå†…å®¹
- en: If you arenâ€™t familiar with finetuning a model with Keras, take a look at the
    [basic tutorial](../training#train-a-tensorflow-model-with-keras)!
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰å¦‚ä½•ä½¿ç”¨Keraså¾®è°ƒæ¨¡å‹ï¼Œè¯·æŸ¥çœ‹[åŸºç¡€æ•™ç¨‹](../training#train-a-tensorflow-model-with-keras)ï¼
- en: 'To finetune a model in TensorFlow, start by setting up an optimizer function,
    learning rate schedule, and some training hyperparameters:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: è¦åœ¨TensorFlowä¸­å¾®è°ƒæ¨¡å‹ï¼Œè¯·é¦–å…ˆè®¾ç½®ä¼˜åŒ–å™¨å‡½æ•°ã€å­¦ä¹ ç‡è°ƒåº¦å’Œä¸€äº›è®­ç»ƒè¶…å‚æ•°ï¼š
- en: '[PRE17]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Then you can load DistilGPT2 with [TFAutoModelForCausalLM](/docs/transformers/v4.37.2/en/model_doc/auto#transformers.TFAutoModelForCausalLM):'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨[TFAutoModelForCausalLM](/docs/transformers/v4.37.2/en/model_doc/auto#transformers.TFAutoModelForCausalLM)åŠ è½½DistilGPT2ï¼š
- en: '[PRE18]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Convert your datasets to the `tf.data.Dataset` format with [prepare_tf_dataset()](/docs/transformers/v4.37.2/en/main_classes/model#transformers.TFPreTrainedModel.prepare_tf_dataset):'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨[prepare_tf_dataset()](/docs/transformers/v4.37.2/en/main_classes/model#transformers.TFPreTrainedModel.prepare_tf_dataset)å°†æ•°æ®é›†è½¬æ¢ä¸º`tf.data.Dataset`æ ¼å¼ï¼š
- en: '[PRE19]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Configure the model for training with [`compile`](https://keras.io/api/models/model_training_apis/#compile-method).
    Note that Transformers models all have a default task-relevant loss function,
    so you donâ€™t need to specify one unless you want to:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨[`compile`](https://keras.io/api/models/model_training_apis/#compile-method)ä¸ºè®­ç»ƒé…ç½®æ¨¡å‹ã€‚è¯·æ³¨æ„ï¼ŒTransformersæ¨¡å‹éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„ä¸ä»»åŠ¡ç›¸å…³çš„æŸå¤±å‡½æ•°ï¼Œå› æ­¤é™¤éæ‚¨æƒ³è¦æŒ‡å®šä¸€ä¸ªï¼Œå¦åˆ™ä¸éœ€è¦ï¼š
- en: '[PRE20]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'This can be done by specifying where to push your model and tokenizer in the
    [PushToHubCallback](/docs/transformers/v4.37.2/en/main_classes/keras_callbacks#transformers.PushToHubCallback):'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å¯ä»¥é€šè¿‡åœ¨[PushToHubCallback](/docs/transformers/v4.37.2/en/main_classes/keras_callbacks#transformers.PushToHubCallback)ä¸­æŒ‡å®šå°†æ¨¡å‹å’Œæ ‡è®°å™¨æ¨é€åˆ°ä½•å¤„æ¥å®Œæˆï¼š
- en: '[PRE21]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Finally, youâ€™re ready to start training your model! Call [`fit`](https://keras.io/api/models/model_training_apis/#fit-method)
    with your training and validation datasets, the number of epochs, and your callback
    to finetune the model:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œæ‚¨å·²ç»å‡†å¤‡å¥½å¼€å§‹è®­ç»ƒæ‚¨çš„æ¨¡å‹äº†ï¼ä½¿ç”¨[`fit`](https://keras.io/api/models/model_training_apis/#fit-method)è°ƒç”¨æ‚¨çš„è®­ç»ƒå’ŒéªŒè¯æ•°æ®é›†ï¼Œæ—¶ä»£æ•°é‡ä»¥åŠå¾®è°ƒæ¨¡å‹çš„å›è°ƒï¼š
- en: '[PRE22]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Once training is completed, your model is automatically uploaded to the Hub
    so everyone can use it!
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: è®­ç»ƒå®Œæˆåï¼Œæ‚¨çš„æ¨¡å‹ä¼šè‡ªåŠ¨ä¸Šä¼ åˆ°Hubï¼Œè¿™æ ·æ¯ä¸ªäººéƒ½å¯ä»¥ä½¿ç”¨å®ƒï¼
- en: For a more in-depth example of how to finetune a model for causal language modeling,
    take a look at the corresponding [PyTorch notebook](https://colab.research.google.com/github/huggingface/notebooks/blob/main/examples/language_modeling.ipynb)
    or [TensorFlow notebook](https://colab.research.google.com/github/huggingface/notebooks/blob/main/examples/language_modeling-tf.ipynb).
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰å…³å¦‚ä½•ä¸ºå› æœè¯­è¨€å»ºæ¨¡å¾®è°ƒæ¨¡å‹çš„æ›´æ·±å…¥ç¤ºä¾‹ï¼Œè¯·æŸ¥çœ‹ç›¸åº”çš„[PyTorchç¬”è®°æœ¬](https://colab.research.google.com/github/huggingface/notebooks/blob/main/examples/language_modeling.ipynb)æˆ–[TensorFlowç¬”è®°æœ¬](https://colab.research.google.com/github/huggingface/notebooks/blob/main/examples/language_modeling-tf.ipynb)ã€‚
- en: Inference
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ¨ç†
- en: Great, now that youâ€™ve finetuned a model, you can use it for inference!
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: å¾ˆå¥½ï¼Œç°åœ¨æ‚¨å·²ç»å¾®è°ƒäº†ä¸€ä¸ªæ¨¡å‹ï¼Œå¯ä»¥ç”¨äºæ¨ç†ï¼
- en: 'Come up with a prompt youâ€™d like to generate text from:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: æƒ³å‡ºä¸€ä¸ªæ‚¨æƒ³è¦ä»ä¸­ç”Ÿæˆæ–‡æœ¬çš„æç¤ºï¼š
- en: '[PRE23]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'The simplest way to try out your finetuned model for inference is to use it
    in a [pipeline()](/docs/transformers/v4.37.2/en/main_classes/pipelines#transformers.pipeline).
    Instantiate a `pipeline` for text generation with your model, and pass your text
    to it:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: å°è¯•ä½¿ç”¨[pipeline()](/docs/transformers/v4.37.2/en/main_classes/pipelines#transformers.pipeline)æ¥è¿›è¡Œæ¨ç†æ˜¯å°è¯•å¾®è°ƒæ¨¡å‹çš„æœ€ç®€å•æ–¹æ³•ã€‚å®ä¾‹åŒ–ä¸€ä¸ªç”¨äºæ–‡æœ¬ç”Ÿæˆçš„`pipeline`ï¼Œå¹¶å°†æ–‡æœ¬ä¼ é€’ç»™å®ƒï¼š
- en: '[PRE24]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: PytorchHide Pytorch content
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: Pytorchéšè— Pytorchå†…å®¹
- en: 'Tokenize the text and return the `input_ids` as PyTorch tensors:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹æ–‡æœ¬è¿›è¡Œæ ‡è®°åŒ–ï¼Œå¹¶å°†`input_ids`è¿”å›ä¸ºPyTorchå¼ é‡ï¼š
- en: '[PRE25]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Use the [generate()](/docs/transformers/v4.37.2/en/main_classes/text_generation#transformers.GenerationMixin.generate)
    method to generate text. For more details about the different text generation
    strategies and parameters for controlling generation, check out the [Text generation
    strategies](../generation_strategies) page.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨[generate()](/docs/transformers/v4.37.2/en/main_classes/text_generation#transformers.GenerationMixin.generate)æ–¹æ³•ç”Ÿæˆæ–‡æœ¬ã€‚æœ‰å…³ä¸åŒæ–‡æœ¬ç”Ÿæˆç­–ç•¥å’Œæ§åˆ¶ç”Ÿæˆçš„å‚æ•°çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹[æ–‡æœ¬ç”Ÿæˆç­–ç•¥](../generation_strategies)é¡µé¢ã€‚
- en: '[PRE26]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Decode the generated token ids back into text:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: å°†ç”Ÿæˆçš„æ ‡è®°IDè§£ç å›æ–‡æœ¬ï¼š
- en: '[PRE27]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: TensorFlowHide TensorFlow content
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: TensorFlowéšè— TensorFlowå†…å®¹
- en: 'Tokenize the text and return the `input_ids` as TensorFlow tensors:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹æ–‡æœ¬è¿›è¡Œæ ‡è®°åŒ–ï¼Œå¹¶å°†`input_ids`è¿”å›ä¸ºTensorFlowå¼ é‡ï¼š
- en: '[PRE28]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Use the [generate()](/docs/transformers/v4.37.2/en/main_classes/text_generation#transformers.TFGenerationMixin.generate)
    method to create the summarization. For more details about the different text
    generation strategies and parameters for controlling generation, check out the
    [Text generation strategies](../generation_strategies) page.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨[generate()](/docs/transformers/v4.37.2/en/main_classes/text_generation#transformers.TFGenerationMixin.generate)æ–¹æ³•åˆ›å»ºæ‘˜è¦ã€‚æœ‰å…³ä¸åŒæ–‡æœ¬ç”Ÿæˆç­–ç•¥å’Œæ§åˆ¶ç”Ÿæˆçš„å‚æ•°çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹[æ–‡æœ¬ç”Ÿæˆç­–ç•¥](../generation_strategies)é¡µé¢ã€‚
- en: '[PRE29]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Decode the generated token ids back into text:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: å°†ç”Ÿæˆçš„æ ‡è®°IDè§£ç å›æ–‡æœ¬ï¼š
- en: '[PRE30]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
