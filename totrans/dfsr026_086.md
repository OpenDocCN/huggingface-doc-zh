# OpenVINO

> åŸæ–‡é“¾æ¥ï¼š[https://huggingface.co/docs/diffusers/optimization/open_vino](https://huggingface.co/docs/diffusers/optimization/open_vino)

ğŸ¤— [Optimum](https://github.com/huggingface/optimum-intel)æä¾›äº†ä¸OpenVINOå…¼å®¹çš„ç¨³å®šæ‰©æ•£ç®¡é“ï¼Œå¯åœ¨å„ç§è‹±ç‰¹å°”å¤„ç†å™¨ä¸Šæ‰§è¡Œæ¨ç†ï¼ˆè¯·å‚é˜…æ”¯æŒè®¾å¤‡çš„[å®Œæ•´åˆ—è¡¨](https://docs.openvino.ai/latest/openvino_docs_OV_UG_supported_plugins_Supported_Devices.html)ï¼‰ã€‚

æ‚¨éœ€è¦å®‰è£…ğŸ¤— Optimum Intelï¼Œå¹¶ä½¿ç”¨`--upgrade-strategy eager`é€‰é¡¹æ¥ç¡®ä¿[`optimum-intel`](https://github.com/huggingface/optimum-intel)ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ï¼š

```py
pip install --upgrade-strategy eager optimum["openvino"]
```

æœ¬æŒ‡å—å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨OpenVINOä¸­çš„ç¨³å®šæ‰©æ•£å’Œç¨³å®šæ‰©æ•£XLï¼ˆSDXLï¼‰ç®¡é“ã€‚

## ç¨³å®šæ‰©æ•£

è¦åŠ è½½å’Œè¿è¡Œæ¨ç†ï¼Œè¯·ä½¿ç”¨`OVStableDiffusionPipeline`ã€‚å¦‚æœæ‚¨æƒ³åŠ è½½ä¸€ä¸ªPyTorchæ¨¡å‹å¹¶å°†å…¶å³æ—¶è½¬æ¢ä¸ºOpenVINOæ ¼å¼ï¼Œè¯·è®¾ç½®`export=True`ï¼š

```py
from optimum.intel import OVStableDiffusionPipeline

model_id = "runwayml/stable-diffusion-v1-5"
pipeline = OVStableDiffusionPipeline.from_pretrained(model_id, export=True)
prompt = "sailing ship in storm by Rembrandt"
image = pipeline(prompt).images[0]

# Don't forget to save the exported model
pipeline.save_pretrained("openvino-sd-v1-5")
```

ä¸ºäº†è¿›ä¸€æ­¥åŠ å¿«æ¨ç†é€Ÿåº¦ï¼Œè¯·é™æ€é‡å¡‘æ¨¡å‹ã€‚å¦‚æœæ‚¨æ›´æ”¹ä»»ä½•å‚æ•°ï¼Œå¦‚è¾“å‡ºé«˜åº¦æˆ–å®½åº¦ï¼Œæ‚¨å°†éœ€è¦å†æ¬¡é™æ€é‡å¡‘æ‚¨çš„æ¨¡å‹ã€‚

```py
# Define the shapes related to the inputs and desired outputs
batch_size, num_images, height, width = 1, 1, 512, 512

# Statically reshape the model
pipeline.reshape(batch_size, height, width, num_images)
# Compile the model before inference
pipeline.compile()

image = pipeline(
    prompt,
    height=height,
    width=width,
    num_images_per_prompt=num_images,
).images[0]
```

![](../Images/c891b691562157d71fc3b1359bbb0a05.png)

æ‚¨å¯ä»¥åœ¨ğŸ¤— Optimum [æ–‡æ¡£](https://huggingface.co/docs/optimum/intel/inference#stable-diffusion)ä¸­æ‰¾åˆ°æ›´å¤šç¤ºä¾‹ï¼Œç¨³å®šæ‰©æ•£æ”¯æŒæ–‡æœ¬åˆ°å›¾åƒã€å›¾åƒåˆ°å›¾åƒå’Œä¿®å¤ã€‚

## ç¨³å®šæ‰©æ•£XL

è¦åŠ è½½å’Œè¿è¡ŒSDXLæ¨ç†ï¼Œè¯·ä½¿ç”¨`OVStableDiffusionXLPipeline`ï¼š

```py
from optimum.intel import OVStableDiffusionXLPipeline

model_id = "stabilityai/stable-diffusion-xl-base-1.0"
pipeline = OVStableDiffusionXLPipeline.from_pretrained(model_id)
prompt = "sailing ship in storm by Rembrandt"
image = pipeline(prompt).images[0]
```

ä¸ºäº†è¿›ä¸€æ­¥åŠ å¿«æ¨ç†é€Ÿåº¦ï¼Œè¯·åœ¨ç¨³å®šæ‰©æ•£éƒ¨åˆ†ä¸­æŒ‰ç…§ç¤ºä¾‹[é™æ€é‡å¡‘](#stable-diffusion)æ¨¡å‹ã€‚

æ‚¨å¯ä»¥åœ¨ğŸ¤— Optimum [æ–‡æ¡£](https://huggingface.co/docs/optimum/intel/inference#stable-diffusion-xl)ä¸­æ‰¾åˆ°æ›´å¤šç¤ºä¾‹ï¼ŒOpenVINOä¸­æ”¯æŒè¿è¡ŒSDXLç”¨äºæ–‡æœ¬åˆ°å›¾åƒå’Œå›¾åƒåˆ°å›¾åƒã€‚
