# TRL - Transformer Reinforcement Learning

> åŸæ–‡ï¼š[https://huggingface.co/docs/trl/index](https://huggingface.co/docs/trl/index)

![](../Images/4b294f1850c2a0865587ccc36b23d404.png)

TRLæ˜¯ä¸€ä¸ªå…¨æ ˆåº“ï¼Œæˆ‘ä»¬æä¾›ä¸€å¥—å·¥å…·æ¥ä½¿ç”¨å¼ºåŒ–å­¦ä¹ è®­ç»ƒå˜å‹å™¨è¯­è¨€æ¨¡å‹ï¼Œä»ç›‘ç£å¾®è°ƒæ­¥éª¤ï¼ˆSFTï¼‰ã€å¥–åŠ±å»ºæ¨¡æ­¥éª¤ï¼ˆRMï¼‰åˆ°è¿‘ç«¯ç­–ç•¥ä¼˜åŒ–ï¼ˆPPOï¼‰æ­¥éª¤ã€‚è¯¥åº“ä¸ğŸ¤— [transformers](https://github.com/huggingface/transformers)é›†æˆã€‚

![](../Images/6bff4454a0be1455f1b3b09f74640ec7.png)

æ ¹æ®æ‚¨çš„éœ€æ±‚æŸ¥çœ‹æ–‡æ¡£ä¸­çš„é€‚å½“éƒ¨åˆ†ï¼š

## APIæ–‡æ¡£

+   [æ¨¡å‹ç±»](models): *æ¯ä¸ªå…¬å…±æ¨¡å‹ç±»çš„ç®€è¦æ¦‚è¿°*

+   [`SFTTrainer`](sft_trainer): *ä½¿ç”¨`SFTTrainer`è½»æ¾ç›‘ç£å¾®è°ƒæ‚¨çš„æ¨¡å‹*

+   [`RewardTrainer`](reward_trainer): *ä½¿ç”¨`RewardTrainer`è½»æ¾è®­ç»ƒæ‚¨çš„å¥–åŠ±æ¨¡å‹*

+   [`PPOTrainer`](ppo_trainer): *ä½¿ç”¨PPOç®—æ³•è¿›ä¸€æ­¥å¾®è°ƒç›‘ç£å¾®è°ƒçš„æ¨¡å‹*

+   [æœ€ä½³Né‡‡æ ·](best-of-n): *ä½¿ç”¨æœ€ä½³Né‡‡æ ·ä½œä¸ºä»æ´»è·ƒæ¨¡å‹ä¸­é‡‡æ ·é¢„æµ‹çš„æ›¿ä»£æ–¹å¼*

+   [`DPOTrainer`](dpo_trainer): *ä½¿ç”¨`DPOTrainer`è¿›è¡Œç›´æ¥åå¥½ä¼˜åŒ–è®­ç»ƒ*

+   [`TextEnvironment`](text_environment): *ä½¿ç”¨RLå·¥å…·è®­ç»ƒæ‚¨çš„æ¨¡å‹çš„æ–‡æœ¬ç¯å¢ƒ*

## ç¤ºä¾‹

+   [æƒ…æ„Ÿå¾®è°ƒ](sentiment_tuning): *å¾®è°ƒæ‚¨çš„æ¨¡å‹ä»¥ç”Ÿæˆç§¯æçš„ç”µå½±å†…å®¹*

+   [ä½¿ç”¨PEFTè¿›è¡Œè®­ç»ƒ](lora_tuning_peft): *ä½¿ç”¨PEFTå’Œé€‚é…å™¨è¿›è¡Œå†…å­˜é«˜æ•ˆçš„RLHFè®­ç»ƒ*

+   [å»æ¯’åŒ–LLMs](detoxifying_a_lm): *é€šè¿‡RLHFå»æ¯’åŒ–æ‚¨çš„è¯­è¨€æ¨¡å‹*

+   [ä½¿ç”¨Llamaæ¨¡å‹](using_llama_models): *åœ¨Stackäº¤æ¢æ•°æ®é›†ä¸Šè¿›è¡Œç«¯åˆ°ç«¯çš„RLHFè®­ç»ƒ*

+   [ä½¿ç”¨å·¥å…·è¿›è¡Œå­¦ä¹ ](learning_tools): *ä½¿ç”¨`TextEnvironments`çš„æ¼”ç»ƒ*

+   [å¤šé€‚é…å™¨è®­ç»ƒ](multi_adapter_rl): *ä½¿ç”¨å•ä¸ªåŸºç¡€æ¨¡å‹å’Œå¤šä¸ªé€‚é…å™¨è¿›è¡Œå†…å­˜é«˜æ•ˆçš„ç«¯åˆ°ç«¯è®­ç»ƒ*

## åšå®¢æ–‡ç« 

[![ç¼©ç•¥å›¾](../Images/6a5d903a4cb2b18948ab6f3db912185c.png)

ä»äººç±»åé¦ˆä¸­é˜é‡Šå¼ºåŒ–å­¦ä¹ ](https://huggingface.co/blog/rlhf) [![ç¼©ç•¥å›¾](../Images/22aa00200f429b7d9ce649b675e3f3b1.png)

åœ¨24GBæ¶ˆè´¹çº§GPUä¸Šä½¿ç”¨RLHFå¯¹20B LLMè¿›è¡Œå¾®è°ƒ](https://huggingface.co/blog/trl-peft) [![ç¼©ç•¥å›¾](../Images/c83a44cfb05cf6785db903a8231e5d59.png)

StackLLaMAï¼šä½¿ç”¨RLHFè¿›è¡ŒLLaMAçš„å®è·µæŒ‡å—](https://huggingface.co/blog/stackllama) [![ç¼©ç•¥å›¾](../Images/aca25811c595ffdf3eabce54f97a87d5.png)

ä½¿ç”¨DPOå¯¹Llama 2è¿›è¡Œå¾®è°ƒ](https://huggingface.co/blog/dpo-trl) [![ç¼©ç•¥å›¾](../Images/3aa727b1aa5caba1090533892ec9e378.png)

ä½¿ç”¨TRLé€šè¿‡DDPOå¾®è°ƒç¨³å®šæ‰©æ•£æ¨¡å‹](https://huggingface.co/blog/trl-ddpo)
