# DDPM

> åŸå§‹æ–‡æœ¬ï¼š[`huggingface.co/docs/diffusers/api/pipelines/ddpm`](https://huggingface.co/docs/diffusers/api/pipelines/ddpm)

ç”± Jonathan Hoã€Ajay Jain å’Œ Pieter Abbeel æå‡ºçš„[Denoising Diffusion Probabilistic Models](https://huggingface.co/papers/2006.11239)ï¼ˆDDPMï¼‰æå‡ºäº†åŒåçš„æ‰©æ•£æ¨¡å‹ã€‚åœ¨ğŸ¤— Diffusers åº“ä¸­ï¼ŒDDPM æŒ‡çš„æ˜¯è®ºæ–‡ä¸­çš„*ç¦»æ•£å»å™ªè°ƒåº¦å™¨*ä»¥åŠç®¡é“ã€‚

è®ºæ–‡æ‘˜è¦ä¸ºï¼š

*æˆ‘ä»¬ä½¿ç”¨æ‰©æ•£æ¦‚ç‡æ¨¡å‹å‘ˆç°é«˜è´¨é‡çš„å›¾åƒåˆæˆç»“æœï¼Œè¿™æ˜¯ä¸€ç±»å—éå¹³è¡¡çƒ­åŠ›å­¦è€ƒè™‘å¯å‘çš„æ½œå˜é‡æ¨¡å‹ã€‚æˆ‘ä»¬çš„æœ€ä½³ç»“æœæ˜¯é€šè¿‡æ ¹æ®æ‰©æ•£æ¦‚ç‡æ¨¡å‹å’Œ Langevin åŠ¨åŠ›å­¦çš„å»å™ªå¾—åˆ†åŒ¹é…ä¹‹é—´çš„æ–°é¢–è¿æ¥è®¾è®¡çš„åŠ æƒå˜åˆ†ç•Œé™è¿›è¡Œè®­ç»ƒè·å¾—çš„ï¼Œæˆ‘ä»¬çš„æ¨¡å‹è‡ªç„¶åœ°é‡‡ç”¨äº†ä¸€ç§æ¸è¿›çš„æœ‰æŸè§£å‹ç¼©æ–¹æ¡ˆï¼Œå¯ä»¥è§£é‡Šä¸ºè‡ªå›å½’è§£ç çš„ä¸€èˆ¬åŒ–ã€‚åœ¨æ— æ¡ä»¶çš„ CIFAR10 æ•°æ®é›†ä¸Šï¼Œæˆ‘ä»¬è·å¾—äº† 9.46 çš„ Inception åˆ†æ•°å’Œ 3.17 çš„æœ€å…ˆè¿›çš„ FID åˆ†æ•°ã€‚åœ¨ 256x256 çš„ LSUN ä¸Šï¼Œæˆ‘ä»¬è·å¾—äº†ç±»ä¼¼äº ProgressiveGAN çš„æ ·æœ¬è´¨é‡ã€‚*

åŸå§‹ä»£ç åº“å¯ä»¥åœ¨[hohonathanho/diffusion](https://github.com/hojonathanho/diffusion)æ‰¾åˆ°ã€‚

ç¡®ä¿æŸ¥çœ‹è°ƒåº¦å™¨æŒ‡å—ä»¥äº†è§£å¦‚ä½•æ¢ç´¢è°ƒåº¦å™¨é€Ÿåº¦å’Œè´¨é‡ä¹‹é—´çš„æƒè¡¡ï¼Œå¹¶æŸ¥çœ‹è·¨ç®¡é“é‡ç”¨ç»„ä»¶éƒ¨åˆ†ä»¥äº†è§£å¦‚ä½•æœ‰æ•ˆåœ°å°†ç›¸åŒç»„ä»¶åŠ è½½åˆ°å¤šä¸ªç®¡é“ä¸­ã€‚

# DDPMPipeline

### `class diffusers.DDPMPipeline`

[<æ¥æº>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/pipelines/ddpm/pipeline_ddpm.py#L24)

```py
( unet scheduler )
```

å‚æ•°

+   `unet`ï¼ˆUNet2DModelï¼‰â€” ç”¨äºå»å™ªç¼–ç å›¾åƒæ½œå˜é‡çš„`UNet2DModel`ã€‚

+   `scheduler`ï¼ˆSchedulerMixinï¼‰â€” ç”¨äºä¸`unet`ç»“åˆä½¿ç”¨çš„è°ƒåº¦å™¨ä»¥å»å™ªç¼–ç å›¾åƒã€‚å¯ä»¥æ˜¯ DDPMScheduler æˆ– DDIMScheduler ä¹‹ä¸€ã€‚

ç”¨äºå›¾åƒç”Ÿæˆçš„ç®¡é“ã€‚

è¿™ä¸ªæ¨¡å‹ç»§æ‰¿è‡ª DiffusionPipelineã€‚æ£€æŸ¥è¶…ç±»æ–‡æ¡£ä»¥äº†è§£ä¸ºæ‰€æœ‰ç®¡é“å®ç°çš„é€šç”¨æ–¹æ³•ï¼ˆä¸‹è½½ã€ä¿å­˜ã€åœ¨ç‰¹å®šè®¾å¤‡ä¸Šè¿è¡Œç­‰ï¼‰ã€‚

#### `__call__`

[<æ¥æº>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/pipelines/ddpm/pipeline_ddpm.py#L45)

```py
( batch_size: int = 1 generator: Union = None num_inference_steps: int = 1000 output_type: Optional = 'pil' return_dict: bool = True ) â†’ export const metadata = 'undefined';ImagePipelineOutput or tuple
```

å‚æ•°

+   `batch_size`ï¼ˆ`int`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º 1ï¼‰â€” è¦ç”Ÿæˆçš„å›¾åƒæ•°é‡ã€‚

+   `generator`ï¼ˆ`torch.Generator`ï¼Œ*å¯é€‰*ï¼‰â€” ç”¨äºä½¿ç”Ÿæˆå…·æœ‰ç¡®å®šæ€§çš„[`torch.Generator`](https://pytorch.org/docs/stable/generated/torch.Generator.html)ã€‚

+   `num_inference_steps`ï¼ˆ`int`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º 1000ï¼‰â€” å»å™ªæ­¥éª¤çš„æ•°é‡ã€‚æ›´å¤šçš„å»å™ªæ­¥éª¤é€šå¸¸ä¼šå¯¼è‡´æ›´é«˜è´¨é‡çš„å›¾åƒï¼Œä½†ä¼šé™ä½æ¨ç†é€Ÿåº¦ã€‚

+   `output_type`ï¼ˆ`str`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`"pil"`ï¼‰â€” ç”Ÿæˆå›¾åƒçš„è¾“å‡ºæ ¼å¼ã€‚é€‰æ‹©`PIL.Image`æˆ–`np.array`ä¹‹é—´çš„ä¸€ä¸ªã€‚

+   `return_dict`ï¼ˆ`bool`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`True`ï¼‰â€” æ˜¯å¦è¿”å› ImagePipelineOutput è€Œä¸æ˜¯æ™®é€šå…ƒç»„ã€‚

è¿”å›

ImagePipelineOutput æˆ–`tuple`

å¦‚æœ`return_dict`ä¸º`True`ï¼Œåˆ™è¿”å› ImagePipelineOutputï¼Œå¦åˆ™è¿”å›ä¸€ä¸ª`tuple`ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ç”Ÿæˆçš„å›¾åƒåˆ—è¡¨

ç”¨äºç”Ÿæˆçš„ç®¡é“çš„è°ƒç”¨å‡½æ•°ã€‚

ç¤ºä¾‹ï¼š

```py
>>> from diffusers import DDPMPipeline

>>> # load model and scheduler
>>> pipe = DDPMPipeline.from_pretrained("google/ddpm-cat-256")

>>> # run pipeline in inference (sample random noise and denoise)
>>> image = pipe().images[0]

>>> # save image
>>> image.save("ddpm_generated_image.png")
```

## ImagePipelineOutput

### `class diffusers.ImagePipelineOutput`

[<æ¥æº>](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/pipelines/pipeline_utils.py#L116)

```py
( images: Union )
```

å‚æ•°

+   `images` (`List[PIL.Image.Image]` æˆ– `np.ndarray`) â€” é•¿åº¦ä¸º `batch_size` çš„å»å™ª PIL å›¾åƒåˆ—è¡¨æˆ–å½¢çŠ¶ä¸º `(batch_size, height, width, num_channels)` çš„ NumPy æ•°ç»„ã€‚

å›¾åƒç®¡é“çš„è¾“å‡ºç±»ã€‚
