- en: Text-to-image
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ–‡æœ¬åˆ°å›¾åƒ
- en: 'Original text: [https://huggingface.co/docs/diffusers/using-diffusers/conditional_image_generation](https://huggingface.co/docs/diffusers/using-diffusers/conditional_image_generation)'
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸå§‹æ–‡æœ¬ï¼š[https://huggingface.co/docs/diffusers/using-diffusers/conditional_image_generation](https://huggingface.co/docs/diffusers/using-diffusers/conditional_image_generation)
- en: null
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: When you think of diffusion models, text-to-image is usually one of the first
    things that come to mind. Text-to-image generates an image from a text description
    (for example, â€œAstronaut in a jungle, cold color palette, muted colors, detailed,
    8kâ€) which is also known as a *prompt*.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: å½“è°ˆåˆ°æ‰©æ•£æ¨¡å‹æ—¶ï¼Œæ–‡æœ¬åˆ°å›¾åƒé€šå¸¸æ˜¯é¦–å…ˆæƒ³åˆ°çš„ã€‚æ–‡æœ¬åˆ°å›¾åƒä»æ–‡æœ¬æè¿°ï¼ˆä¾‹å¦‚ï¼Œâ€œå¤ªç©ºäººåœ¨ä¸›æ—ä¸­ï¼Œå†·è‰²è°ƒï¼ŒæŸ”å’Œçš„é¢œè‰²ï¼Œè¯¦ç»†ï¼Œ8kâ€ï¼‰ç”Ÿæˆå›¾åƒï¼Œè¿™ä¹Ÿè¢«ç§°ä¸º*æç¤º*ã€‚
- en: From a very high level, a diffusion model takes a prompt and some random initial
    noise, and iteratively removes the noise to construct an image. The *denoising*
    process is guided by the prompt, and once the denoising process ends after a predetermined
    number of time steps, the image representation is decoded into an image.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ä»ä¸€ä¸ªéå¸¸é«˜çš„å±‚é¢æ¥çœ‹ï¼Œæ‰©æ•£æ¨¡å‹æ¥å—ä¸€ä¸ªæç¤ºå’Œä¸€äº›éšæœºçš„åˆå§‹å™ªå£°ï¼Œå¹¶è¿­ä»£åœ°å»é™¤å™ªå£°ä»¥æ„å»ºå›¾åƒã€‚*å»å™ª*è¿‡ç¨‹ç”±æç¤ºå¼•å¯¼ï¼Œä¸€æ—¦å»å™ªè¿‡ç¨‹åœ¨é¢„å®šæ•°é‡çš„æ—¶é—´æ­¥éª¤ä¹‹åç»“æŸï¼Œå›¾åƒè¡¨ç¤ºå°†è¢«è§£ç æˆå›¾åƒã€‚
- en: Read the [How does Stable Diffusion work?](https://huggingface.co/blog/stable_diffusion#how-does-stable-diffusion-work)
    blog post to learn more about how a latent diffusion model works.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: é˜…è¯»[ç¨³å®šæ‰©æ•£æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ](https://huggingface.co/blog/stable_diffusion#how-does-stable-diffusion-work)åšæ–‡ï¼Œäº†è§£æ½œåœ¨æ‰©æ•£æ¨¡å‹çš„å·¥ä½œåŸç†ã€‚
- en: 'You can generate images from a prompt in ğŸ¤— Diffusers in two steps:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: æ‚¨å¯ä»¥åœ¨ğŸ¤— Diffusersä¸­é€šè¿‡ä¸¤ä¸ªæ­¥éª¤ä»æç¤ºç”Ÿæˆå›¾åƒï¼š
- en: 'Load a checkpoint into the [AutoPipelineForText2Image](/docs/diffusers/v0.26.3/en/api/pipelines/auto_pipeline#diffusers.AutoPipelineForText2Image)
    class, which automatically detects the appropriate pipeline class to use based
    on the checkpoint:'
  id: totrans-7
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å°†æ£€æŸ¥ç‚¹åŠ è½½åˆ°[AutoPipelineForText2Image](/docs/diffusers/v0.26.3/en/api/pipelines/auto_pipeline#diffusers.AutoPipelineForText2Image)ç±»ä¸­ï¼Œè¯¥ç±»ä¼šæ ¹æ®æ£€æŸ¥ç‚¹è‡ªåŠ¨æ£€æµ‹è¦ä½¿ç”¨çš„é€‚å½“ç®¡é“ç±»ï¼š
- en: '[PRE0]'
  id: totrans-8
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Pass a prompt to the pipeline to generate an image:'
  id: totrans-9
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å°†æç¤ºä¼ é€’ç»™ç®¡é“ä»¥ç”Ÿæˆå›¾åƒï¼š
- en: '[PRE1]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![](../Images/3d5a1c2477f576fbe2f04b0abeeb5cae.png)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3d5a1c2477f576fbe2f04b0abeeb5cae.png)'
- en: Popular models
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: çƒ­é—¨æ¨¡å‹
- en: The most common text-to-image models are [Stable Diffusion v1.5](https://huggingface.co/runwayml/stable-diffusion-v1-5),
    [Stable Diffusion XL (SDXL)](https://huggingface.co/stabilityai/stable-diffusion-xl-base-1.0),
    and [Kandinsky 2.2](https://huggingface.co/kandinsky-community/kandinsky-2-2-decoder).
    There are also ControlNet models or adapters that can be used with text-to-image
    models for more direct control in generating images. The results from each model
    are slightly different because of their architecture and training process, but
    no matter which model you choose, their usage is more or less the same. Letâ€™s
    use the same prompt for each model and compare their results.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€å¸¸è§çš„æ–‡æœ¬åˆ°å›¾åƒæ¨¡å‹æ˜¯[ç¨³å®šæ‰©æ•£ v1.5](https://huggingface.co/runwayml/stable-diffusion-v1-5)ã€[ç¨³å®šæ‰©æ•£
    XLï¼ˆSDXLï¼‰](https://huggingface.co/stabilityai/stable-diffusion-xl-base-1.0)å’Œ[åä¸æ–¯åŸº
    2.2](https://huggingface.co/kandinsky-community/kandinsky-2-2-decoder)ã€‚è¿˜æœ‰ControlNetæ¨¡å‹æˆ–é€‚é…å™¨ï¼Œå¯ä»¥ä¸æ–‡æœ¬åˆ°å›¾åƒæ¨¡å‹ä¸€èµ·ä½¿ç”¨ï¼Œä»¥æ›´ç›´æ¥åœ°æ§åˆ¶ç”Ÿæˆå›¾åƒã€‚ç”±äºå®ƒä»¬çš„æ¶æ„å’Œè®­ç»ƒè¿‡ç¨‹ä¸åŒï¼Œæ¯ä¸ªæ¨¡å‹çš„ç»“æœç•¥æœ‰ä¸åŒï¼Œä½†æ— è®ºé€‰æ‹©å“ªä¸ªæ¨¡å‹ï¼Œå®ƒä»¬çš„ä½¿ç”¨æ–¹å¼åŸºæœ¬ç›¸åŒã€‚è®©æˆ‘ä»¬ä¸ºæ¯ä¸ªæ¨¡å‹ä½¿ç”¨ç›¸åŒçš„æç¤ºå¹¶æ¯”è¾ƒå®ƒä»¬çš„ç»“æœã€‚
- en: Stable Diffusion v1.5
  id: totrans-14
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ç¨³å®šæ‰©æ•£ v1.5
- en: '[Stable Diffusion v1.5](https://huggingface.co/runwayml/stable-diffusion-v1-5)
    is a latent diffusion model initialized from [Stable Diffusion v1-4](https://huggingface.co/CompVis/stable-diffusion-v1-4),
    and finetuned for 595K steps on 512x512 images from the LAION-Aesthetics V2 dataset.
    You can use this model like:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '[ç¨³å®šæ‰©æ•£ v1.5](https://huggingface.co/runwayml/stable-diffusion-v1-5)æ˜¯ä¸€ä¸ªä»[ç¨³å®šæ‰©æ•£
    v1-4](https://huggingface.co/CompVis/stable-diffusion-v1-4)åˆå§‹åŒ–çš„æ½œåœ¨æ‰©æ•£æ¨¡å‹ï¼Œå¹¶åœ¨LAION-Aesthetics
    V2æ•°æ®é›†çš„512x512å›¾åƒä¸Šè¿›è¡Œäº†595Kæ­¥çš„å¾®è°ƒã€‚æ‚¨å¯ä»¥åƒè¿™æ ·ä½¿ç”¨è¿™ä¸ªæ¨¡å‹ï¼š'
- en: '[PRE2]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Stable Diffusion XL
  id: totrans-17
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ç¨³å®šæ‰©æ•£ XL
- en: 'SDXL is a much larger version of the previous Stable Diffusion models, and
    involves a two-stage model process that adds even more details to an image. It
    also includes some additional *micro-conditionings* to generate high-quality images
    centered subjects. Take a look at the more comprehensive [SDXL](sdxl) guide to
    learn more about how to use it. In general, you can use SDXL like:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: SDXLæ˜¯ä¹‹å‰ç¨³å®šæ‰©æ•£æ¨¡å‹çš„ä¸€ä¸ªæ›´å¤§ç‰ˆæœ¬ï¼Œæ¶‰åŠä¸€ä¸ªä¸¤é˜¶æ®µæ¨¡å‹è¿‡ç¨‹ï¼Œä¸ºå›¾åƒæ·»åŠ äº†æ›´å¤šç»†èŠ‚ã€‚å®ƒè¿˜åŒ…æ‹¬ä¸€äº›é¢å¤–çš„*å¾®è°ƒ*æ¥ç”Ÿæˆä»¥ä¸­å¿ƒä¸»é¢˜ä¸ºä¸­å¿ƒçš„é«˜è´¨é‡å›¾åƒã€‚æŸ¥çœ‹æ›´å…¨é¢çš„[SDXL](sdxl)æŒ‡å—ï¼Œäº†è§£å¦‚ä½•ä½¿ç”¨å®ƒã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ‚¨å¯ä»¥åƒè¿™æ ·ä½¿ç”¨SDXLï¼š
- en: '[PRE3]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Kandinsky 2.2
  id: totrans-20
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: åä¸æ–¯åŸº 2.2
- en: The Kandinsky model is a bit different from the Stable Diffusion models because
    it also uses an image prior model to create embeddings that are used to better
    align text and images in the diffusion model.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: åä¸æ–¯åŸºæ¨¡å‹ä¸ç¨³å®šæ‰©æ•£æ¨¡å‹æœ‰äº›ä¸åŒï¼Œå› ä¸ºå®ƒè¿˜ä½¿ç”¨å›¾åƒå…ˆéªŒæ¨¡å‹æ¥åˆ›å»ºåµŒå…¥ï¼Œè¿™äº›åµŒå…¥ç”¨äºæ›´å¥½åœ°å¯¹é½æ‰©æ•£æ¨¡å‹ä¸­çš„æ–‡æœ¬å’Œå›¾åƒã€‚
- en: 'The easiest way to use Kandinsky 2.2 is:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨åä¸æ–¯åŸº 2.2çš„æœ€ç®€å•æ–¹æ³•æ˜¯ï¼š
- en: '[PRE4]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: ControlNet
  id: totrans-24
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ControlNet
- en: ControlNet models are auxiliary models or adapters that are finetuned on top
    of text-to-image models, such as [Stable Diffusion v1.5](https://huggingface.co/runwayml/stable-diffusion-v1-5).
    Using ControlNet models in combination with text-to-image models offers diverse
    options for more explicit control over how to generate an image. With ControlNet,
    you add an additional conditioning input image to the model. For example, if you
    provide an image of a human pose (usually represented as multiple keypoints that
    are connected into a skeleton) as a conditioning input, the model generates an
    image that follows the pose of the image. Check out the more in-depth [ControlNet](controlnet)
    guide to learn more about other conditioning inputs and how to use them.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: ControlNetæ¨¡å‹æ˜¯è¾…åŠ©æ¨¡å‹æˆ–é€‚é…å™¨ï¼Œå®ƒä»¬åœ¨æ–‡æœ¬åˆ°å›¾åƒæ¨¡å‹çš„åŸºç¡€ä¸Šè¿›è¡Œå¾®è°ƒï¼Œä¾‹å¦‚[ç¨³å®šæ‰©æ•£ v1.5](https://huggingface.co/runwayml/stable-diffusion-v1-5)ã€‚å°†ControlNetæ¨¡å‹ä¸æ–‡æœ¬åˆ°å›¾åƒæ¨¡å‹ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥æä¾›æ›´å¤šæ˜ç¡®æ§åˆ¶ç”Ÿæˆå›¾åƒçš„é€‰é¡¹ã€‚ä½¿ç”¨ControlNetï¼Œæ‚¨å¯ä»¥å‘æ¨¡å‹æ·»åŠ é¢å¤–çš„æ¡ä»¶è¾“å…¥å›¾åƒã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æä¾›ä¸€ä¸ªäººä½“å§¿åŠ¿çš„å›¾åƒï¼ˆé€šå¸¸è¡¨ç¤ºä¸ºè¿æ¥æˆéª¨æ¶çš„å¤šä¸ªå…³é”®ç‚¹ï¼‰ä½œä¸ºæ¡ä»¶è¾“å…¥ï¼Œæ¨¡å‹å°†ç”Ÿæˆéµå¾ªå›¾åƒå§¿åŠ¿çš„å›¾åƒã€‚æŸ¥çœ‹æ›´è¯¦ç»†çš„[ControlNet](controlnet)æŒ‡å—ï¼Œäº†è§£å…¶ä»–æ¡ä»¶è¾“å…¥ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚
- en: 'In this example, letâ€™s condition the ControlNet with a human pose estimation
    image. Load the ControlNet model pretrained on human pose estimations:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè®©æˆ‘ä»¬ç”¨ä¸€ä¸ªäººä½“å§¿åŠ¿ä¼°è®¡å›¾åƒæ¥è°ƒèŠ‚ControlNetã€‚åŠ è½½é¢„è®­ç»ƒçš„ç”¨äºäººä½“å§¿åŠ¿ä¼°è®¡çš„ControlNetæ¨¡å‹ï¼š
- en: '[PRE5]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Pass the `controlnet` to the [AutoPipelineForText2Image](/docs/diffusers/v0.26.3/en/api/pipelines/auto_pipeline#diffusers.AutoPipelineForText2Image),
    and provide the prompt and pose estimation image:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: å°†`controlnet`ä¼ é€’ç»™[AutoPipelineForText2Image](/docs/diffusers/v0.26.3/en/api/pipelines/auto_pipeline#diffusers.AutoPipelineForText2Image)ï¼Œå¹¶æä¾›æç¤ºå’Œå§¿åŠ¿ä¼°è®¡å›¾åƒï¼š
- en: '[PRE6]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/d2b7e6b0b8516e613654db5d9e482041.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d2b7e6b0b8516e613654db5d9e482041.png)'
- en: Stable Diffusion v1.5
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: ç¨³å®šæ‰©æ•£v1.5
- en: '![](../Images/47eb848e4e09fd8ca2c920b1f98d089d.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/47eb848e4e09fd8ca2c920b1f98d089d.png)'
- en: Stable Diffusion XL
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: ç¨³å®šæ‰©æ•£XL
- en: '![](../Images/6c09e0df13fba3dbf95d5232315d36eb.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6c09e0df13fba3dbf95d5232315d36eb.png)'
- en: Kandinsky 2.2
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: åº·å®šæ–¯åŸº2.2
- en: '![](../Images/3657c31e95dc399792fc8b0ee81679f4.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3657c31e95dc399792fc8b0ee81679f4.png)'
- en: ControlNet (pose conditioning)
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: ControlNetï¼ˆå§¿åŠ¿è°ƒèŠ‚ï¼‰
- en: Configure pipeline parameters
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é…ç½®ç®¡é“å‚æ•°
- en: There are a number of parameters that can be configured in the pipeline that
    affect how an image is generated. You can change the imageâ€™s output size, specify
    a negative prompt to improve image quality, and more. This section dives deeper
    into how to use these parameters.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: ç®¡é“ä¸­æœ‰è®¸å¤šå¯ä»¥é…ç½®çš„å‚æ•°ä¼šå½±å“å›¾åƒçš„ç”Ÿæˆæ–¹å¼ã€‚æ‚¨å¯ä»¥æ›´æ”¹å›¾åƒçš„è¾“å‡ºå°ºå¯¸ï¼ŒæŒ‡å®šè´Ÿé¢æç¤ºä»¥æ”¹å–„å›¾åƒè´¨é‡ç­‰ã€‚æœ¬èŠ‚å°†æ·±å…¥æ¢è®¨å¦‚ä½•ä½¿ç”¨è¿™äº›å‚æ•°ã€‚
- en: Height and width
  id: totrans-40
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: é«˜åº¦å’Œå®½åº¦
- en: 'The `height` and `width` parameters control the height and width (in pixels)
    of the generated image. By default, the Stable Diffusion v1.5 model outputs 512x512
    images, but you can change this to any size that is a multiple of 8\. For example,
    to create a rectangular image:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '`height`å’Œ`width`å‚æ•°æ§åˆ¶ç”Ÿæˆå›¾åƒçš„é«˜åº¦å’Œå®½åº¦ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç¨³å®šæ‰©æ•£v1.5æ¨¡å‹è¾“å‡º512x512çš„å›¾åƒï¼Œä½†æ‚¨å¯ä»¥å°†å…¶æ›´æ”¹ä¸ºä»»ä½•æ˜¯8çš„å€æ•°çš„å°ºå¯¸ã€‚ä¾‹å¦‚ï¼Œè¦åˆ›å»ºä¸€ä¸ªçŸ©å½¢å›¾åƒï¼š'
- en: '[PRE7]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![](../Images/84e161b40900b68ec614371d04cb4eb1.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/84e161b40900b68ec614371d04cb4eb1.png)'
- en: Other models may have different default image sizes depending on the image sizes
    in the training dataset. For example, SDXLâ€™s default image size is 1024x1024 and
    using lower `height` and `width` values may result in lower quality images. Make
    sure you check the modelâ€™s API reference first!
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä»–æ¨¡å‹å¯èƒ½å…·æœ‰ä¸åŒçš„é»˜è®¤å›¾åƒå°ºå¯¸ï¼Œå…·ä½“å–å†³äºè®­ç»ƒæ•°æ®é›†ä¸­çš„å›¾åƒå°ºå¯¸ã€‚ä¾‹å¦‚ï¼ŒSDXLçš„é»˜è®¤å›¾åƒå°ºå¯¸ä¸º1024x1024ï¼Œä½¿ç”¨è¾ƒä½çš„`height`å’Œ`width`å€¼å¯èƒ½ä¼šå¯¼è‡´å›¾åƒè´¨é‡é™ä½ã€‚ç¡®ä¿æ‚¨é¦–å…ˆæ£€æŸ¥æ¨¡å‹çš„APIå‚è€ƒï¼
- en: Guidance scale
  id: totrans-45
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å¼•å¯¼æ¯”ä¾‹
- en: The `guidance_scale` parameter affects how much the prompt influences image
    generation. A lower value gives the model â€œcreativityâ€ to generate images that
    are more loosely related to the prompt. Higher `guidance_scale` values push the
    model to follow the prompt more closely, and if this value is too high, you may
    observe some artifacts in the generated image.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '`guidance_scale`å‚æ•°å½±å“æç¤ºå¯¹å›¾åƒç”Ÿæˆçš„å½±å“ç¨‹åº¦ã€‚è¾ƒä½çš„å€¼ä½¿æ¨¡å‹å…·æœ‰â€œåˆ›é€ åŠ›â€ï¼Œç”Ÿæˆä¸æç¤ºæ›´æ¾æ•£ç›¸å…³çš„å›¾åƒã€‚è¾ƒé«˜çš„`guidance_scale`å€¼ä¼šä¿ƒä½¿æ¨¡å‹æ›´ç´§å¯†åœ°éµå¾ªæç¤ºï¼Œå¦‚æœè¿™ä¸ªå€¼å¤ªé«˜ï¼Œæ‚¨å¯èƒ½ä¼šè§‚å¯Ÿåˆ°ç”Ÿæˆå›¾åƒä¸­çš„ä¸€äº›ä¼ªå½±ã€‚'
- en: '[PRE8]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![](../Images/d4e1ac912506a0937e8776bcaf804434.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d4e1ac912506a0937e8776bcaf804434.png)'
- en: guidance_scale = 2.5
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: guidance_scale = 2.5
- en: '![](../Images/bd6081df4d5f8e0649e3668778fa3eab.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bd6081df4d5f8e0649e3668778fa3eab.png)'
- en: guidance_scale = 7.5
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: guidance_scale = 7.5
- en: '![](../Images/3741374b77d721ec460507012c586ea0.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3741374b77d721ec460507012c586ea0.png)'
- en: guidance_scale = 10.5
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: guidance_scale = 10.5
- en: Negative prompt
  id: totrans-54
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: è´Ÿé¢æç¤º
- en: Just like how a prompt guides generation, a *negative prompt* steers the model
    away from things you donâ€™t want the model to generate. This is commonly used to
    improve overall image quality by removing poor or bad image features such as â€œlow
    resolutionâ€ or â€œbad detailsâ€. You can also use a negative prompt to remove or
    modify the content and style of an image.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: å°±åƒæç¤ºå¼•å¯¼ç”Ÿæˆä¸€æ ·ï¼Œ*è´Ÿé¢æç¤º*ä¼šå°†æ¨¡å‹å¼•å¯¼è¿œç¦»æ‚¨ä¸å¸Œæœ›æ¨¡å‹ç”Ÿæˆçš„å†…å®¹ã€‚è¿™é€šå¸¸ç”¨äºé€šè¿‡æ¶ˆé™¤â€œä½åˆ†è¾¨ç‡â€æˆ–â€œç³Ÿç³•ç»†èŠ‚â€ç­‰ä¸è‰¯å›¾åƒç‰¹å¾æ¥æé«˜æ•´ä½“å›¾åƒè´¨é‡ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨è´Ÿé¢æç¤ºæ¥åˆ é™¤æˆ–ä¿®æ”¹å›¾åƒçš„å†…å®¹å’Œé£æ ¼ã€‚
- en: '[PRE9]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![](../Images/841a0429e6f0e2536bdabb5aa8e25a23.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/841a0429e6f0e2536bdabb5aa8e25a23.png)'
- en: negative_prompt = "ugly, deformed, disfigured, poor details, bad anatomy"
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: negative_prompt = "ä¸‘é™‹ï¼Œç•¸å½¢ï¼Œæ¯å®¹ï¼Œç»†èŠ‚å·®ï¼Œè§£å‰–ä¸è‰¯"
- en: '![](../Images/9695ff0c8decf5141f5f125a58a6ec4c.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9695ff0c8decf5141f5f125a58a6ec4c.png)'
- en: negative_prompt = "astronaut"
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: negative_prompt = "astronaut"
- en: Generator
  id: totrans-61
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ç”Ÿæˆå™¨
- en: A [`torch.Generator`](https://pytorch.org/docs/stable/generated/torch.Generator.html#generator)
    object enables reproducibility in a pipeline by setting a manual seed. You can
    use a `Generator` to generate batches of images and iteratively improve on an
    image generated from a seed as detailed in the [Improve image quality with deterministic
    generation](reusing_seeds) guide.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '[`torch.Generator`](https://pytorch.org/docs/stable/generated/torch.Generator.html#generator)å¯¹è±¡é€šè¿‡è®¾ç½®æ‰‹åŠ¨ç§å­æ¥å®ç°ç®¡é“ä¸­çš„å¯é‡ç°æ€§ã€‚æ‚¨å¯ä»¥ä½¿ç”¨`Generator`ç”Ÿæˆå›¾åƒæ‰¹æ¬¡ï¼Œå¹¶æ ¹æ®[ä½¿ç”¨ç¡®å®šæ€§ç”Ÿæˆæ”¹å–„å›¾åƒè´¨é‡](reusing_seeds)æŒ‡å—ä¸­çš„è¯¦ç»†è¯´æ˜é€æ­¥æ”¹è¿›ä»ç§å­ç”Ÿæˆçš„å›¾åƒã€‚'
- en: You can set a seed and `Generator` as shown below. Creating an image with a
    `Generator` should return the same result each time instead of randomly generating
    a new image.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: æ‚¨å¯ä»¥è®¾ç½®ä¸€ä¸ªç§å­å’Œ`Generator`å¦‚ä¸‹æ‰€ç¤ºã€‚ä½¿ç”¨`Generator`åˆ›å»ºå›¾åƒåº”è¯¥æ¯æ¬¡è¿”å›ç›¸åŒçš„ç»“æœï¼Œè€Œä¸æ˜¯éšæœºç”Ÿæˆæ–°å›¾åƒã€‚
- en: '[PRE10]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Control image generation
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ§åˆ¶å›¾åƒç”Ÿæˆ
- en: There are several ways to exert more control over how an image is generated
    outside of configuring a pipelineâ€™s parameters, such as prompt weighting and ControlNet
    models.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: é™¤äº†é…ç½®ç®¡é“å‚æ•°å¤–ï¼Œè¿˜æœ‰å‡ ç§æ–¹æ³•å¯ä»¥æ›´å¥½åœ°æ§åˆ¶å›¾åƒç”Ÿæˆï¼Œä¾‹å¦‚æç¤ºåŠ æƒå’ŒControlNetæ¨¡å‹ã€‚
- en: Prompt weighting
  id: totrans-67
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: PromptåŠ æƒ
- en: Prompt weighting is a technique for increasing or decreasing the importance
    of concepts in a prompt to emphasize or minimize certain features in an image.
    We recommend using the [Compel](https://github.com/damian0815/compel) library
    to help you generate the weighted prompt embeddings.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: PromptåŠ æƒæ˜¯ä¸€ç§å¢åŠ æˆ–å‡å°‘æç¤ºä¸­æ¦‚å¿µé‡è¦æ€§çš„æŠ€æœ¯ï¼Œä»¥å¼ºè°ƒæˆ–æœ€å°åŒ–å›¾åƒä¸­çš„æŸäº›ç‰¹å¾ã€‚æˆ‘ä»¬å»ºè®®ä½¿ç”¨[Compel](https://github.com/damian0815/compel)åº“æ¥å¸®åŠ©æ‚¨ç”ŸæˆåŠ æƒçš„æç¤ºåµŒå…¥ã€‚
- en: Learn how to create the prompt embeddings in the [Prompt weighting](weighted_prompts)
    guide. This example focuses on how to use the prompt embeddings in the pipeline.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: äº†è§£å¦‚ä½•åœ¨[PromptåŠ æƒ](weighted_prompts)æŒ‡å—ä¸­åˆ›å»ºæç¤ºåµŒå…¥ã€‚æœ¬ä¾‹é‡ç‚¹ä»‹ç»å¦‚ä½•åœ¨ç®¡é“ä¸­ä½¿ç”¨æç¤ºåµŒå…¥ã€‚
- en: Once youâ€™ve created the embeddings, you can pass them to the `prompt_embeds`
    (and `negative_prompt_embeds` if youâ€™re using a negative prompt) parameter in
    the pipeline.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ›å»ºåµŒå…¥åï¼Œæ‚¨å¯ä»¥å°†å®ƒä»¬ä¼ é€’ç»™ç®¡é“ä¸­çš„`prompt_embeds`ï¼ˆå¦‚æœæ‚¨ä½¿ç”¨è´Ÿæç¤ºï¼Œåˆ™è¿˜æœ‰`negative_prompt_embeds`å‚æ•°ï¼‰ã€‚
- en: '[PRE11]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: ControlNet
  id: totrans-72
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ControlNet
- en: As you saw in the [ControlNet](#controlnet) section, these models offer a more
    flexible and accurate way to generate images by incorporating an additional conditioning
    image input. Each ControlNet model is pretrained on a particular type of conditioning
    image to generate new images that resemble it. For example, if you take a ControlNet
    model pretrained on depth maps, you can give the model a depth map as a conditioning
    input and itâ€™ll generate an image that preserves the spatial information in it.
    This is quicker and easier than specifying the depth information in a prompt.
    You can even combine multiple conditioning inputs with a [MultiControlNet](controlnet#multicontrolnet)!
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨[ControlNet](#controlnet)éƒ¨åˆ†ä¸­ï¼Œæ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œè¿™äº›æ¨¡å‹é€šè¿‡å¼•å…¥é¢å¤–çš„æ¡ä»¶å›¾åƒè¾“å…¥ï¼Œæä¾›äº†ä¸€ç§æ›´çµæ´»å’Œå‡†ç¡®çš„ç”Ÿæˆå›¾åƒçš„æ–¹å¼ã€‚æ¯ä¸ªControlNetæ¨¡å‹éƒ½æ˜¯åœ¨ç‰¹å®šç±»å‹çš„æ¡ä»¶å›¾åƒä¸Šé¢„è®­ç»ƒçš„ï¼Œä»¥ç”Ÿæˆç±»ä¼¼çš„æ–°å›¾åƒã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨ä½¿ç”¨ä¸€ä¸ªåœ¨æ·±åº¦å›¾ä¸Šé¢„è®­ç»ƒçš„ControlNetæ¨¡å‹ï¼Œæ‚¨å¯ä»¥å°†æ·±åº¦å›¾ä½œä¸ºæ¡ä»¶è¾“å…¥ç»™æ¨¡å‹ï¼Œå®ƒå°†ç”Ÿæˆä¿ç•™å…¶ä¸­ç©ºé—´ä¿¡æ¯çš„å›¾åƒã€‚è¿™æ¯”åœ¨æç¤ºä¸­æŒ‡å®šæ·±åº¦ä¿¡æ¯æ›´å¿«æ›´å®¹æ˜“ã€‚æ‚¨ç”šè‡³å¯ä»¥å°†å¤šä¸ªæ¡ä»¶è¾“å…¥ä¸[MultiControlNet](controlnet#multicontrolnet)ç»“åˆä½¿ç”¨ï¼
- en: There are many types of conditioning inputs you can use, and ğŸ¤— Diffusers supports
    ControlNet for Stable Diffusion and SDXL models. Take a look at the more comprehensive
    [ControlNet](controlnet) guide to learn how you can use these models.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: æ‚¨å¯ä»¥ä½¿ç”¨è®¸å¤šç±»å‹çš„æ¡ä»¶è¾“å…¥ï¼Œå¹¶ä¸”ğŸ¤— Diffusersæ”¯æŒStable Diffusionå’ŒSDXLæ¨¡å‹çš„ControlNetã€‚æŸ¥çœ‹æ›´å…¨é¢çš„[ControlNet](controlnet)æŒ‡å—ï¼Œäº†è§£å¦‚ä½•ä½¿ç”¨è¿™äº›æ¨¡å‹ã€‚
- en: Optimize
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä¼˜åŒ–
- en: Diffusion models are large, and the iterative nature of denoising an image is
    computationally expensive and intensive. But this doesnâ€™t mean you need access
    to powerful - or even many - GPUs to use them. There are many optimization techniques
    for running diffusion models on consumer and free-tier resources. For example,
    you can load model weights in half-precision to save GPU memory and increase speed
    or offload the entire model to the GPU to save even more memory.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰©æ•£æ¨¡å‹å¾ˆå¤§ï¼Œå¯¹å›¾åƒè¿›è¡Œå»å™ªçš„è¿­ä»£æ€§è´¨åœ¨è®¡ç®—ä¸Šæ˜¯æ˜‚è´µä¸”å¯†é›†çš„ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€æ‚¨éœ€è¦è®¿é—®å¼ºå¤§çš„ - æˆ–è€…ç”šè‡³å¾ˆå¤š - GPUæ¥ä½¿ç”¨å®ƒä»¬ã€‚æœ‰è®¸å¤šä¼˜åŒ–æŠ€æœ¯å¯ç”¨äºåœ¨æ¶ˆè´¹è€…å’Œå…è´¹èµ„æºä¸Šè¿è¡Œæ‰©æ•£æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å°†æ¨¡å‹æƒé‡åŠ è½½ä¸ºåŠç²¾åº¦ä»¥èŠ‚çœGPUå†…å­˜å¹¶æé«˜é€Ÿåº¦ï¼Œæˆ–è€…å°†æ•´ä¸ªæ¨¡å‹å¸è½½åˆ°GPUä»¥èŠ‚çœæ›´å¤šå†…å­˜ã€‚
- en: 'PyTorch 2.0 also supports a more memory-efficient attention mechanism called
    [*scaled dot product attention*](../optimization/torch2.0#scaled-dot-product-attention)
    that is automatically enabled if youâ€™re using PyTorch 2.0\. You can combine this
    with [`torch.compile`](https://pytorch.org/tutorials/intermediate/torch_compile_tutorial.html)
    to speed your code up even more:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: PyTorch 2.0è¿˜æ”¯æŒä¸€ç§æ›´èŠ‚çœå†…å­˜çš„æ³¨æ„æœºåˆ¶ï¼Œç§°ä¸º[*ç¼©æ”¾ç‚¹ç§¯æ³¨æ„*](../optimization/torch2.0#scaled-dot-product-attention)ï¼Œå¦‚æœæ‚¨ä½¿ç”¨PyTorch
    2.0ï¼Œåˆ™ä¼šè‡ªåŠ¨å¯ç”¨ã€‚æ‚¨å¯ä»¥å°†å…¶ä¸[`torch.compile`](https://pytorch.org/tutorials/intermediate/torch_compile_tutorial.html)ç»“åˆä½¿ç”¨ï¼Œä»¥è¿›ä¸€æ­¥åŠ å¿«ä»£ç é€Ÿåº¦ï¼š
- en: '[PRE12]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: For more tips on how to optimize your code to save memory and speed up inference,
    read the [Memory and speed](../optimization/fp16) and [Torch 2.0](../optimization/torch2.0)
    guides.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰å…³å¦‚ä½•ä¼˜åŒ–ä»£ç ä»¥èŠ‚çœå†…å­˜å’ŒåŠ å¿«æ¨ç†é€Ÿåº¦çš„æ›´å¤šæç¤ºï¼Œè¯·é˜…è¯»[å†…å­˜å’Œé€Ÿåº¦](../optimization/fp16)å’Œ[Torch 2.0](../optimization/torch2.0)æŒ‡å—ã€‚
