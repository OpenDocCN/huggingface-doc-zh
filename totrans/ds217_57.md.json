["```py\n>>> from datasets import Dataset\n>>> dataset = Dataset.from_dict({\"a\": [0, 1, 2]})\n>>> dataset.map(lambda batch: {\"b\": batch[\"a\"] * 2}, batched=True)  # new column with 6 elements: [0, 1, 2, 0, 1, 2]\n'ArrowInvalid: Column 1 named b expected length 3 but got length 6'\n```", "```py\n>>> from datasets import Dataset\n>>> dataset = Dataset.from_dict({\"a\": [0, 1, 2]})\n>>> dataset_with_duplicates = dataset.map(lambda batch: {\"b\": batch[\"a\"] * 2}, remove_columns=[\"a\"], batched=True)\n>>> len(dataset_with_duplicates)\n6\n```"]