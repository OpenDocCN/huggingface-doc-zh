# è°ƒåº¦å™¨

> åŸå§‹æ–‡æœ¬ï¼š[`huggingface.co/docs/diffusers/api/schedulers/overview`](https://huggingface.co/docs/diffusers/api/schedulers/overview)

ğŸ¤— Diffusers æä¾›äº†è®¸å¤šæ‰©æ•£è¿‡ç¨‹çš„è°ƒåº¦å™¨å‡½æ•°ã€‚è°ƒåº¦å™¨æ¥æ”¶æ¨¡å‹çš„è¾“å‡ºï¼ˆæ‰©æ•£è¿‡ç¨‹æ­£åœ¨è¿­ä»£çš„æ ·æœ¬ï¼‰å’Œä¸€ä¸ªæ—¶é—´æ­¥é•¿ï¼Œè¿”å›ä¸€ä¸ªå»å™ªçš„æ ·æœ¬ã€‚æ—¶é—´æ­¥é•¿å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå†³å®šäº†æ­¥éª¤åœ¨æ‰©æ•£è¿‡ç¨‹ä¸­çš„ä½ç½®ï¼›æ•°æ®æ˜¯é€šè¿‡å‘å‰è¿­ä»£ *n* ä¸ªæ—¶é—´æ­¥ç”Ÿæˆçš„ï¼Œæ¨æ–­æ˜¯é€šè¿‡å‘åä¼ æ’­åˆ°æ—¶é—´æ­¥ä¸­è¿›è¡Œçš„ã€‚æ ¹æ®æ—¶é—´æ­¥é•¿ï¼Œè°ƒåº¦å™¨å¯èƒ½æ˜¯*ç¦»æ•£*çš„ï¼Œæ­¤æ—¶æ—¶é—´æ­¥é•¿æ˜¯ä¸€ä¸ª `int`ï¼Œæˆ–è€…æ˜¯*è¿ç»­*çš„ï¼Œæ­¤æ—¶æ—¶é—´æ­¥é•¿æ˜¯ä¸€ä¸ª `float`ã€‚

æ ¹æ®ä¸Šä¸‹æ–‡ï¼Œè°ƒåº¦å™¨å®šä¹‰äº†å¦‚ä½•è¿­ä»£åœ°å‘å›¾åƒæ·»åŠ å™ªå£°æˆ–è€…æ ¹æ®æ¨¡å‹çš„è¾“å‡ºæ›´æ–°æ ·æœ¬ï¼š

+   åœ¨*è®­ç»ƒ*æœŸé—´ï¼Œè°ƒåº¦å™¨å‘æ ·æœ¬æ·»åŠ å™ªå£°ï¼ˆæœ‰ä¸åŒçš„ç®—æ³•æ¥æ·»åŠ å™ªå£°ï¼‰ä»¥è®­ç»ƒæ‰©æ•£æ¨¡å‹

+   åœ¨*æ¨æ–­*æœŸé—´ï¼Œè°ƒåº¦å™¨å®šä¹‰äº†å¦‚ä½•æ ¹æ®é¢„è®­ç»ƒæ¨¡å‹çš„è¾“å‡ºæ›´æ–°æ ·æœ¬

è®¸å¤šè°ƒåº¦å™¨æ˜¯ä» [k-diffusion](https://github.com/crowsonkb/k-diffusion) åº“ä¸­ç”± [Katherine Crowson](https://github.com/crowsonkb/) å®ç°çš„ï¼Œå¹¶ä¸”å®ƒä»¬ä¹Ÿå¹¿æ³›ç”¨äº A1111ã€‚ä¸ºäº†å¸®åŠ©æ‚¨å°† k-diffusion å’Œ A1111 ä¸­çš„è°ƒåº¦å™¨æ˜ å°„åˆ° ğŸ¤— Diffusers ä¸­çš„è°ƒåº¦å™¨ï¼Œè¯·æŸ¥çœ‹ä¸‹è¡¨ï¼š

| A1111/k-diffusion | ğŸ¤— Diffusers | ç”¨æ³• |
| --- | --- | --- |
| DPM++ 2M | DPMSolverMultistepScheduler |  |
| DPM++ 2M Karras | DPMSolverMultistepScheduler | åˆå§‹åŒ–æ—¶ä½¿ç”¨ `use_karras_sigmas=True` |
| DPM++ 2M SDE | DPMSolverMultistepScheduler | åˆå§‹åŒ–æ—¶ä½¿ç”¨ `algorithm_type="sde-dpmsolver++"` |
| DPM++ 2M SDE Karras | DPMSolverMultistepScheduler | åˆå§‹åŒ–æ—¶ä½¿ç”¨ `use_karras_sigmas=True` å’Œ `algorithm_type="sde-dpmsolver++"` |
| DPM++ 2S a | N/A | ä¸ `DPMSolverSinglestepScheduler` éå¸¸ç›¸ä¼¼ |
| DPM++ 2S a Karras | N/A | ä¸ `DPMSolverSinglestepScheduler(use_karras_sigmas=True, ...)` éå¸¸ç›¸ä¼¼ |
| DPM++ SDE | DPMSolverSinglestepScheduler |  |
| DPM++ SDE Karras | DPMSolverSinglestepScheduler | åˆå§‹åŒ–æ—¶ä½¿ç”¨ `use_karras_sigmas=True` |
| DPM2 | KDPM2DiscreteScheduler |  |
| DPM2 Karras | KDPM2DiscreteScheduler | åˆå§‹åŒ–æ—¶ä½¿ç”¨ `use_karras_sigmas=True` |
| DPM2 a | KDPM2AncestralDiscreteScheduler |  |
| DPM2 a Karras | KDPM2AncestralDiscreteScheduler | åˆå§‹åŒ–æ—¶ä½¿ç”¨ `use_karras_sigmas=True` |
| DPM adaptive | N/A |  |
| DPM fast | N/A |  |
| Euler | EulerDiscreteScheduler |  |
| Euler a | EulerAncestralDiscreteScheduler |  |
| Heun | HeunDiscreteScheduler |  |
| LMS | LMSDiscreteScheduler |  |
| LMS Karras | LMSDiscreteScheduler | ä½¿ç”¨ `use_karras_sigmas=True` åˆå§‹åŒ– |
| N/A | DEISMultistepScheduler |  |
| N/A | UniPCMultistepScheduler |  |

æ‰€æœ‰è°ƒåº¦å™¨éƒ½æ˜¯ä»åŸºç¡€ SchedulerMixin ç±»æ„å»ºçš„ï¼Œè¯¥ç±»å®ç°äº†æ‰€æœ‰è°ƒåº¦å™¨å…±äº«çš„ä½çº§å®ç”¨ç¨‹åºã€‚

## SchedulerMixin

### `class diffusers.SchedulerMixin`

[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/schedulers/scheduling_utils.py#L64)

```py
( )
```

æ‰€æœ‰è°ƒåº¦å™¨çš„åŸºç±»ã€‚

SchedulerMixin åŒ…å«æ‰€æœ‰è°ƒåº¦å™¨å…±äº«çš„é€šç”¨å‡½æ•°ï¼Œå¦‚ä¸€èˆ¬åŠ è½½å’Œä¿å­˜åŠŸèƒ½ã€‚

ConfigMixin è´Ÿè´£å­˜å‚¨ä¼ é€’ç»™è°ƒåº¦å™¨çš„ `__init__` å‡½æ•°çš„é…ç½®å±æ€§ï¼ˆå¦‚ `num_train_timesteps`ï¼‰ï¼Œè¿™äº›å±æ€§å¯ä»¥é€šè¿‡ `scheduler.config.num_train_timesteps` è®¿é—®ã€‚

ç±»å±æ€§:

+   `_compatibles` (`List[str]`) â€” ä¸çˆ¶è°ƒåº¦å™¨ç±»å…¼å®¹çš„è°ƒåº¦å™¨ç±»åˆ—è¡¨ã€‚ä½¿ç”¨ from_config() åŠ è½½ä¸åŒçš„å…¼å®¹è°ƒåº¦å™¨ç±»ï¼ˆåº”è¯¥è¢«çˆ¶ç±»è¦†ç›–ï¼‰ã€‚

#### `from_pretrained`

[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/schedulers/scheduling_utils.py#L84)

```py
( pretrained_model_name_or_path: Union = None subfolder: Optional = None return_unused_kwargs = False **kwargs )
```

å‚æ•°

+   `pretrained_model_name_or_path` (`str` æˆ– `os.PathLike`, *optional*) â€” å¯ä»¥æ˜¯ï¼š

    +   ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé¢„è®­ç»ƒæ¨¡å‹åœ¨ Hub ä¸Šæ‰˜ç®¡çš„ *æ¨¡å‹ ID*ï¼ˆä¾‹å¦‚ `google/ddpm-celebahq-256`ï¼‰ã€‚

    +   ä¸€ä¸ª *ç›®å½•* è·¯å¾„ï¼ˆä¾‹å¦‚ `./my_model_directory`ï¼‰ï¼Œå…¶ä¸­åŒ…å«ä½¿ç”¨ save_pretrained() ä¿å­˜çš„è°ƒåº¦å™¨é…ç½®ã€‚

+   `subfolder` (`str`, *optional*) â€” åœ¨ Hub æˆ–æœ¬åœ°çš„è¾ƒå¤§æ¨¡å‹å­˜å‚¨åº“ä¸­æ¨¡å‹æ–‡ä»¶çš„å­æ–‡ä»¶å¤¹ä½ç½®ã€‚

+   `return_unused_kwargs` (`bool`, *optional*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦è¿”å›æœªè¢« Python ç±»ä½¿ç”¨çš„ kwargsã€‚

+   `cache_dir` (`Union[str, os.PathLike]`, *optional*) â€” ä¸‹è½½é¢„è®­ç»ƒæ¨¡å‹é…ç½®çš„ç¼“å­˜ç›®å½•è·¯å¾„ï¼Œå¦‚æœä¸ä½¿ç”¨æ ‡å‡†ç¼“å­˜ã€‚

+   `force_download` (`bool`, *optional*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦å¼ºåˆ¶ï¼ˆé‡æ–°ï¼‰ä¸‹è½½æ¨¡å‹æƒé‡å’Œé…ç½®æ–‡ä»¶ï¼Œè¦†ç›–ç¼“å­˜ç‰ˆæœ¬ã€‚

+   `resume_download` (`bool`, *optional*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦æ¢å¤ä¸‹è½½æ¨¡å‹æƒé‡å’Œé…ç½®æ–‡ä»¶ã€‚å¦‚æœè®¾ç½®ä¸º `False`ï¼Œåˆ™åˆ é™¤ä»»ä½•æœªå®Œå…¨ä¸‹è½½çš„æ–‡ä»¶ã€‚

+   `proxies` (`Dict[str, str]`, *optional*) â€” ä¸€ä¸ªä»£ç†æœåŠ¡å™¨å­—å…¸ï¼ŒæŒ‰åè®®æˆ–ç«¯ç‚¹ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼Œ`{'http': 'foo.bar:3128', 'http://hostname': 'foo.bar:4012'}`ã€‚ä»£ç†åœ¨æ¯ä¸ªè¯·æ±‚ä¸Šä½¿ç”¨ã€‚

+   `output_loading_info(bool,` *optional*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦è¿˜è¿”å›åŒ…å«ç¼ºå¤±é”®ã€æ„å¤–é”®å’Œé”™è¯¯æ¶ˆæ¯çš„å­—å…¸ã€‚

+   `local_files_only(bool,` *optional*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦ä»…åŠ è½½æœ¬åœ°æ¨¡å‹æƒé‡å’Œé…ç½®æ–‡ä»¶ã€‚å¦‚æœè®¾ç½®ä¸º `True`ï¼Œåˆ™ä¸ä¼šä» Hub ä¸‹è½½æ¨¡å‹ã€‚

+   `token` (`str` æˆ– *bool*, *optional*) â€” ç”¨ä½œè¿œç¨‹æ–‡ä»¶çš„ HTTP bearer æˆæƒçš„ä»¤ç‰Œã€‚å¦‚æœä¸º `True`ï¼Œåˆ™ä½¿ç”¨ä» `diffusers-cli login` ç”Ÿæˆçš„ä»¤ç‰Œï¼ˆå­˜å‚¨åœ¨ `~/.huggingface`ï¼‰ã€‚

+   `revision` (`str`, *optional*, é»˜è®¤ä¸º `"main"`) â€” è¦ä½¿ç”¨çš„ç‰¹å®šæ¨¡å‹ç‰ˆæœ¬ã€‚å¯ä»¥æ˜¯åˆ†æ”¯åç§°ã€æ ‡ç­¾åç§°ã€æäº¤ ID æˆ– Git å…è®¸çš„ä»»ä½•æ ‡è¯†ç¬¦ã€‚

ä»æœ¬åœ°ç›®å½•æˆ– Hub å­˜å‚¨åº“ä¸­çš„é¢„å®šä¹‰ JSON é…ç½®æ–‡ä»¶å®ä¾‹åŒ–è°ƒåº¦ç¨‹åºã€‚

è¦ä½¿ç”¨ç§æœ‰æˆ–[é—¨æ§æ¨¡å‹](https://huggingface.co/docs/hub/models-gated#gated-models)ï¼Œè¯·ä½¿ç”¨ `huggingface-cli login` ç™»å½•ã€‚æ‚¨è¿˜å¯ä»¥æ¿€æ´»ç‰¹æ®Šçš„[â€œç¦»çº¿æ¨¡å¼â€](https://huggingface.co/diffusers/installation.html#offline-mode)ä»¥åœ¨é˜²ç«å¢™ç¯å¢ƒä¸­ä½¿ç”¨æ­¤æ–¹æ³•ã€‚

#### `save_pretrained`

[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/schedulers/scheduling_utils.py#L151)

```py
( save_directory: Union push_to_hub: bool = False **kwargs )
```

å‚æ•°

+   `save_directory` (`str` æˆ– `os.PathLike`) â€” å°†ä¿å­˜é…ç½® JSON æ–‡ä»¶çš„ç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨å°†åˆ›å»ºï¼‰ã€‚

+   `push_to_hub` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦åœ¨ä¿å­˜åå°†æ¨¡å‹æ¨é€åˆ° Hugging Face Hubã€‚æ‚¨å¯ä»¥ä½¿ç”¨ `repo_id` æŒ‡å®šè¦æ¨é€åˆ°çš„å­˜å‚¨åº“ï¼ˆå°†é»˜è®¤ä¸ºæ‚¨çš„å‘½åç©ºé—´ä¸­çš„ `save_directory` åç§°ï¼‰ã€‚

+   `kwargs` (`Dict[str, Any]`, *å¯é€‰*) â€” ä¼ é€’ç»™ push_to_hub() æ–¹æ³•çš„é¢å¤–å…³é”®å­—å‚æ•°ã€‚

å°†è°ƒåº¦ç¨‹åºé…ç½®å¯¹è±¡ä¿å­˜åˆ°ç›®å½•ä¸­ï¼Œä»¥ä¾¿å¯ä»¥ä½¿ç”¨ from_pretrained() ç±»æ–¹æ³•é‡æ–°åŠ è½½ã€‚

## SchedulerOutput

### `class diffusers.schedulers.scheduling_utils.SchedulerOutput`

[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/schedulers/scheduling_utils.py#L50)

```py
( prev_sample: FloatTensor )
```

å‚æ•°

+   `prev_sample`ï¼ˆå¯¹äºå›¾åƒï¼Œå½¢çŠ¶ä¸º `(batch_size, num_channels, height, width)` çš„ `torch.FloatTensor`ï¼‰ â€” ä¸Šä¸€ä¸ªæ—¶é—´æ­¥çš„è®¡ç®—æ ·æœ¬ `(x_{t-1})`ã€‚`prev_sample` åº”åœ¨å»å™ªå¾ªç¯ä¸­ä½œä¸ºä¸‹ä¸€ä¸ªæ¨¡å‹è¾“å…¥ä½¿ç”¨ã€‚

è°ƒåº¦ç¨‹åº `step` å‡½æ•°çš„è¾“å‡ºçš„åŸºç±»ã€‚

## KarrasDiffusionSchedulers

`KarrasDiffusionSchedulers` æ˜¯ ğŸ¤— Diffusers ä¸­è°ƒåº¦ç¨‹åºçš„å¹¿ä¹‰æ¦‚æ‹¬ã€‚è¯¥ç±»ä¸­çš„è°ƒåº¦ç¨‹åºåœ¨é«˜å±‚æ¬¡ä¸Šé€šè¿‡å…¶å™ªå£°é‡‡æ ·ç­–ç•¥ã€ç½‘ç»œå’Œç¼©æ”¾ç±»å‹ã€è®­ç»ƒç­–ç•¥ä»¥åŠæŸå¤±åŠ æƒæ–¹å¼è¿›è¡ŒåŒºåˆ†ã€‚

è¯¥ç±»ä¸­çš„ä¸åŒè°ƒåº¦ç¨‹åºæ ¹æ®å¸¸å¾®åˆ†æ–¹ç¨‹ï¼ˆODEï¼‰æ±‚è§£å™¨ç±»å‹ï¼Œè½å…¥ä¸Šè¿°åˆ†ç±»ï¼Œå¹¶ä¸º ğŸ¤— Diffusers ä¸­å®ç°çš„ä¸»è¦è°ƒåº¦ç¨‹åºçš„è®¾è®¡æä¾›äº†å¾ˆå¥½çš„æŠ½è±¡ã€‚è¯¥ç±»ä¸­çš„è°ƒåº¦ç¨‹åºåœ¨[è¿™é‡Œ](https://github.com/huggingface/diffusers/blob/a69754bb879ed55b9b6dc9dd0b3cf4fa4124c765/src/diffusers/schedulers/scheduling_utils.py#L32)ç»™å‡ºã€‚

## PushToHubMixin

### `class diffusers.utils.PushToHubMixin`

[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/utils/hub_utils.py#L351)

```py
( )
```

ä¸€ä¸ª Mixinï¼Œç”¨äºå°†æ¨¡å‹ã€è°ƒåº¦ç¨‹åºæˆ–ç®¡é“æ¨é€åˆ° Hugging Face Hubã€‚

#### `push_to_hub`

[< source >](https://github.com/huggingface/diffusers/blob/v0.26.3/src/diffusers/utils/hub_utils.py#L380)

```py
( repo_id: str commit_message: Optional = None private: Optional = None token: Optional = None create_pr: bool = False safe_serialization: bool = True variant: Optional = None )
```

å‚æ•°

+   `repo_id` (`str`) â€” æ‚¨è¦å°†æ¨¡å‹ã€è°ƒåº¦ç¨‹åºæˆ–ç®¡é“æ–‡ä»¶æ¨é€åˆ°çš„å­˜å‚¨åº“çš„åç§°ã€‚å½“æ¨é€åˆ°ç»„ç»‡æ—¶ï¼Œå®ƒåº”åŒ…å«æ‚¨çš„ç»„ç»‡åç§°ã€‚`repo_id` ä¹Ÿå¯ä»¥æ˜¯æŒ‡å‘æœ¬åœ°ç›®å½•çš„è·¯å¾„ã€‚

+   `commit_message` (`str`, *å¯é€‰*) â€” æ¨é€æ—¶è¦æäº¤çš„æ¶ˆæ¯ã€‚é»˜è®¤ä¸º `"Upload {object}"`ã€‚

+   `private` (`bool`, *å¯é€‰*) â€” åˆ›å»ºçš„å­˜å‚¨åº“æ˜¯å¦åº”ä¸ºç§æœ‰ã€‚

+   `token` (`str`, *å¯é€‰*) â€” ç”¨ä½œè¿œç¨‹æ–‡ä»¶çš„ HTTP bearer æˆæƒçš„ä»¤ç‰Œã€‚åœ¨è¿è¡Œ `huggingface-cli login` æ—¶ç”Ÿæˆçš„ä»¤ç‰Œï¼ˆå­˜å‚¨åœ¨ `~/.huggingface` ä¸­ï¼‰ã€‚

+   `create_pr` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º `False`) â€” æ˜¯å¦åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸Šä¼ æ–‡ä»¶çš„ PR æˆ–ç›´æ¥æäº¤ã€‚

+   `safe_serialization` (`bool`, *å¯é€‰*, é»˜è®¤ä¸º `True`) â€” æ˜¯å¦å°†æ¨¡å‹æƒé‡è½¬æ¢ä¸º `safetensors` æ ¼å¼ã€‚

+   `variant` (`str`, *å¯é€‰*) â€” å¦‚æœæŒ‡å®šï¼Œæƒé‡å°†ä»¥ `pytorch_model.<variant>.bin` æ ¼å¼ä¿å­˜ã€‚

å°†æ¨¡å‹ã€è°ƒåº¦å™¨æˆ–æµæ°´çº¿æ–‡ä»¶ä¸Šä¼ åˆ°ğŸ¤— Hugging Face Hubã€‚

ç¤ºä¾‹ï¼š

```py
from diffusers import UNet2DConditionModel

unet = UNet2DConditionModel.from_pretrained("stabilityai/stable-diffusion-2", subfolder="unet")

# Push the `unet` to your namespace with the name "my-finetuned-unet".
unet.push_to_hub("my-finetuned-unet")

# Push the `unet` to an organization with the name "my-finetuned-unet".
unet.push_to_hub("your-org/my-finetuned-unet")
```
