# Autoformer

> åŸå§‹æ–‡æœ¬ï¼š[https://huggingface.co/docs/transformers/v4.37.2/en/model_doc/autoformer](https://huggingface.co/docs/transformers/v4.37.2/en/model_doc/autoformer)

## æ¦‚è¿°

Autoformeræ¨¡å‹æ˜¯ç”±Haixu Wuï¼ŒJiehui Xuï¼ŒJianmin Wangï¼ŒMingsheng Longåœ¨[Autoformer: Decomposition Transformers with Auto-Correlation for Long-Term Series Forecasting](https://arxiv.org/abs/2106.13008)ä¸­æå‡ºçš„ã€‚

è¯¥æ¨¡å‹å°†Transformerä½œä¸ºæ·±åº¦åˆ†è§£æ¶æ„ï¼Œå¯ä»¥åœ¨é¢„æµ‹è¿‡ç¨‹ä¸­é€æ­¥åˆ†è§£è¶‹åŠ¿å’Œå­£èŠ‚æ€§ç»„ä»¶ã€‚

è®ºæ–‡æ‘˜è¦å¦‚ä¸‹ï¼š

*å»¶é•¿é¢„æµ‹æ—¶é—´æ˜¯çœŸå®åº”ç”¨çš„å…³é”®éœ€æ±‚ï¼Œä¾‹å¦‚æç«¯å¤©æ°”é¢„è­¦å’Œé•¿æœŸèƒ½æºæ¶ˆè€—è§„åˆ’ã€‚æœ¬æ–‡ç ”ç©¶äº†æ—¶é—´åºåˆ—çš„é•¿æœŸé¢„æµ‹é—®é¢˜ã€‚ä¹‹å‰åŸºäºTransformerçš„æ¨¡å‹é‡‡ç”¨å„ç§è‡ªæ³¨æ„æœºåˆ¶æ¥å‘ç°é•¿è·ç¦»ä¾èµ–å…³ç³»ã€‚ç„¶è€Œï¼Œé•¿æœŸæœªæ¥çš„å¤æ‚æ—¶é—´æ¨¡å¼é˜»ç¢äº†æ¨¡å‹æ‰¾åˆ°å¯é çš„ä¾èµ–å…³ç³»ã€‚æ­¤å¤–ï¼Œä¸ºäº†é•¿åºåˆ—çš„æ•ˆç‡ï¼ŒTransformerå¿…é¡»é‡‡ç”¨ç¨€ç–ç‰ˆæœ¬çš„ç‚¹å¯¹ç‚¹è‡ªæ³¨æ„åŠ›ï¼Œå¯¼è‡´ä¿¡æ¯åˆ©ç”¨ç“¶é¢ˆã€‚è¶…è¶ŠTransformerï¼Œæˆ‘ä»¬è®¾è®¡Autoformerä½œä¸ºä¸€ç§å…·æœ‰è‡ªç›¸å…³æœºåˆ¶çš„æ–°å‹åˆ†è§£æ¶æ„ã€‚æˆ‘ä»¬æ‰“ç ´äº†ç³»åˆ—åˆ†è§£çš„é¢„å¤„ç†æƒ¯ä¾‹ï¼Œå¹¶å°†å…¶æ”¹é€ ä¸ºæ·±åº¦æ¨¡å‹çš„åŸºæœ¬å†…éƒ¨å—ã€‚è¿™ç§è®¾è®¡èµ‹äºˆAutoformerå¯¹å¤æ‚æ—¶é—´åºåˆ—çš„æ¸è¿›åˆ†è§£èƒ½åŠ›ã€‚æ­¤å¤–ï¼Œå—éšæœºè¿‡ç¨‹ç†è®ºå¯å‘ï¼Œæˆ‘ä»¬è®¾è®¡äº†åŸºäºç³»åˆ—å‘¨æœŸæ€§çš„è‡ªç›¸å…³æœºåˆ¶ï¼Œå®ƒåœ¨å­ç³»åˆ—çº§åˆ«è¿›è¡Œä¾èµ–å…³ç³»å‘ç°å’Œè¡¨ç¤ºèšåˆã€‚è‡ªç›¸å…³åœ¨æ•ˆç‡å’Œå‡†ç¡®æ€§æ–¹é¢ä¼˜äºè‡ªæ³¨æ„åŠ›ã€‚åœ¨é•¿æœŸé¢„æµ‹ä¸­ï¼ŒAutoformerå–å¾—äº†æœ€å…ˆè¿›çš„å‡†ç¡®æ€§ï¼Œåœ¨å…­ä¸ªåŸºå‡†æµ‹è¯•ä¸­ç›¸å¯¹æé«˜äº†38ï¼…ï¼Œæ¶µç›–äº†äº”ä¸ªå®é™…åº”ç”¨ï¼šèƒ½æºï¼Œäº¤é€šï¼Œç»æµï¼Œå¤©æ°”å’Œç–¾ç—…ã€‚*

è¯¥æ¨¡å‹ç”±[elisim](https://huggingface.co/elisim)å’Œ[kashif](https://huggingface.co/kashif)è´¡çŒ®ã€‚åŸå§‹ä»£ç å¯ä»¥åœ¨[æ­¤å¤„](https://github.com/thuml/Autoformer)æ‰¾åˆ°ã€‚

## èµ„æº

ä¸€ç³»åˆ—å®˜æ–¹Hugging Faceå’Œç¤¾åŒºï¼ˆç”±ğŸŒè¡¨ç¤ºï¼‰èµ„æºï¼Œå¯å¸®åŠ©æ‚¨å…¥é—¨ã€‚å¦‚æœæ‚¨æœ‰å…´è¶£æäº¤èµ„æºä»¥åŒ…å«åœ¨æ­¤å¤„ï¼Œè¯·éšæ—¶æ‰“å¼€Pull Requestï¼Œæˆ‘ä»¬å°†è¿›è¡Œå®¡æŸ¥ï¼èµ„æºåº”è¯¥ç†æƒ³åœ°å±•ç¤ºä¸€äº›æ–°ä¸œè¥¿ï¼Œè€Œä¸æ˜¯é‡å¤ç°æœ‰èµ„æºã€‚

+   åœ¨HuggingFaceåšå®¢ä¸­æŸ¥çœ‹Autoformeråšæ–‡ï¼š[æ˜¯çš„ï¼ŒTransformerså¯¹æ—¶é—´åºåˆ—é¢„æµ‹æœ‰æ•ˆï¼ˆ+ Autoformerï¼‰](https://huggingface.co/blog/autoformer)

## AutoformerConfig

### `class transformers.AutoformerConfig`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/autoformer/configuration_autoformer.py#L30)

```py
( prediction_length: Optional = None context_length: Optional = None distribution_output: str = 'student_t' loss: str = 'nll' input_size: int = 1 lags_sequence: List = [1, 2, 3, 4, 5, 6, 7] scaling: bool = True num_time_features: int = 0 num_dynamic_real_features: int = 0 num_static_categorical_features: int = 0 num_static_real_features: int = 0 cardinality: Optional = None embedding_dimension: Optional = None d_model: int = 64 encoder_attention_heads: int = 2 decoder_attention_heads: int = 2 encoder_layers: int = 2 decoder_layers: int = 2 encoder_ffn_dim: int = 32 decoder_ffn_dim: int = 32 activation_function: str = 'gelu' dropout: float = 0.1 encoder_layerdrop: float = 0.1 decoder_layerdrop: float = 0.1 attention_dropout: float = 0.1 activation_dropout: float = 0.1 num_parallel_samples: int = 100 init_std: float = 0.02 use_cache: bool = True is_encoder_decoder = True label_length: int = 10 moving_average: int = 25 autocorrelation_factor: int = 3 **kwargs )
```

å‚æ•°

+   `prediction_length`ï¼ˆ`int`ï¼‰â€” è§£ç å™¨çš„é¢„æµ‹é•¿åº¦ã€‚æ¢å¥è¯è¯´ï¼Œæ¨¡å‹çš„é¢„æµ‹æ—¶é—´èŒƒå›´ã€‚

+   `context_length`ï¼ˆ`int`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`prediction_length`ï¼‰â€” ç¼–ç å™¨çš„ä¸Šä¸‹æ–‡é•¿åº¦ã€‚å¦‚æœæœªè®¾ç½®ï¼Œä¸Šä¸‹æ–‡é•¿åº¦å°†ä¸`prediction_length`ç›¸åŒã€‚

+   `distribution_output`ï¼ˆ`string`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`"student_t"`ï¼‰â€” æ¨¡å‹çš„åˆ†å¸ƒå‘å°„å¤´ã€‚å¯ä»¥æ˜¯`"student_t"`ï¼Œâ€œnormalâ€æˆ–â€œnegative_binomialâ€ã€‚

+   `loss`ï¼ˆ`string`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`"nll"`ï¼‰â€” ä¸`distribution_output`å¤´éƒ¨å¯¹åº”çš„æ¨¡å‹çš„æŸå¤±å‡½æ•°ã€‚å¯¹äºå‚æ•°åˆ†å¸ƒï¼Œå®ƒæ˜¯è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼ˆnllï¼‰- ç›®å‰æ˜¯å”¯ä¸€æ”¯æŒçš„ã€‚

+   `input_size`ï¼ˆ`int`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º1ï¼‰â€” ç›®æ ‡å˜é‡çš„å¤§å°ï¼Œé»˜è®¤æƒ…å†µä¸‹å¯¹äºå•å˜é‡ç›®æ ‡ä¸º1ã€‚åœ¨å¤šå˜é‡ç›®æ ‡çš„æƒ…å†µä¸‹ä¼šå¤§äº1ã€‚

+   `lags_sequence` (`list[int]`, *optional*, defaults to `[1, 2, 3, 4, 5, 6, 7]`) â€” è¾“å…¥æ—¶é—´åºåˆ—çš„æ»åä½œä¸ºåå˜é‡ï¼Œé€šå¸¸ç”±é¢‘ç‡å†³å®šã€‚é»˜è®¤ä¸º`[1, 2, 3, 4, 5, 6, 7]`ã€‚

+   `scaling` (`bool`, *optional* defaults to `True`) â€” æ˜¯å¦å¯¹è¾“å…¥ç›®æ ‡è¿›è¡Œç¼©æ”¾ã€‚

+   `num_time_features` (`int`, *optional*, defaults to 0) â€” è¾“å…¥æ—¶é—´åºåˆ—ä¸­çš„æ—¶é—´ç‰¹å¾æ•°é‡ã€‚

+   `num_dynamic_real_features` (`int`, *optional*, defaults to 0) â€” åŠ¨æ€å®å€¼ç‰¹å¾çš„æ•°é‡ã€‚

+   `num_static_categorical_features` (`int`, *optional*, defaults to 0) â€” é™æ€åˆ†ç±»ç‰¹å¾çš„æ•°é‡ã€‚

+   `num_static_real_features` (`int`, *optional*, defaults to 0) â€” é™æ€å®å€¼ç‰¹å¾çš„æ•°é‡ã€‚

+   `cardinality` (`list[int]`, *optional*) â€” æ¯ä¸ªé™æ€åˆ†ç±»ç‰¹å¾çš„åŸºæ•°ï¼ˆä¸åŒå€¼çš„æ•°é‡ï¼‰ã€‚åº”è¯¥æ˜¯ä¸€ä¸ªæ•´æ•°åˆ—è¡¨ï¼Œé•¿åº¦ä¸`num_static_categorical_features`ç›¸åŒã€‚å¦‚æœ`num_static_categorical_features`å¤§äº0ï¼Œåˆ™ä¸èƒ½ä¸º`None`ã€‚

+   `embedding_dimension` (`list[int]`, *optional*) â€” æ¯ä¸ªé™æ€åˆ†ç±»ç‰¹å¾çš„åµŒå…¥ç»´åº¦ã€‚åº”è¯¥æ˜¯ä¸€ä¸ªæ•´æ•°åˆ—è¡¨ï¼Œé•¿åº¦ä¸`num_static_categorical_features`ç›¸åŒã€‚å¦‚æœ`num_static_categorical_features`å¤§äº0ï¼Œåˆ™ä¸èƒ½ä¸º`None`ã€‚

+   `d_model` (`int`, *optional*, defaults to 64) â€” Transformerå±‚çš„ç»´åº¦ã€‚

+   `encoder_layers` (`int`, *optional*, defaults to 2) â€” ç¼–ç å™¨å±‚çš„æ•°é‡ã€‚

+   `decoder_layers` (`int`, *optional*, defaults to 2) â€” è§£ç å™¨å±‚çš„æ•°é‡ã€‚

+   `encoder_attention_heads` (`int`, *optional*, defaults to 2) â€” Transformerç¼–ç å™¨ä¸­æ¯ä¸ªæ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›å¤´æ•°ã€‚

+   `decoder_attention_heads` (`int`, *optional*, defaults to 2) â€” Transformerè§£ç å™¨ä¸­æ¯ä¸ªæ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›å¤´æ•°ã€‚

+   `encoder_ffn_dim` (`int`, *optional*, defaults to 32) â€” ç¼–ç å™¨ä¸­â€œä¸­é—´â€ï¼ˆé€šå¸¸ç§°ä¸ºå‰é¦ˆï¼‰å±‚çš„ç»´åº¦ã€‚

+   `decoder_ffn_dim` (`int`, *optional*, defaults to 32) â€” è§£ç å™¨ä¸­â€œä¸­é—´â€ï¼ˆé€šå¸¸ç§°ä¸ºå‰é¦ˆï¼‰å±‚çš„ç»´åº¦ã€‚

+   `activation_function` (`str` or `function`, *optional*, defaults to `"gelu"`) â€” ç¼–ç å™¨å’Œè§£ç å™¨ä¸­çš„éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆå‡½æ•°æˆ–å­—ç¬¦ä¸²ï¼‰ã€‚å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œæ”¯æŒ`"gelu"`å’Œ`"relu"`ã€‚

+   `dropout` (`float`, *optional*, defaults to 0.1) â€” ç¼–ç å™¨å’Œè§£ç å™¨ä¸­æ‰€æœ‰å…¨è¿æ¥å±‚çš„ä¸¢å¼ƒæ¦‚ç‡ã€‚

+   `encoder_layerdrop` (`float`, *optional*, defaults to 0.1) â€” æ¯ä¸ªç¼–ç å™¨å±‚çš„æ³¨æ„åŠ›å’Œå…¨è¿æ¥å±‚çš„ä¸¢å¼ƒæ¦‚ç‡ã€‚

+   `decoder_layerdrop` (`float`, *optional*, defaults to 0.1) â€” æ¯ä¸ªè§£ç å™¨å±‚çš„æ³¨æ„åŠ›å’Œå…¨è¿æ¥å±‚çš„ä¸¢å¼ƒæ¦‚ç‡ã€‚

+   `attention_dropout` (`float`, *optional*, defaults to 0.1) â€” æ³¨æ„åŠ›æ¦‚ç‡çš„ä¸¢å¼ƒæ¦‚ç‡ã€‚

+   `activation_dropout` (`float`, *optional*, defaults to 0.1) â€” åœ¨å‰é¦ˆç½‘ç»œçš„ä¸¤å±‚ä¹‹é—´ä½¿ç”¨çš„ä¸¢å¼ƒæ¦‚ç‡ã€‚

+   `num_parallel_samples` (`int`, *optional*, defaults to 100) â€” æ¯ä¸ªæ¨æ–­æ—¶é—´æ­¥ç”Ÿæˆçš„å¹¶è¡Œæ ·æœ¬æ•°é‡ã€‚

+   `init_std` (`float`, *optional*, defaults to 0.02) â€” æˆªæ–­æ­£æ€æƒé‡åˆå§‹åŒ–åˆ†å¸ƒçš„æ ‡å‡†å·®ã€‚

+   `use_cache` (`bool`, *optional*, defaults to `True`) â€” æ˜¯å¦ä½¿ç”¨è¿‡å»çš„é”®/å€¼æ³¨æ„åŠ›ï¼ˆå¦‚æœé€‚ç”¨äºæ¨¡å‹ï¼‰ä»¥åŠ é€Ÿè§£ç ã€‚

+   `label_length` (`int`, *optional*, defaults to 10) â€” Autoformerè§£ç å™¨çš„èµ·å§‹æ ‡è®°é•¿åº¦ï¼Œç”¨äºç›´æ¥å¤šæ­¥é¢„æµ‹ï¼ˆå³éè‡ªå›å½’ç”Ÿæˆï¼‰ã€‚

+   `moving_average` (`int`, defaults to 25) â€” ç§»åŠ¨å¹³å‡çš„çª—å£å¤§å°ã€‚åœ¨å®è·µä¸­ï¼Œå®ƒæ˜¯åˆ†è§£å±‚çš„AvgPool1dä¸­çš„æ ¸å¤§å°ã€‚

+   `autocorrelation_factor` (`int`, defaults to 3) â€” â€œæ³¨æ„åŠ›â€ï¼ˆå³è‡ªç›¸å…³æœºåˆ¶ï¼‰å› å­ï¼Œç”¨äºæ‰¾åˆ°å‰kä¸ªè‡ªç›¸å…³å»¶è¿Ÿã€‚å»ºè®®åœ¨è®ºæ–‡ä¸­å°†å…¶è®¾ç½®ä¸º1åˆ°5ä¹‹é—´çš„æ•°å­—ã€‚

è¿™æ˜¯ç”¨äºå­˜å‚¨[AutoformerModel](/docs/transformers/v4.37.2/en/model_doc/autoformer#transformers.AutoformerModel)é…ç½®çš„é…ç½®ç±»ã€‚å®ƒç”¨äºæ ¹æ®æŒ‡å®šçš„å‚æ•°å®ä¾‹åŒ–Autoformeræ¨¡å‹ï¼Œå®šä¹‰æ¨¡å‹æ¶æ„ã€‚ä½¿ç”¨é»˜è®¤å€¼å®ä¾‹åŒ–é…ç½®å°†äº§ç”Ÿç±»ä¼¼äºAutoformer [huggingface/autoformer-tourism-monthly](https://huggingface.co/huggingface/autoformer-tourism-monthly)æ¶æ„çš„é…ç½®ã€‚

é…ç½®å¯¹è±¡ç»§æ‰¿è‡ª[PretrainedConfig](/docs/transformers/v4.37.2/en/main_classes/configuration#transformers.PretrainedConfig)ï¼Œå¯ç”¨äºæ§åˆ¶æ¨¡å‹è¾“å‡ºã€‚é˜…è¯»[PretrainedConfig](/docs/transformers/v4.37.2/en/main_classes/configuration#transformers.PretrainedConfig)çš„æ–‡æ¡£ä»¥è·å–æ›´å¤šä¿¡æ¯ã€‚

```py
>>> from transformers import AutoformerConfig, AutoformerModel

>>> # Initializing a default Autoformer configuration
>>> configuration = AutoformerConfig()

>>> # Randomly initializing a model (with random weights) from the configuration
>>> model = AutoformerModel(configuration)

>>> # Accessing the model configuration
>>> configuration = model.config
```

## AutoformerModel

### `class transformers.AutoformerModel`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/autoformer/modeling_autoformer.py#L1429)

```py
( config: AutoformerConfig )
```

å‚æ•°

+   `config`ï¼ˆ[AutoformerConfig](/docs/transformers/v4.37.2/en/model_doc/autoformer#transformers.AutoformerConfig)ï¼‰â€” æ¨¡å‹çš„æ‰€æœ‰å‚æ•°çš„æ¨¡å‹é…ç½®ç±»ã€‚ä½¿ç”¨é…ç½®æ–‡ä»¶åˆå§‹åŒ–ä¸ä¼šåŠ è½½ä¸æ¨¡å‹å…³è”çš„æƒé‡ï¼ŒåªåŠ è½½é…ç½®ã€‚æŸ¥çœ‹[from_pretrained()](/docs/transformers/v4.37.2/en/main_classes/model#transformers.PreTrainedModel.from_pretrained)æ–¹æ³•ä»¥åŠ è½½æ¨¡å‹æƒé‡ã€‚

è£¸Autoformeræ¨¡å‹è¾“å‡ºåŸå§‹éšè—çŠ¶æ€ï¼Œæ²¡æœ‰ç‰¹å®šçš„å¤´éƒ¨ã€‚è¯¥æ¨¡å‹ç»§æ‰¿è‡ª[PreTrainedModel](/docs/transformers/v4.37.2/en/main_classes/model#transformers.PreTrainedModel)ã€‚æŸ¥çœ‹è¶…ç±»æ–‡æ¡£ä»¥äº†è§£åº“ä¸ºæ‰€æœ‰æ¨¡å‹å®ç°çš„é€šç”¨æ–¹æ³•ï¼ˆå¦‚ä¸‹è½½æˆ–ä¿å­˜ã€è°ƒæ•´è¾“å…¥åµŒå…¥ã€ä¿®å‰ªå¤´ç­‰ï¼‰ã€‚

è¯¥æ¨¡å‹è¿˜æ˜¯PyTorch [torch.nn.Module](https://pytorch.org/docs/stable/nn.html#torch.nn.Module)å­ç±»ã€‚å°†å…¶ç”¨ä½œå¸¸è§„PyTorchæ¨¡å—ï¼Œå¹¶å‚è€ƒPyTorchæ–‡æ¡£ä»¥è·å–æœ‰å…³ä¸€èˆ¬ç”¨æ³•å’Œè¡Œä¸ºçš„æ‰€æœ‰ç›¸å…³ä¿¡æ¯ã€‚

#### `forward`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/autoformer/modeling_autoformer.py#L1607)

```py
( past_values: Tensor past_time_features: Tensor past_observed_mask: Tensor static_categorical_features: Optional = None static_real_features: Optional = None future_values: Optional = None future_time_features: Optional = None decoder_attention_mask: Optional = None head_mask: Optional = None decoder_head_mask: Optional = None cross_attn_head_mask: Optional = None encoder_outputs: Optional = None past_key_values: Optional = None output_hidden_states: Optional = None output_attentions: Optional = None use_cache: Optional = None return_dict: Optional = None ) â†’ export const metadata = 'undefined';transformers.models.autoformer.modeling_autoformer.AutoformerModelOutput or tuple(torch.FloatTensor)
```

å‚æ•°

+   `past_values` (`torch.FloatTensor` of shape `(batch_size, sequence_length)`) â€” æ—¶é—´åºåˆ—çš„è¿‡å»å€¼ï¼Œç”¨ä½œä¸Šä¸‹æ–‡ä»¥é¢„æµ‹æœªæ¥ã€‚è¿™äº›å€¼å¯èƒ½åŒ…å«æ»åï¼Œå³è¿‡å»çš„é™„åŠ å€¼ï¼Œè¿™äº›å€¼è¢«æ·»åŠ ä»¥å……å½“â€œé¢å¤–ä¸Šä¸‹æ–‡â€ã€‚`past_values` æ˜¯Transformerç¼–ç å™¨æ¥æ”¶çš„è¾“å…¥ï¼ˆè¿˜å¯ä»¥åŒ…æ‹¬å¯é€‰çš„å…¶ä»–ç‰¹å¾ï¼Œå¦‚`static_categorical_features`ã€`static_real_features`ã€`past_time_features`ï¼‰ã€‚

    è¿™é‡Œçš„åºåˆ—é•¿åº¦ç­‰äº`context_length` + `max(config.lags_sequence)`ã€‚

    ç¼ºå¤±å€¼éœ€è¦ç”¨é›¶æ›¿æ¢ã€‚

+   `past_time_features` (`torch.FloatTensor` of shape `(batch_size, sequence_length, num_features)`, *å¯é€‰*) â€” å¯é€‰çš„æ—¶é—´ç‰¹å¾ï¼Œæ¨¡å‹å†…éƒ¨å°†æ·»åŠ åˆ°`past_values`ä¸­ã€‚è¿™äº›å¯èƒ½æ˜¯è¯¸å¦‚â€œå¹´ä»½ä¸­çš„æœˆä»½â€ã€â€œæœˆä»½ä¸­çš„æ—¥æœŸâ€ç­‰ç¼–ç ä¸ºå‘é‡ï¼ˆä¾‹å¦‚ä½œä¸ºå‚…ç«‹å¶ç‰¹å¾ï¼‰çš„å†…å®¹ã€‚è¿™äº›ä¹Ÿå¯ä»¥æ˜¯æ‰€è°“çš„â€œå¹´é¾„â€ç‰¹å¾ï¼ŒåŸºæœ¬ä¸Šå¸®åŠ©æ¨¡å‹çŸ¥é“æ—¶é—´åºåˆ—å¤„äºâ€œç”Ÿå‘½ä¸­çš„å“ªä¸ªé˜¶æ®µâ€ã€‚å¹´é¾„ç‰¹å¾å¯¹äºè¿œå¤„çš„è¿‡å»æ—¶é—´æ­¥å…·æœ‰è¾ƒå°çš„å€¼ï¼Œå¹¶ä¸”éšç€æˆ‘ä»¬æ¥è¿‘å½“å‰æ—¶é—´æ­¥è€Œå•è°ƒå¢åŠ ã€‚

    è¿™äº›ç‰¹å¾å……å½“è¾“å…¥çš„â€œä½ç½®ç¼–ç â€ã€‚å› æ­¤ï¼Œä¸BERTè¿™æ ·çš„æ¨¡å‹ä¸åŒï¼ŒBERTçš„ä½ç½®ç¼–ç æ˜¯ä»å¤´å¼€å§‹å†…éƒ¨ä½œä¸ºæ¨¡å‹çš„å‚æ•°å­¦ä¹ çš„ï¼Œæ—¶é—´åºåˆ—Transformeréœ€è¦æä¾›é¢å¤–çš„æ—¶é—´ç‰¹å¾ã€‚

    Autoformerä»…ä¸º`static_categorical_features`å­¦ä¹ é¢å¤–çš„åµŒå…¥ã€‚

+   `past_observed_mask` (`torch.BoolTensor` of shape `(batch_size, sequence_length)`, *optional*) â€” å¸ƒå°”æ©ç ï¼ŒæŒ‡ç¤ºå“ªäº› `past_values` è¢«è§‚å¯Ÿåˆ°ï¼Œå“ªäº›æ˜¯ç¼ºå¤±çš„ã€‚æ©ç å€¼é€‰åœ¨ `[0, 1]` ä¹‹é—´ï¼š

    +   1 è¡¨ç¤ºå€¼ä¸º `observed`,

    +   0 è¡¨ç¤ºå€¼ä¸º `missing`ï¼ˆå³è¢«é›¶æ›¿æ¢çš„ NaNï¼‰ã€‚

+   `static_categorical_features` (`torch.LongTensor` of shape `(batch_size, number of static categorical features)`, *optional*) â€” æ¨¡å‹å°†å­¦ä¹ çš„å¯é€‰é™æ€åˆ†ç±»ç‰¹å¾çš„åµŒå…¥ï¼Œå°†å…¶æ·»åŠ åˆ°æ—¶é—´åºåˆ—çš„å€¼ä¸­ã€‚

    é™æ€åˆ†ç±»ç‰¹å¾æ˜¯æ‰€æœ‰æ—¶é—´æ­¥é•¿å…·æœ‰ç›¸åŒå€¼çš„ç‰¹å¾ï¼ˆéšæ—¶é—´ä¿æŒä¸å˜ï¼‰ã€‚

    é™æ€åˆ†ç±»ç‰¹å¾çš„å…¸å‹ç¤ºä¾‹æ˜¯æ—¶é—´åºåˆ— IDã€‚

+   `static_real_features` (`torch.FloatTensor` of shape `(batch_size, number of static real features)`, *optional*) â€” å¯é€‰çš„é™æ€å®æ•°ç‰¹å¾ï¼Œæ¨¡å‹å°†å°†å…¶æ·»åŠ åˆ°æ—¶é—´åºåˆ—çš„å€¼ä¸­ã€‚

    é™æ€å®æ•°ç‰¹å¾æ˜¯æ‰€æœ‰æ—¶é—´æ­¥é•¿å…·æœ‰ç›¸åŒå€¼çš„ç‰¹å¾ï¼ˆéšæ—¶é—´ä¿æŒä¸å˜ï¼‰ã€‚

    é™æ€å®æ•°ç‰¹å¾çš„å…¸å‹ç¤ºä¾‹æ˜¯ä¿ƒé”€ä¿¡æ¯ã€‚

+   `future_values` (`torch.FloatTensor` of shape `(batch_size, prediction_length)`) â€” æ—¶é—´åºåˆ—çš„æœªæ¥å€¼ï¼Œä½œä¸ºæ¨¡å‹çš„æ ‡ç­¾ã€‚`future_values` æ˜¯ Transformer éœ€è¦å­¦ä¹ è¾“å‡ºçš„å†…å®¹ï¼Œç»™å®š `past_values`ã€‚

    æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ¼”ç¤ºç¬”è®°æœ¬å’Œä»£ç ç‰‡æ®µã€‚

    ç¼ºå¤±å€¼éœ€è¦ç”¨é›¶æ›¿æ¢ã€‚

+   `future_time_features` (`torch.FloatTensor` of shape `(batch_size, prediction_length, num_features)`, *optional*) â€” å¯é€‰çš„æ—¶é—´ç‰¹å¾ï¼Œæ¨¡å‹å°†å†…éƒ¨æ·»åŠ åˆ° `future_values` ä¸­ã€‚è¿™äº›å¯èƒ½æ˜¯åƒâ€œå¹´ä»½çš„æœˆä»½â€ï¼Œâ€œæœˆä»½çš„æ—¥æœŸâ€ç­‰ç¼–ç ä¸ºå‘é‡ï¼ˆä¾‹å¦‚å‚…ç«‹å¶ç‰¹å¾ï¼‰çš„å†…å®¹ã€‚è¿™ä¹Ÿå¯èƒ½æ˜¯æ‰€è°“çš„â€œå¹´é¾„â€ç‰¹å¾ï¼ŒåŸºæœ¬ä¸Šå¸®åŠ©æ¨¡å‹çŸ¥é“æ—¶é—´åºåˆ—å¤„äºâ€œç”Ÿå‘½ä¸­çš„å“ªä¸ªé˜¶æ®µâ€ã€‚å¹´é¾„ç‰¹å¾å¯¹äºè¿œå¤„çš„è¿‡å»æ—¶é—´æ­¥å…·æœ‰è¾ƒå°çš„å€¼ï¼Œå¹¶ä¸”éšç€æˆ‘ä»¬æ¥è¿‘å½“å‰æ—¶é—´æ­¥è€Œå•è°ƒå¢åŠ ã€‚

    è¿™äº›ç‰¹å¾ä½œä¸ºè¾“å…¥çš„â€œä½ç½®ç¼–ç â€ã€‚ä¸åƒ BERT è¿™æ ·çš„æ¨¡å‹ä¸åŒï¼ŒBERT çš„ä½ç½®ç¼–ç æ˜¯ä»å¤´å¼€å§‹å†…éƒ¨ä½œä¸ºæ¨¡å‹çš„å‚æ•°å­¦ä¹ çš„ï¼Œæ—¶é—´åºåˆ— Transformer éœ€è¦æä¾›é¢å¤–çš„ç‰¹å¾ã€‚

    Autoformer ä»…ä¸º `static_categorical_features` å­¦ä¹ é¢å¤–çš„åµŒå…¥ã€‚

+   `attention_mask` (`torch.Tensor` of shape `(batch_size, sequence_length)`, *optional*) â€” ç”¨äºé¿å…åœ¨æŸäº›æ ‡è®°ç´¢å¼•ä¸Šæ‰§è¡Œæ³¨æ„åŠ›çš„æ©ç ã€‚æ©ç å€¼é€‰åœ¨ `[0, 1]` ä¹‹é—´ï¼š

    +   1 è¡¨ç¤ºæ ‡è®°æœªè¢«æ©ç ï¼Œ

    +   0 è¡¨ç¤ºæ ‡è®°è¢«æ©ç ã€‚

    [ä»€ä¹ˆæ˜¯æ³¨æ„åŠ›æ©ç ï¼Ÿ](../glossary#attention-mask)

+   `decoder_attention_mask` (`torch.LongTensor` of shape `(batch_size, target_sequence_length)`, *optional*) â€” ç”¨äºé¿å…åœ¨æŸäº›æ ‡è®°ç´¢å¼•ä¸Šæ‰§è¡Œæ³¨æ„åŠ›çš„æ©ç ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†ä½¿ç”¨å› æœæ©ç ï¼Œä»¥ç¡®ä¿æ¨¡å‹åªèƒ½æŸ¥çœ‹ä»¥å‰çš„è¾“å…¥ä»¥é¢„æµ‹æœªæ¥ã€‚

+   `head_mask` (`torch.Tensor` of shape `(encoder_layers, encoder_attention_heads)`, *optional*) â€” ç”¨äºåœ¨ç¼–ç å™¨ä¸­ä½¿æ³¨æ„åŠ›æ¨¡å—çš„ç‰¹å®šå¤´éƒ¨å¤±æ•ˆçš„æ©ç ã€‚æ©ç å€¼é€‰åœ¨ `[0, 1]` ä¹‹é—´ï¼š

    +   1 è¡¨ç¤ºå¤´éƒ¨æœªè¢«æ©ç ï¼Œ

    +   0 è¡¨ç¤ºå¤´éƒ¨è¢«æ©ç ã€‚

+   `decoder_head_mask` (`torch.Tensor` of shape `(decoder_layers, decoder_attention_heads)`, *optional*) â€” ç”¨äºåœ¨è§£ç å™¨ä¸­ä½¿æ³¨æ„åŠ›æ¨¡å—çš„ç‰¹å®šå¤´éƒ¨å¤±æ•ˆçš„æ©ç ã€‚æ©ç å€¼é€‰åœ¨ `[0, 1]` ä¹‹é—´ï¼š

    +   1 è¡¨ç¤ºå¤´éƒ¨æœªè¢«æ©ç ï¼Œ

    +   0 è¡¨ç¤ºå¤´éƒ¨è¢«æ©ç ã€‚

+   `cross_attn_head_mask` (`torch.Tensor` of shape `(decoder_layers, decoder_attention_heads)`, *optional*) â€” ç”¨äºä½¿äº¤å‰æ³¨æ„åŠ›æ¨¡å—çš„ç‰¹å®šå¤´éƒ¨å¤±æ•ˆçš„æ©ç ã€‚æ©ç å€¼é€‰åœ¨ `[0, 1]` ä¹‹é—´ï¼š

    +   1 è¡¨ç¤ºå¤´éƒ¨æœªè¢«æ©ç ï¼Œ

    +   0 è¡¨ç¤ºå¤´éƒ¨è¢«æ©ç ã€‚

+   `encoder_outputs` (`tuple(tuple(torch.FloatTensor)`, *optional*) â€” å…ƒç»„åŒ…æ‹¬`last_hidden_state`ã€`hidden_states` (*optional*) å’Œ `attentions` (*optional*)ã€‚`last_hidden_state`çš„å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)` (*optional*)ï¼Œæ˜¯ç¼–ç å™¨æœ€åä¸€å±‚çš„éšè—çŠ¶æ€åºåˆ—ã€‚ç”¨äºè§£ç å™¨çš„äº¤å‰æ³¨æ„åŠ›ã€‚

+   `past_key_values` (`tuple(tuple(torch.FloatTensor))`, *optional*, å½“ä¼ é€’`use_cache=True`æˆ–`config.use_cache=True`æ—¶è¿”å› â€” é•¿åº¦ä¸º`config.n_layers`çš„å…ƒç»„ï¼Œæ¯ä¸ªå…ƒç»„æœ‰2ä¸ªå½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, embed_size_per_head)`çš„å¼ é‡ï¼Œä»¥åŠ2ä¸ªé¢å¤–çš„å½¢çŠ¶ä¸º`(batch_size, num_heads, encoder_sequence_length, embed_size_per_head)`çš„å¼ é‡ã€‚

    åŒ…å«é¢„å…ˆè®¡ç®—çš„éšè—çŠ¶æ€ï¼ˆè‡ªæ³¨æ„åŠ›å—å’Œäº¤å‰æ³¨æ„åŠ›å—ä¸­çš„é”®å’Œå€¼ï¼‰ï¼Œå¯ç”¨äºåŠ é€Ÿé¡ºåºè§£ç ï¼ˆå‚è§`past_key_values`è¾“å…¥ï¼‰ã€‚

    å¦‚æœä½¿ç”¨`past_key_values`ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©ä»…è¾“å…¥æœ€åä¸€ä¸ª`decoder_input_ids`ï¼ˆè¿™äº›æ²¡æœ‰ç»™å‡ºå…¶è¿‡å»é”®å€¼çŠ¶æ€çš„æ¨¡å‹ï¼‰çš„å½¢çŠ¶ä¸º`(batch_size, 1)`ï¼Œè€Œä¸æ˜¯æ‰€æœ‰å½¢çŠ¶ä¸º`(batch_size, sequence_length)`çš„`decoder_input_ids`ã€‚

+   `inputs_embeds` (`torch.FloatTensor`çš„å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`ï¼Œ*optional*) â€” å¯é€‰åœ°ï¼Œå¯ä»¥ç›´æ¥ä¼ é€’åµŒå…¥è¡¨ç¤ºï¼Œè€Œä¸æ˜¯ä¼ é€’`input_ids`ã€‚å¦‚æœæ‚¨æƒ³è¦æ›´å¤šæ§åˆ¶å¦‚ä½•å°†`input_ids`ç´¢å¼•è½¬æ¢ä¸ºç›¸å…³å‘é‡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ¨¡å‹çš„å†…éƒ¨åµŒå…¥æŸ¥æ‰¾çŸ©é˜µï¼Œåˆ™è¿™å¾ˆæœ‰ç”¨ã€‚

+   `use_cache` (`bool`, *optional*) â€” å¦‚æœè®¾ç½®ä¸º`True`ï¼Œå°†è¿”å›`past_key_values`é”®å€¼çŠ¶æ€ï¼Œå¯ç”¨äºåŠ é€Ÿè§£ç ï¼ˆå‚è§`past_key_values`ï¼‰ã€‚

+   `output_attentions` (`bool`, *optional*) â€” æ˜¯å¦è¿”å›æ‰€æœ‰æ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›å¼ é‡ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§è¿”å›å¼ é‡ä¸‹çš„`attentions`ã€‚

+   `output_hidden_states` (`bool`, *optional*) â€” æ˜¯å¦è¿”å›æ‰€æœ‰å±‚çš„éšè—çŠ¶æ€ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§è¿”å›å¼ é‡ä¸‹çš„`hidden_states`ã€‚

+   `return_dict` (`bool`, *optional*) â€” æ˜¯å¦è¿”å›[ModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.utils.ModelOutput)è€Œä¸æ˜¯æ™®é€šå…ƒç»„ã€‚

è¿”å›

`transformers.models.autoformer.modeling_autoformer.AutoformerModelOutput`æˆ–`tuple(torch.FloatTensor)`

ä¸€ä¸ª`transformers.models.autoformer.modeling_autoformer.AutoformerModelOutput`æˆ–ä¸€ä¸ª`torch.FloatTensor`çš„å…ƒç»„ï¼ˆå¦‚æœä¼ é€’`return_dict=False`æˆ–`config.return_dict=False`æ—¶ï¼‰åŒ…å«æ ¹æ®é…ç½®ï¼ˆ[AutoformerConfig](/docs/transformers/v4.37.2/en/model_doc/autoformer#transformers.AutoformerConfig)ï¼‰å’Œè¾“å…¥çš„ä¸åŒå…ƒç´ ã€‚

+   `last_hidden_state` (`torch.FloatTensor`çš„å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`) â€” æ¨¡å‹è§£ç å™¨æœ€åä¸€å±‚çš„éšè—çŠ¶æ€åºåˆ—ã€‚

    å¦‚æœä»…ä½¿ç”¨`past_key_values`ï¼Œåˆ™è¾“å‡ºå½¢çŠ¶ä¸º`(batch_size, 1, hidden_size)`çš„åºåˆ—çš„æœ€åä¸€ä¸ªéšè—çŠ¶æ€ã€‚

+   `trend` (`torch.FloatTensor`çš„å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`) â€” æ¯ä¸ªæ—¶é—´åºåˆ—çš„è¶‹åŠ¿å¼ é‡ã€‚

+   `past_key_values` (`tuple(tuple(torch.FloatTensor))`, *optional*, å½“ä¼ é€’`use_cache=True`æˆ–`config.use_cache=True`æ—¶è¿”å› â€” é•¿åº¦ä¸º`config.n_layers`çš„å…ƒç»„ï¼Œæ¯ä¸ªå…ƒç»„æœ‰2ä¸ªå½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, embed_size_per_head)`çš„å¼ é‡ï¼Œä»¥åŠ2ä¸ªé¢å¤–çš„å½¢çŠ¶ä¸º`(batch_size, num_heads, encoder_sequence_length, embed_size_per_head)`çš„å¼ é‡ã€‚

    åŒ…å«é¢„å…ˆè®¡ç®—çš„éšè—çŠ¶æ€ï¼ˆè‡ªæ³¨æ„åŠ›å—å’Œäº¤å‰æ³¨æ„åŠ›å—ä¸­çš„é”®å’Œå€¼ï¼‰ï¼Œå¯ç”¨äºåŠ é€Ÿé¡ºåºè§£ç ï¼ˆå‚è§`past_key_values`è¾“å…¥ï¼‰ã€‚

+   `decoder_hidden_states`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_hidden_states=True`æˆ–`config.output_hidden_states=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœæ¨¡å‹æœ‰åµŒå…¥å±‚ï¼Œåˆ™ä¸ºåµŒå…¥çš„è¾“å‡ºåŠ ä¸Šæ¯å±‚çš„è¾“å‡ºï¼‰ã€‚

    è§£ç å™¨åœ¨æ¯ä¸€å±‚è¾“å‡ºçš„éšè—çŠ¶æ€ä»¥åŠå¯é€‰çš„åˆå§‹åµŒå…¥è¾“å‡ºã€‚

+   `decoder_attentions`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    è§£ç å™¨çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—è‡ªæ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `cross_attentions`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    è§£ç å™¨çš„äº¤å‰æ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—äº¤å‰æ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `encoder_last_hidden_state`ï¼ˆ`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`ï¼Œ*å¯é€‰*ï¼‰- æ¨¡å‹ç¼–ç å™¨æœ€åä¸€å±‚çš„éšè—çŠ¶æ€åºåˆ—ã€‚

+   `encoder_hidden_states`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_hidden_states=True`æˆ–`config.output_hidden_states=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœæ¨¡å‹æœ‰åµŒå…¥å±‚ï¼Œåˆ™ä¸ºåµŒå…¥çš„è¾“å‡ºåŠ ä¸Šæ¯å±‚çš„è¾“å‡ºï¼‰ã€‚

    ç¼–ç å™¨åœ¨æ¯ä¸€å±‚è¾“å‡ºçš„éšè—çŠ¶æ€ä»¥åŠå¯é€‰çš„åˆå§‹åµŒå…¥è¾“å‡ºã€‚

+   `encoder_attentions`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    ç¼–ç å™¨çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—è‡ªæ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `loc`ï¼ˆ`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size,)`æˆ–`(batch_size, input_size)`ï¼Œ*å¯é€‰*ï¼‰- æ¯ä¸ªæ—¶é—´åºåˆ—ä¸Šä¸‹æ–‡çª—å£çš„åç§»å€¼ï¼Œç”¨äºä½¿æ¨¡å‹è¾“å…¥å…·æœ‰ç›¸åŒçš„é‡çº§ï¼Œç„¶åç”¨äºå°†å…¶åç§»å›åŸå§‹é‡çº§ã€‚

+   `scale`ï¼ˆ`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size,)`æˆ–`(batch_size, input_size)`ï¼Œ*å¯é€‰*ï¼‰- æ¯ä¸ªæ—¶é—´åºåˆ—ä¸Šä¸‹æ–‡çª—å£çš„ç¼©æ”¾å€¼ï¼Œç”¨äºä½¿æ¨¡å‹è¾“å…¥å…·æœ‰ç›¸åŒçš„é‡çº§ï¼Œç„¶åç”¨äºå°†å…¶é‡æ–°ç¼©æ”¾å›åŸå§‹é‡çº§ã€‚

+   `static_features:`ï¼ˆ`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, feature size)`ï¼Œ*å¯é€‰*ï¼‰- æ‰¹å¤„ç†ä¸­æ¯ä¸ªæ—¶é—´åºåˆ—çš„é™æ€ç‰¹å¾ï¼Œåœ¨æ¨æ–­æ—¶å¤åˆ¶åˆ°åå˜é‡ä¸­ã€‚

[AutoformerModel](/docs/transformers/v4.37.2/en/model_doc/autoformer#transformers.AutoformerModel)çš„å‰å‘æ–¹æ³•ï¼Œè¦†ç›–äº†`__call__`ç‰¹æ®Šæ–¹æ³•ã€‚

è™½ç„¶å‰å‘ä¼ é€’çš„æ–¹æ³•éœ€è¦åœ¨æ­¤å‡½æ•°å†…å®šä¹‰ï¼Œä½†åº”è¯¥åœ¨æ­¤ä¹‹åè°ƒç”¨`Module`å®ä¾‹ï¼Œè€Œä¸æ˜¯è¿™ä¸ªï¼Œå› ä¸ºå‰è€…è´Ÿè´£è¿è¡Œé¢„å¤„ç†å’Œåå¤„ç†æ­¥éª¤ï¼Œè€Œåè€…ä¼šé»˜é»˜åœ°å¿½ç•¥å®ƒä»¬ã€‚

ç¤ºä¾‹ï¼š

```py
>>> from huggingface_hub import hf_hub_download
>>> import torch
>>> from transformers import AutoformerModel

>>> file = hf_hub_download(
...     repo_id="hf-internal-testing/tourism-monthly-batch", filename="train-batch.pt", repo_type="dataset"
... )
>>> batch = torch.load(file)

>>> model = AutoformerModel.from_pretrained("huggingface/autoformer-tourism-monthly")

>>> # during training, one provides both past and future values
>>> # as well as possible additional features
>>> outputs = model(
...     past_values=batch["past_values"],
...     past_time_features=batch["past_time_features"],
...     past_observed_mask=batch["past_observed_mask"],
...     static_categorical_features=batch["static_categorical_features"],
...     future_values=batch["future_values"],
...     future_time_features=batch["future_time_features"],
... )

>>> last_hidden_state = outputs.last_hidden_state
```

## AutoformerForPrediction

### `class transformers.AutoformerForPrediction`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/autoformer/modeling_autoformer.py#L1765)

```py
( config: AutoformerConfig )
```

å‚æ•°

+   `config`ï¼ˆ[AutoformerConfig](/docs/transformers/v4.37.2/en/model_doc/autoformer#transformers.AutoformerConfig)ï¼‰â€” æ¨¡å‹é…ç½®ç±»ï¼ŒåŒ…å«æ¨¡å‹çš„æ‰€æœ‰å‚æ•°ã€‚ä½¿ç”¨é…ç½®æ–‡ä»¶åˆå§‹åŒ–ä¸ä¼šåŠ è½½ä¸æ¨¡å‹ç›¸å…³çš„æƒé‡ï¼ŒåªåŠ è½½é…ç½®ã€‚æŸ¥çœ‹[from_pretrained()](/docs/transformers/v4.37.2/en/main_classes/model#transformers.PreTrainedModel.from_pretrained)æ–¹æ³•ä»¥åŠ è½½æ¨¡å‹æƒé‡ã€‚

Autoformeræ¨¡å‹åœ¨æ—¶é—´åºåˆ—é¢„æµ‹çš„é¡¶éƒ¨å…·æœ‰ä¸€ä¸ªåˆ†å¸ƒå¤´ã€‚è¯¥æ¨¡å‹ç»§æ‰¿è‡ª[PreTrainedModel](/docs/transformers/v4.37.2/en/main_classes/model#transformers.PreTrainedModel)ã€‚æŸ¥çœ‹è¶…ç±»æ–‡æ¡£ï¼Œäº†è§£åº“ä¸ºå…¶æ‰€æœ‰æ¨¡å‹å®ç°çš„é€šç”¨æ–¹æ³•ï¼ˆå¦‚ä¸‹è½½æˆ–ä¿å­˜ã€è°ƒæ•´è¾“å…¥åµŒå…¥ã€ä¿®å‰ªå¤´ç­‰ï¼‰ã€‚

è¿™ä¸ªæ¨¡å‹ä¹Ÿæ˜¯ä¸€ä¸ªPyTorch [torch.nn.Module](https://pytorch.org/docs/stable/nn.html#torch.nn.Module)å­ç±»ã€‚å°†å…¶ç”¨ä½œå¸¸è§„çš„PyTorchæ¨¡å—ï¼Œå¹¶å‚è€ƒPyTorchæ–‡æ¡£ä»¥è·å–ä¸ä¸€èˆ¬ä½¿ç”¨å’Œè¡Œä¸ºç›¸å…³çš„æ‰€æœ‰ä¿¡æ¯ã€‚

#### `forward`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/autoformer/modeling_autoformer.py#L1809)

```py
( past_values: Tensor past_time_features: Tensor past_observed_mask: Tensor static_categorical_features: Optional = None static_real_features: Optional = None future_values: Optional = None future_time_features: Optional = None future_observed_mask: Optional = None decoder_attention_mask: Optional = None head_mask: Optional = None decoder_head_mask: Optional = None cross_attn_head_mask: Optional = None encoder_outputs: Optional = None past_key_values: Optional = None output_hidden_states: Optional = None output_attentions: Optional = None use_cache: Optional = None return_dict: Optional = None ) â†’ export const metadata = 'undefined';transformers.modeling_outputs.Seq2SeqTSPredictionOutput or tuple(torch.FloatTensor)
```

å‚æ•°

+   `past_values`ï¼ˆ`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length)`ï¼‰â€” æ—¶é—´åºåˆ—çš„è¿‡å»å€¼ï¼Œä½œä¸ºä¸Šä¸‹æ–‡ä»¥é¢„æµ‹æœªæ¥ã€‚è¿™äº›å€¼å¯èƒ½åŒ…å«æ»åï¼Œå³è¿‡å»çš„å…¶ä»–å€¼ï¼Œä»¥ä½œä¸ºâ€œé¢å¤–ä¸Šä¸‹æ–‡â€æ·»åŠ ã€‚`past_values`æ˜¯Transformerç¼–ç å™¨çš„è¾“å…¥ï¼ˆè¿˜å¯ä»¥åŒ…æ‹¬å¯é€‰çš„å…¶ä»–ç‰¹å¾ï¼Œå¦‚`static_categorical_features`ã€`static_real_features`ã€`past_time_features`ï¼‰ã€‚

    è¿™é‡Œçš„åºåˆ—é•¿åº¦ç­‰äº`context_length` + `max(config.lags_sequence)`ã€‚

    ç¼ºå¤±å€¼éœ€è¦ç”¨é›¶æ›¿æ¢ã€‚

+   `past_time_features`ï¼ˆ`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length, num_features)`ï¼Œ*å¯é€‰*ï¼‰â€” å¯é€‰çš„æ—¶é—´ç‰¹å¾ï¼Œæ¨¡å‹å†…éƒ¨å°†å…¶æ·»åŠ åˆ°`past_values`ä¸­ã€‚è¿™äº›å¯èƒ½æ˜¯è¯¸å¦‚â€œå¹´ä»½ä¸­çš„æœˆä»½â€ï¼Œâ€œæœˆä»½ä¸­çš„æ—¥æœŸâ€ç­‰ç¼–ç ä¸ºå‘é‡ï¼ˆä¾‹å¦‚å‚…ç«‹å¶ç‰¹å¾ï¼‰çš„å†…å®¹ã€‚è¿™äº›ä¹Ÿå¯ä»¥æ˜¯æ‰€è°“çš„â€œå¹´é¾„â€ç‰¹å¾ï¼ŒåŸºæœ¬ä¸Šå¸®åŠ©æ¨¡å‹äº†è§£æ—¶é—´åºåˆ—å¤„äºâ€œç”Ÿå‘½ä¸­çš„å“ªä¸ªé˜¶æ®µâ€ã€‚å¹´é¾„ç‰¹å¾å¯¹äºè¿‡å»çš„æ—¶é—´æ­¥å…·æœ‰è¾ƒå°çš„å€¼ï¼Œå¹¶ä¸”éšç€æˆ‘ä»¬æ¥è¿‘å½“å‰æ—¶é—´æ­¥è€Œå•è°ƒå¢åŠ ã€‚

    è¿™äº›ç‰¹å¾ä½œä¸ºè¾“å…¥çš„â€œä½ç½®ç¼–ç â€ã€‚å› æ­¤ï¼Œä¸åƒBERTè¿™æ ·çš„æ¨¡å‹ç›¸åï¼ŒBERTçš„ä½ç½®ç¼–ç æ˜¯ä»å¤´å¼€å§‹å†…éƒ¨ä½œä¸ºæ¨¡å‹çš„å‚æ•°å­¦ä¹ çš„ï¼Œæ—¶é—´åºåˆ—Transformeréœ€è¦æä¾›é¢å¤–çš„æ—¶é—´ç‰¹å¾ã€‚

    Autoformerä»…ä¸º`static_categorical_features`å­¦ä¹ é¢å¤–çš„åµŒå…¥ã€‚

+   `past_observed_mask`ï¼ˆ`torch.BoolTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length)`ï¼Œ*å¯é€‰*ï¼‰â€” å¸ƒå°”æ©ç ï¼ŒæŒ‡ç¤ºå“ªäº›`past_values`æ˜¯è§‚å¯Ÿåˆ°çš„ï¼Œå“ªäº›æ˜¯ç¼ºå¤±çš„ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºâ€œè§‚å¯Ÿåˆ°â€çš„å€¼ï¼Œ

    +   0è¡¨ç¤ºâ€œç¼ºå¤±â€çš„å€¼ï¼ˆå³ç”¨é›¶æ›¿æ¢çš„NaNï¼‰ã€‚

+   `static_categorical_features`ï¼ˆ`torch.LongTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, number of static categorical features)`ï¼Œ*å¯é€‰*ï¼‰â€” æ¨¡å‹å°†å­¦ä¹ åµŒå…¥çš„å¯é€‰é™æ€åˆ†ç±»ç‰¹å¾ï¼Œå°†å…¶æ·»åŠ åˆ°æ—¶é—´åºåˆ—çš„å€¼ä¸­ã€‚

    é™æ€åˆ†ç±»ç‰¹å¾æ˜¯æ‰€æœ‰æ—¶é—´æ­¥é•¿å…·æœ‰ç›¸åŒå€¼çš„ç‰¹å¾ï¼ˆéšæ—¶é—´ä¿æŒé™æ€ï¼‰ã€‚

    é™æ€åˆ†ç±»ç‰¹å¾çš„å…¸å‹ç¤ºä¾‹æ˜¯æ—¶é—´åºåˆ—IDã€‚

+   `static_real_features`ï¼ˆ`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, number of static real features)`ï¼Œ*å¯é€‰*ï¼‰â€” æ¨¡å‹å°†æ·»åŠ åˆ°æ—¶é—´åºåˆ—å€¼ä¸­çš„å¯é€‰é™æ€å®ç‰¹å¾ã€‚

    é™æ€å®ç‰¹å¾æ˜¯æ‰€æœ‰æ—¶é—´æ­¥é•¿å…·æœ‰ç›¸åŒå€¼çš„ç‰¹å¾ï¼ˆéšæ—¶é—´ä¿æŒé™æ€ï¼‰ã€‚

    é™æ€å®ç‰¹å¾çš„å…¸å‹ç¤ºä¾‹æ˜¯ä¿ƒé”€ä¿¡æ¯ã€‚

+   `future_values` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, prediction_length)`) â€” æ—¶é—´åºåˆ—çš„æœªæ¥å€¼ï¼Œä½œä¸ºæ¨¡å‹çš„æ ‡ç­¾ã€‚Transformeréœ€è¦å­¦ä¹ è¾“å‡º`future_values`ï¼Œç»™å®š`past_values`ã€‚

    æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ¼”ç¤ºç¬”è®°æœ¬å’Œä»£ç ç‰‡æ®µã€‚

    ç¼ºå¤±å€¼éœ€è¦ç”¨é›¶æ›¿æ¢ã€‚

+   `future_time_features` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, prediction_length, num_features)`ï¼Œ*optional*) â€” å¯é€‰çš„æ—¶é—´ç‰¹å¾ï¼Œæ¨¡å‹å†…éƒ¨å°†å…¶æ·»åŠ åˆ°`future_values`ä¸­ã€‚è¿™äº›å¯èƒ½æ˜¯è¯¸å¦‚â€œå¹´ä»½çš„æœˆä»½â€ï¼Œâ€œæœˆä»½çš„æ—¥æœŸâ€ç­‰ç¼–ç ä¸ºå‘é‡ï¼ˆä¾‹å¦‚ä½œä¸ºå‚…ç«‹å¶ç‰¹å¾ï¼‰çš„å†…å®¹ã€‚è¿™äº›ä¹Ÿå¯ä»¥æ˜¯æ‰€è°“çš„â€œå¹´é¾„â€ç‰¹å¾ï¼ŒåŸºæœ¬ä¸Šå¸®åŠ©æ¨¡å‹çŸ¥é“æ—¶é—´åºåˆ—å¤„äºâ€œç”Ÿå‘½ä¸­çš„å“ªä¸ªé˜¶æ®µâ€ã€‚å¹´é¾„ç‰¹å¾å¯¹äºè¿œå¤„çš„è¿‡å»æ—¶é—´æ­¥å…·æœ‰è¾ƒå°çš„å€¼ï¼Œå¹¶ä¸”éšç€æˆ‘ä»¬æ¥è¿‘å½“å‰æ—¶é—´æ­¥è€Œå•è°ƒå¢åŠ ã€‚

    è¿™äº›ç‰¹å¾ä½œä¸ºè¾“å…¥çš„â€œä½ç½®ç¼–ç â€ã€‚ä¸BERTç­‰æ¨¡å‹ä¸åŒï¼ŒBERTç­‰æ¨¡å‹çš„ä½ç½®ç¼–ç æ˜¯ä»å¤´å¼€å§‹å†…éƒ¨ä½œä¸ºæ¨¡å‹çš„å‚æ•°å­¦ä¹ çš„ï¼Œæ—¶é—´åºåˆ—Transformeréœ€è¦æä¾›é¢å¤–çš„ç‰¹å¾ã€‚

    Autoformerä»…ä¸º`static_categorical_features`å­¦ä¹ é¢å¤–çš„åµŒå…¥ã€‚

+   `attention_mask` (`torch.Tensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length)`ï¼Œ*optional*) â€” ç”¨äºé¿å…åœ¨æŸäº›æ ‡è®°ç´¢å¼•ä¸Šæ‰§è¡Œæ³¨æ„åŠ›çš„æ©ç ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºæœªè¢«æ©ç›–çš„æ ‡è®°ï¼Œ

    +   0è¡¨ç¤ºè¢«æ©ç›–çš„æ ‡è®°ã€‚

    [ä»€ä¹ˆæ˜¯æ³¨æ„åŠ›æ©ç ï¼Ÿ](../glossary#attention-mask)

+   `decoder_attention_mask` (`torch.LongTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, target_sequence_length)`ï¼Œ*optional*) â€” ç”¨äºé¿å…åœ¨æŸäº›æ ‡è®°ç´¢å¼•ä¸Šæ‰§è¡Œæ³¨æ„åŠ›çš„æ©ç ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†ä½¿ç”¨å› æœæ©ç ï¼Œä»¥ç¡®ä¿æ¨¡å‹åªèƒ½æŸ¥çœ‹ä»¥å‰çš„è¾“å…¥ä»¥é¢„æµ‹æœªæ¥ã€‚

+   `head_mask` (`torch.Tensor`ï¼Œå½¢çŠ¶ä¸º`(encoder_layers, encoder_attention_heads)`ï¼Œ*optional*) â€” ç”¨äºä½¿ç¼–ç å™¨ä¸­çš„æ³¨æ„åŠ›æ¨¡å—ä¸­çš„é€‰å®šå¤´éƒ¨å¤±æ•ˆçš„æ©ç ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºå¤´éƒ¨æœªè¢«æ©ç›–ï¼Œ

    +   0è¡¨ç¤ºå¤´éƒ¨è¢«æ©ç›–ã€‚

+   `decoder_head_mask` (`torch.Tensor`ï¼Œå½¢çŠ¶ä¸º`(decoder_layers, decoder_attention_heads)`ï¼Œ*optional*) â€” ç”¨äºä½¿è§£ç å™¨ä¸­çš„æ³¨æ„åŠ›æ¨¡å—ä¸­çš„é€‰å®šå¤´éƒ¨å¤±æ•ˆçš„æ©ç ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºå¤´éƒ¨æœªè¢«æ©ç›–ï¼Œ

    +   0è¡¨ç¤ºå¤´éƒ¨è¢«æ©ç›–ã€‚

+   `cross_attn_head_mask` (`torch.Tensor`ï¼Œå½¢çŠ¶ä¸º`(decoder_layers, decoder_attention_heads)`ï¼Œ*optional*) â€” ç”¨äºä½¿äº¤å‰æ³¨æ„åŠ›æ¨¡å—ä¸­çš„é€‰å®šå¤´éƒ¨å¤±æ•ˆçš„æ©ç ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºå¤´éƒ¨æœªè¢«æ©ç›–ï¼Œ

    +   0è¡¨ç¤ºå¤´éƒ¨è¢«æ©ç›–ã€‚

+   `encoder_outputs` (`tuple(tuple(torch.FloatTensor)`ï¼Œ*optional*) â€” å…ƒç»„åŒ…æ‹¬`last_hidden_state`ï¼Œ`hidden_states`ï¼ˆ*optional*ï¼‰å’Œ`attentions`ï¼ˆ*optional*ï¼‰`last_hidden_state`çš„å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„éšè—çŠ¶æ€åºåˆ—æ˜¯ç¼–ç å™¨æœ€åä¸€å±‚çš„è¾“å‡ºã€‚ç”¨äºè§£ç å™¨çš„äº¤å‰æ³¨æ„åŠ›ã€‚

+   `past_key_values` (`tuple(tuple(torch.FloatTensor))`, *optional*, å½“ä¼ é€’`use_cache=True`æˆ–`config.use_cache=True`æ—¶è¿”å›) â€” é•¿åº¦ä¸º`config.n_layers`çš„å…ƒç»„ï¼Œæ¯ä¸ªå…ƒç»„æœ‰2ä¸ªå½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, embed_size_per_head)`çš„å¼ é‡å’Œ2ä¸ªé¢å¤–çš„å½¢çŠ¶ä¸º`(batch_size, num_heads, encoder_sequence_length, embed_size_per_head)`çš„å¼ é‡ã€‚

    åŒ…å«é¢„å…ˆè®¡ç®—çš„éšè—çŠ¶æ€ï¼ˆè‡ªæ³¨æ„åŠ›å—å’Œäº¤å‰æ³¨æ„åŠ›å—ä¸­çš„é”®å’Œå€¼ï¼‰ï¼Œå¯ç”¨äºåŠ é€Ÿé¡ºåºè§£ç ï¼ˆå‚è§`past_key_values`è¾“å…¥ï¼‰ã€‚

    å¦‚æœä½¿ç”¨äº†`past_key_values`ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©ä»…è¾“å…¥æœ€åçš„`decoder_input_ids`ï¼ˆé‚£äº›æ²¡æœ‰å°†å…¶è¿‡å»é”®å€¼çŠ¶æ€æä¾›ç»™æ­¤æ¨¡å‹çš„ï¼‰çš„å½¢çŠ¶ä¸º`(batch_size, 1)`çš„å¼ é‡ï¼Œè€Œä¸æ˜¯å½¢çŠ¶ä¸º`(batch_size, sequence_length)`çš„æ‰€æœ‰`decoder_input_ids`ã€‚

+   `inputs_embeds` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`ï¼Œ*å¯é€‰*) â€” å¯é€‰åœ°ï¼Œå¯ä»¥ç›´æ¥ä¼ é€’åµŒå…¥è¡¨ç¤ºï¼Œè€Œä¸æ˜¯ä¼ é€’`input_ids`ã€‚å¦‚æœæ‚¨æƒ³è¦æ›´å¤šæ§åˆ¶å¦‚ä½•å°†`input_ids`ç´¢å¼•è½¬æ¢ä¸ºç›¸å…³å‘é‡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ¨¡å‹çš„å†…éƒ¨åµŒå…¥æŸ¥æ‰¾çŸ©é˜µï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚

+   `use_cache` (`bool`, *å¯é€‰*) â€” å¦‚æœè®¾ç½®ä¸º`True`ï¼Œåˆ™è¿”å›`past_key_values`é”®å€¼çŠ¶æ€ï¼Œå¯ç”¨äºåŠ é€Ÿè§£ç ï¼ˆå‚è§`past_key_values`ï¼‰ã€‚

+   `output_attentions` (`bool`, *å¯é€‰*) â€” æ˜¯å¦è¿”å›æ‰€æœ‰æ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›å¼ é‡ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§è¿”å›å¼ é‡ä¸‹çš„`attentions`ã€‚

+   `output_hidden_states` (`bool`, *å¯é€‰*) â€” æ˜¯å¦è¿”å›æ‰€æœ‰å±‚çš„éšè—çŠ¶æ€ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§è¿”å›å¼ é‡ä¸‹çš„`hidden_states`ã€‚

+   `return_dict` (`bool`, *å¯é€‰*) â€” æ˜¯å¦è¿”å›[ModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.utils.ModelOutput)è€Œä¸æ˜¯æ™®é€šå…ƒç»„ã€‚

è¿”å›

[transformers.modeling_outputs.Seq2SeqTSPredictionOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.modeling_outputs.Seq2SeqTSPredictionOutput)æˆ–`torch.FloatTensor`å…ƒç»„

ä¸€ä¸ª[transformers.modeling_outputs.Seq2SeqTSPredictionOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.modeling_outputs.Seq2SeqTSPredictionOutput)æˆ–ä¸€ä¸ª`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœä¼ é€’`return_dict=False`æˆ–`config.return_dict=False`ï¼‰åŒ…å«å„ç§å…ƒç´ ï¼Œå…·ä½“å–å†³äºé…ç½®ï¼ˆ[AutoformerConfig](/docs/transformers/v4.37.2/en/model_doc/autoformer#transformers.AutoformerConfig)ï¼‰å’Œè¾“å…¥ã€‚

+   `loss` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(1,)`ï¼Œ*å¯é€‰*ï¼Œå½“æä¾›`future_values`æ—¶è¿”å›) â€” åˆ†å¸ƒæŸå¤±ã€‚

+   `params` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, num_samples, num_params)`) â€” æ‰€é€‰åˆ†å¸ƒçš„å‚æ•°ã€‚

+   `past_key_values` (`tuple(tuple(torch.FloatTensor))`, *å¯é€‰*, å½“ä¼ é€’`use_cache=True`æˆ–`config.use_cache=True`æ—¶è¿”å›) â€” é•¿åº¦ä¸º`config.n_layers`çš„`tuple(torch.FloatTensor)`å…ƒç»„ï¼Œæ¯ä¸ªå…ƒç»„æœ‰2ä¸ªå½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, embed_size_per_head)`çš„å¼ é‡å’Œ2ä¸ªé¢å¤–çš„å½¢çŠ¶ä¸º`(batch_size, num_heads, encoder_sequence_length, embed_size_per_head)`çš„å¼ é‡ã€‚

    åŒ…å«é¢„å…ˆè®¡ç®—çš„éšè—çŠ¶æ€ï¼ˆè‡ªæ³¨æ„åŠ›å—å’Œäº¤å‰æ³¨æ„åŠ›å—ä¸­çš„é”®å’Œå€¼ï¼‰ï¼Œå¯ç”¨äºåŠ é€Ÿé¡ºåºè§£ç ï¼ˆå‚è§`past_key_values`è¾“å…¥ï¼‰ã€‚

+   `decoder_hidden_states` (`tuple(torch.FloatTensor)`, *å¯é€‰*, å½“ä¼ é€’`output_hidden_states=True`æˆ–`config.output_hidden_states=True`æ—¶è¿”å›) â€” å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœæ¨¡å‹æœ‰åµŒå…¥å±‚ï¼Œåˆ™ä¸ºåµŒå…¥å±‚çš„è¾“å‡º+æ¯å±‚çš„è¾“å‡ºï¼‰ã€‚

    è§£ç å™¨åœ¨æ¯ä¸€å±‚è¾“å‡ºçš„éšè—çŠ¶æ€åŠ ä¸Šåˆå§‹åµŒå…¥è¾“å‡ºã€‚

+   `decoder_attentions` (`tuple(torch.FloatTensor)`, *å¯é€‰*, å½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›) â€” å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    è§£ç å™¨çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—è‡ªæ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `cross_attentions` (`tuple(torch.FloatTensor)`, *å¯é€‰*, å½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›) â€” å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    è§£ç å™¨äº¤å‰æ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—äº¤å‰æ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `encoder_last_hidden_state` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`ï¼Œ*optional*) â€” æ¨¡å‹ç¼–ç å™¨æœ€åä¸€å±‚çš„éšè—çŠ¶æ€åºåˆ—ã€‚

+   `encoder_hidden_states` (`tuple(torch.FloatTensor)`, *optional*, returned when `output_hidden_states=True` is passed or when `config.output_hidden_states=True`) â€” æ¯ä¸ªå±‚çš„è¾“å‡ºï¼ˆå¦‚æœæ¨¡å‹æœ‰åµŒå…¥å±‚ï¼Œåˆ™ä¸ºåµŒå…¥çš„è¾“å‡º+æ¯ä¸ªå±‚çš„è¾“å‡ºï¼‰çš„`torch.FloatTensor`å…ƒç»„ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`ã€‚

    ç¼–ç å™¨åœ¨æ¯ä¸ªå±‚çš„è¾“å‡ºä»¥åŠåˆå§‹åµŒå…¥è¾“å‡ºçš„éšè—çŠ¶æ€ã€‚

+   `encoder_attentions` (`tuple(torch.FloatTensor)`ï¼Œ*optional*ï¼Œå½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›) â€” `torch.FloatTensor`å…ƒç»„ï¼ˆæ¯ä¸ªå±‚ä¸€ä¸ªï¼‰ï¼Œå½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`ã€‚

    ç¼–ç å™¨çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—è‡ªæ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `loc` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size,)`æˆ–`(batch_size, input_size)`ï¼Œ*optional*) â€” æ¯ä¸ªæ—¶é—´åºåˆ—ä¸Šä¸‹æ–‡çª—å£çš„åç§»å€¼ï¼Œç”¨äºä½¿æ¨¡å‹è¾“å…¥å…·æœ‰ç›¸åŒçš„é‡çº§ï¼Œç„¶åç”¨äºå°†å…¶åç§»å›åŸå§‹é‡çº§ã€‚

+   `scale` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size,)`æˆ–`(batch_size, input_size)`ï¼Œ*optional*) â€” æ¯ä¸ªæ—¶é—´åºåˆ—ä¸Šä¸‹æ–‡çª—å£çš„ç¼©æ”¾å€¼ï¼Œç”¨äºä½¿æ¨¡å‹è¾“å…¥å…·æœ‰ç›¸åŒçš„é‡çº§ï¼Œç„¶åç”¨äºå°†å…¶é‡æ–°ç¼©æ”¾å›åŸå§‹é‡çº§ã€‚

+   `static_features` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, feature size)`ï¼Œ*optional*) â€” æ¯ä¸ªæ—¶é—´åºåˆ—æ‰¹æ¬¡ä¸­çš„é™æ€ç‰¹å¾ï¼Œåœ¨æ¨æ–­æ—¶å¤åˆ¶åˆ°åå˜é‡ä¸­ã€‚

[AutoformerForPrediction](/docs/transformers/v4.37.2/en/model_doc/autoformer#transformers.AutoformerForPrediction)çš„å‰å‘æ–¹æ³•ï¼Œè¦†ç›–äº†`__call__`ç‰¹æ®Šæ–¹æ³•ã€‚

è™½ç„¶å‰å‘ä¼ é€’çš„æ­¥éª¤éœ€è¦åœ¨æ­¤å‡½æ•°å†…å®šä¹‰ï¼Œä½†åº”è¯¥åœ¨æ­¤ä¹‹åè°ƒç”¨`Module`å®ä¾‹ï¼Œè€Œä¸æ˜¯åœ¨æ­¤å¤„è°ƒç”¨ï¼Œå› ä¸ºå‰è€…ä¼šå¤„ç†è¿è¡Œå‰åå¤„ç†æ­¥éª¤ï¼Œè€Œåè€…ä¼šé»˜é»˜åœ°å¿½ç•¥å®ƒä»¬ã€‚

ç¤ºä¾‹ï¼š

```py
>>> from huggingface_hub import hf_hub_download
>>> import torch
>>> from transformers import AutoformerForPrediction

>>> file = hf_hub_download(
...     repo_id="hf-internal-testing/tourism-monthly-batch", filename="train-batch.pt", repo_type="dataset"
... )
>>> batch = torch.load(file)

>>> model = AutoformerForPrediction.from_pretrained("huggingface/autoformer-tourism-monthly")

>>> # during training, one provides both past and future values
>>> # as well as possible additional features
>>> outputs = model(
...     past_values=batch["past_values"],
...     past_time_features=batch["past_time_features"],
...     past_observed_mask=batch["past_observed_mask"],
...     static_categorical_features=batch["static_categorical_features"],
...     static_real_features=batch["static_real_features"],
...     future_values=batch["future_values"],
...     future_time_features=batch["future_time_features"],
... )

>>> loss = outputs.loss
>>> loss.backward()

>>> # during inference, one only provides past values
>>> # as well as possible additional features
>>> # the model autoregressively generates future values
>>> outputs = model.generate(
...     past_values=batch["past_values"],
...     past_time_features=batch["past_time_features"],
...     past_observed_mask=batch["past_observed_mask"],
...     static_categorical_features=batch["static_categorical_features"],
...     static_real_features=batch["static_real_features"],
...     future_time_features=batch["future_time_features"],
... )

>>> mean_prediction = outputs.sequences.mean(dim=1)
```
