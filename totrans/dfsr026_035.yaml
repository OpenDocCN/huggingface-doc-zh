- en: Prompt weighting
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ÂéüÊñáÔºö[https://huggingface.co/docs/diffusers/using-diffusers/weighted_prompts](https://huggingface.co/docs/diffusers/using-diffusers/weighted_prompts)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link href="/docs/diffusers/v0.26.3/en/_app/immutable/assets/0.e3b0c442.css"
    rel="modulepreload"> <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/entry/start.99629b4a.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/chunks/scheduler.182ea377.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/chunks/singletons.fade7992.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/chunks/index.1f6d62f6.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/chunks/paths.108a236d.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/entry/app.2b3eaeb0.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/chunks/index.abf12888.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/nodes/0.3862a335.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/chunks/each.e59479a4.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/nodes/192.a0f4d405.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/chunks/Tip.230e2334.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/chunks/CodeBlock.57fe6e13.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/chunks/DocNotebookDropdown.5fa27ace.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/chunks/globals.7f7f1b26.js">
    <link rel="modulepreload" href="/docs/diffusers/v0.26.3/en/_app/immutable/chunks/Heading.16916d63.js">
  prefs: []
  type: TYPE_NORMAL
- en: Prompt weighting provides a way to emphasize or de-emphasize certain parts of
    a prompt, allowing for more control over the generated image. A prompt can include
    several concepts, which gets turned into contextualized text embeddings. The embeddings
    are used by the model to condition its cross-attention layers to generate an image
    (read the Stable Diffusion [blog post](https://huggingface.co/blog/stable_diffusion)
    to learn more about how it works).
  prefs: []
  type: TYPE_NORMAL
- en: Prompt weighting works by increasing or decreasing the scale of the text embedding
    vector that corresponds to its concept in the prompt because you may not necessarily
    want the model to focus on all concepts equally. The easiest way to prepare the
    prompt-weighted embeddings is to use [Compel](https://github.com/damian0815/compel),
    a text prompt-weighting and blending library. Once you have the prompt-weighted
    embeddings, you can pass them to any pipeline that has a [`prompt_embeds`](https://huggingface.co/docs/diffusers/en/api/pipelines/stable_diffusion/text2img#diffusers.StableDiffusionPipeline.__call__.prompt_embeds)
    (and optionally [`negative_prompt_embeds`](https://huggingface.co/docs/diffusers/en/api/pipelines/stable_diffusion/text2img#diffusers.StableDiffusionPipeline.__call__.negative_prompt_embeds))
    parameter, such as [StableDiffusionPipeline](/docs/diffusers/v0.26.3/en/api/pipelines/stable_diffusion/text2img#diffusers.StableDiffusionPipeline),
    [StableDiffusionControlNetPipeline](/docs/diffusers/v0.26.3/en/api/pipelines/controlnet#diffusers.StableDiffusionControlNetPipeline),
    and [StableDiffusionXLPipeline](/docs/diffusers/v0.26.3/en/api/pipelines/stable_diffusion/stable_diffusion_xl#diffusers.StableDiffusionXLPipeline).
  prefs: []
  type: TYPE_NORMAL
- en: If your favorite pipeline doesn‚Äôt have a `prompt_embeds` parameter, please open
    an [issue](https://github.com/huggingface/diffusers/issues/new/choose) so we can
    add it!
  prefs: []
  type: TYPE_NORMAL
- en: This guide will show you how to weight and blend your prompts with Compel in
    ü§ó Diffusers.
  prefs: []
  type: TYPE_NORMAL
- en: 'Before you begin, make sure you have the latest version of Compel installed:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'For this guide, let‚Äôs generate an image with the prompt `"a red cat playing
    with a ball"` using the [StableDiffusionPipeline](/docs/diffusers/v0.26.3/en/api/pipelines/stable_diffusion/text2img#diffusers.StableDiffusionPipeline):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/24306b5413fb415e890bea8d0fc47df3.png)'
  prefs: []
  type: TYPE_IMG
- en: Weighting
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'You‚Äôll notice there is no ‚Äúball‚Äù in the image! Let‚Äôs use compel to upweight
    the concept of ‚Äúball‚Äù in the prompt. Create a [`Compel`](https://github.com/damian0815/compel/blob/main/doc/compel.md#compel-objects)
    object, and pass it a tokenizer and text encoder:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'compel uses `+` or `-` to increase or decrease the weight of a word in the
    prompt. To increase the weight of ‚Äúball‚Äù:'
  prefs: []
  type: TYPE_NORMAL
- en: '`+` corresponds to the value `1.1`, `++` corresponds to `1.1^2`, and so on.
    Similarly, `-` corresponds to `0.9` and `--` corresponds to `0.9^2`. Feel free
    to experiment with adding more `+` or `-` in your prompt!'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'Pass the prompt to `compel_proc` to create the new prompt embeddings which
    are passed to the pipeline:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/a6ea0a8316ec0e299ce79bd94f29d7a8.png)'
  prefs: []
  type: TYPE_IMG
- en: 'To downweight parts of the prompt, use the `-` suffix:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/eed909df9ef11a12b97771b8f85ab810.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You can even up or downweight multiple concepts in the same prompt:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/b82d3f52e501e13a58f1b034a7a8f0ad.png)'
  prefs: []
  type: TYPE_IMG
- en: Blending
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: You can also create a weighted *blend* of prompts by adding `.blend()` to a
    list of prompts and passing it some weights. Your blend may not always produce
    the result you expect because it breaks some assumptions about how the text encoder
    functions, so just have fun and experiment with it!
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/103f3c5f3fa90b6e9ec2d9e26bbb49cc.png)'
  prefs: []
  type: TYPE_IMG
- en: Conjunction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'A conjunction diffuses each prompt independently and concatenates their results
    by their weighted sum. Add `.and()` to the end of a list of prompts to create
    a conjunction:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/82df108b16157d244b56b16b408735a0.png)'
  prefs: []
  type: TYPE_IMG
- en: Textual inversion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[Textual inversion](../training/text_inversion) is a technique for learning
    a specific concept from some images which you can use to generate new images conditioned
    on that concept.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Create a pipeline and use the [load_textual_inversion()](/docs/diffusers/v0.26.3/en/api/loaders/textual_inversion#diffusers.loaders.TextualInversionLoaderMixin.load_textual_inversion)
    function to load the textual inversion embeddings (feel free to browse the [Stable
    Diffusion Conceptualizer](https://huggingface.co/spaces/sd-concepts-library/stable-diffusion-conceptualizer)
    for 100+ trained concepts):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'Compel provides a `DiffusersTextualInversionManager` class to simplify prompt
    weighting with textual inversion. Instantiate `DiffusersTextualInversionManager`
    and pass it to the `Compel` class:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: 'Incorporate the concept to condition a prompt with using the `<concept>` syntax:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/018f9f77083d1e4a4a4c59065acae017.png)'
  prefs: []
  type: TYPE_IMG
- en: DreamBooth
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[DreamBooth](../training/dreambooth) is a technique for generating contextualized
    images of a subject given just a few images of the subject to train on. It is
    similar to textual inversion, but DreamBooth trains the full model whereas textual
    inversion only fine-tunes the text embeddings. This means you should use [from_pretrained()](/docs/diffusers/v0.26.3/en/api/pipelines/overview#diffusers.DiffusionPipeline.from_pretrained)
    to load the DreamBooth model (feel free to browse the [Stable Diffusion Dreambooth
    Concepts Library](https://huggingface.co/sd-dreambooth-library) for 100+ trained
    models):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'Create a `Compel` class with a tokenizer and text encoder, and pass your prompt
    to it. Depending on the model you use, you‚Äôll need to incorporate the model‚Äôs
    unique identifier into your prompt. For example, the `dndcoverart-v1` model uses
    the identifier `dndcoverart`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/5b0fd6647d5253e64ddf3beb46283bde.png)'
  prefs: []
  type: TYPE_IMG
- en: Stable Diffusion XL
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Stable Diffusion XL (SDXL) has two tokenizers and text encoders so it‚Äôs usage
    is a bit different. To address this, you should pass both tokenizers and encoders
    to the `Compel` class:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: 'This time, let‚Äôs upweight ‚Äúball‚Äù by a factor of 1.5 for the first prompt, and
    downweight ‚Äúball‚Äù by 0.6 for the second prompt. The [StableDiffusionXLPipeline](/docs/diffusers/v0.26.3/en/api/pipelines/stable_diffusion/stable_diffusion_xl#diffusers.StableDiffusionXLPipeline)
    also requires [`pooled_prompt_embeds`](https://huggingface.co/docs/diffusers/en/api/pipelines/stable_diffusion/stable_diffusion_xl#diffusers.StableDiffusionXLInpaintPipeline.__call__.pooled_prompt_embeds)
    (and optionally [`negative_pooled_prompt_embeds`](https://huggingface.co/docs/diffusers/en/api/pipelines/stable_diffusion/stable_diffusion_xl#diffusers.StableDiffusionXLInpaintPipeline.__call__.negative_pooled_prompt_embeds))
    so you should pass those to the pipeline along with the conditioning tensors:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/067abbd7c08a8dee4ee6a6f556c86e97.png)'
  prefs: []
  type: TYPE_IMG
- en: '"a red cat playing with a (ball)1.5"'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1c14404c57c40fb1d0c84a7c12d4cb5c.png)'
  prefs: []
  type: TYPE_IMG
- en: '"a red cat playing with a (ball)0.6"'
  prefs: []
  type: TYPE_NORMAL
