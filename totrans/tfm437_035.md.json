["```py\npip install -q transformers\n```", "```py\n>>> from transformers import pipeline\n\n>>> checkpoint = \"openai/clip-vit-large-patch14\"\n>>> detector = pipeline(model=checkpoint, task=\"zero-shot-image-classification\")\n```", "```py\n>>> from PIL import Image\n>>> import requests\n\n>>> url = \"https://unsplash.com/photos/g8oS8-82DxI/download?ixid=MnwxMjA3fDB8MXx0b3BpY3x8SnBnNktpZGwtSGt8fHx8fDJ8fDE2NzgxMDYwODc&force=true&w=640\"\n>>> image = Image.open(requests.get(url, stream=True).raw)\n\n>>> image\n```", "```py\n>>> predictions = detector(image, candidate_labels=[\"fox\", \"bear\", \"seagull\", \"owl\"])\n>>> predictions\n[{'score': 0.9996670484542847, 'label': 'owl'},\n {'score': 0.000199399160919711, 'label': 'seagull'},\n {'score': 7.392891711788252e-05, 'label': 'fox'},\n {'score': 5.96074532950297e-05, 'label': 'bear'}]\n```", "```py\n>>> from transformers import AutoProcessor, AutoModelForZeroShotImageClassification\n\n>>> model = AutoModelForZeroShotImageClassification.from_pretrained(checkpoint)\n>>> processor = AutoProcessor.from_pretrained(checkpoint)\n```", "```py\n>>> from PIL import Image\n>>> import requests\n\n>>> url = \"https://unsplash.com/photos/xBRQfR2bqNI/download?ixid=MnwxMjA3fDB8MXxhbGx8fHx8fHx8fHwxNjc4Mzg4ODEx&force=true&w=640\"\n>>> image = Image.open(requests.get(url, stream=True).raw)\n\n>>> image\n```", "```py\n>>> candidate_labels = [\"tree\", \"car\", \"bike\", \"cat\"]\n>>> inputs = processor(images=image, text=candidate_labels, return_tensors=\"pt\", padding=True)\n```", "```py\n>>> import torch\n\n>>> with torch.no_grad():\n...     outputs = model(**inputs)\n\n>>> logits = outputs.logits_per_image[0]\n>>> probs = logits.softmax(dim=-1).numpy()\n>>> scores = probs.tolist()\n\n>>> result = [\n...     {\"score\": score, \"label\": candidate_label}\n...     for score, candidate_label in sorted(zip(probs, candidate_labels), key=lambda x: -x[0])\n... ]\n\n>>> result\n[{'score': 0.998572, 'label': 'car'},\n {'score': 0.0010570387, 'label': 'bike'},\n {'score': 0.0003393686, 'label': 'tree'},\n {'score': 3.1572064e-05, 'label': 'cat'}]\n```"]