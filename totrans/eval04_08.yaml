- en: Creating and sharing a new evaluation
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åˆ›å»ºå’Œå…±äº«æ–°çš„è¯„ä¼°
- en: 'Original text: [https://huggingface.co/docs/evaluate/creating_and_sharing](https://huggingface.co/docs/evaluate/creating_and_sharing)'
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸå§‹æ–‡æœ¬ï¼š[https://huggingface.co/docs/evaluate/creating_and_sharing](https://huggingface.co/docs/evaluate/creating_and_sharing)
- en: null
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: Setup
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®¾ç½®
- en: 'Before you can create a new metric make sure you have all the necessary dependencies
    installed:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨åˆ›å»ºæ–°åº¦é‡ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²å®‰è£…æ‰€æœ‰å¿…è¦çš„ä¾èµ–é¡¹ï¼š
- en: '[PRE0]'
  id: totrans-5
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Also make sure your Hugging Face token is registered so you can connect to
    the Hugging Face Hub:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: è¿˜è¦ç¡®ä¿æ‚¨çš„Hugging Faceä»¤ç‰Œå·²æ³¨å†Œï¼Œä»¥ä¾¿æ‚¨å¯ä»¥è¿æ¥åˆ°Hugging Face Hubï¼š
- en: '[PRE1]'
  id: totrans-7
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Create
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åˆ›å»º
- en: 'All evaluation modules, be it metrics, comparisons, or measurements live on
    the ğŸ¤— Hub in a [Space](https://huggingface.co/docs/hub/spaces) (see for example
    [Accuracy](https://huggingface.co/spaces/evaluate-metric/accuracy)). In principle,
    you could setup a new Space and add a new module following the same structure.
    However, we added a CLI that makes creating a new evaluation module much easier:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€æœ‰è¯„ä¼°æ¨¡å—ï¼Œæ— è®ºæ˜¯åº¦é‡ã€æ¯”è¾ƒè¿˜æ˜¯æµ‹é‡ï¼Œéƒ½å­˜å‚¨åœ¨ğŸ¤— Hubçš„[Space](https://huggingface.co/docs/hub/spaces)ä¸­ï¼ˆä¾‹å¦‚[Accuracy](https://huggingface.co/spaces/evaluate-metric/accuracy)ï¼‰ã€‚åŸåˆ™ä¸Šï¼Œæ‚¨å¯ä»¥è®¾ç½®ä¸€ä¸ªæ–°çš„Spaceï¼Œå¹¶æŒ‰ç…§ç›¸åŒçš„ç»“æ„æ·»åŠ ä¸€ä¸ªæ–°æ¨¡å—ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªCLIï¼Œä½¿åˆ›å»ºæ–°è¯„ä¼°æ¨¡å—å˜å¾—æ›´åŠ å®¹æ˜“ï¼š
- en: '[PRE2]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This will create a new Space on the ğŸ¤— Hub, clone it locally, and populate it
    with a template. Instructions on how to fill the template will be displayed in
    the terminal, but are also explained here in more detail.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°†åœ¨ğŸ¤— Hubä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„Spaceï¼Œå°†å…¶å…‹éš†åˆ°æœ¬åœ°ï¼Œå¹¶ç”¨æ¨¡æ¿å¡«å……å®ƒã€‚å¦‚ä½•å¡«å†™æ¨¡æ¿çš„è¯´æ˜å°†æ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸­ï¼Œä½†è¿™é‡Œä¹Ÿæœ‰æ›´è¯¦ç»†çš„è§£é‡Šã€‚
- en: For more information about Spaces, see the [Spaces documentation](https://huggingface.co/docs/hub/spaces).
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰å…³Spacesçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…[Spacesæ–‡æ¡£](https://huggingface.co/docs/hub/spaces)ã€‚
- en: Module script
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ¨¡å—è„šæœ¬
- en: The evaluation module script (the file with suffix `*.py`) is the core of the
    new module and includes all the code for computing the evaluation.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: è¯„ä¼°æ¨¡å—è„šæœ¬ï¼ˆå¸¦æœ‰åç¼€`*.py`çš„æ–‡ä»¶ï¼‰æ˜¯æ–°æ¨¡å—çš„æ ¸å¿ƒï¼ŒåŒ…å«äº†è®¡ç®—è¯„ä¼°çš„æ‰€æœ‰ä»£ç ã€‚
- en: Attributes
  id: totrans-15
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å±æ€§
- en: 'Start by adding some information about your evalution module in `EvaluationModule._info()`.
    The most important attributes you should specify are:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œåœ¨`EvaluationModule._info()`ä¸­æ·»åŠ æœ‰å…³æ‚¨çš„è¯„ä¼°æ¨¡å—çš„ä¸€äº›ä¿¡æ¯ã€‚æ‚¨åº”è¯¥æŒ‡å®šçš„æœ€é‡è¦çš„å±æ€§æ˜¯ï¼š
- en: '`EvaluationModuleInfo.description` provides a brief description about your
    evalution module.'
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`EvaluationModuleInfo.description`æä¾›äº†æœ‰å…³æ‚¨çš„è¯„ä¼°æ¨¡å—çš„ç®€è¦æè¿°ã€‚'
- en: '`EvaluationModuleInfo.citation` contains a BibTex citation for the evalution
    module.'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`EvaluationModuleInfo.citation`åŒ…å«è¯„ä¼°æ¨¡å—çš„BibTexå¼•ç”¨ã€‚'
- en: '`EvaluationModuleInfo.inputs_description` describes the expected inputs and
    outputs. It may also provide an example usage of the evalution module.'
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`EvaluationModuleInfo.inputs_description`æè¿°äº†é¢„æœŸçš„è¾“å…¥å’Œè¾“å‡ºã€‚å®ƒè¿˜å¯èƒ½æä¾›è¯„ä¼°æ¨¡å—çš„ç¤ºä¾‹ç”¨æ³•ã€‚'
- en: '`EvaluationModuleInfo.features` defines the name and type of the predictions
    and references. This has to be either a single `datasets.Features` object or a
    list of `datasets.Features` objects if multiple input types are allowed.'
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`EvaluationModuleInfo.features`å®šä¹‰äº†é¢„æµ‹å’Œå‚è€ƒçš„åç§°å’Œç±»å‹ã€‚è¿™å¿…é¡»æ˜¯å•ä¸ª`datasets.Features`å¯¹è±¡æˆ–`datasets.Features`å¯¹è±¡åˆ—è¡¨ï¼Œå¦‚æœå…è®¸å¤šç§è¾“å…¥ç±»å‹ã€‚'
- en: Then, we can move on to prepare everything before the actual computation.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­å‡†å¤‡å®é™…è®¡ç®—ä¹‹å‰çš„æ‰€æœ‰äº‹é¡¹ã€‚
- en: Download
  id: totrans-22
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ä¸‹è½½
- en: 'Some evaluation modules require some external data such as NLTK that requires
    resources or the BLEURT metric that requires checkpoints. You can implement these
    downloads in `EvaluationModule._download_and_prepare()`, which downloads and caches
    the resources via the `dlmanager`. A simplified example on how BLEURT downloads
    and loads a checkpoint:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€äº›è¯„ä¼°æ¨¡å—éœ€è¦ä¸€äº›å¤–éƒ¨æ•°æ®ï¼Œä¾‹å¦‚éœ€è¦èµ„æºçš„NLTKæˆ–éœ€è¦æ£€æŸ¥ç‚¹çš„BLEURTåº¦é‡ã€‚æ‚¨å¯ä»¥åœ¨`EvaluationModule._download_and_prepare()`ä¸­å®ç°è¿™äº›ä¸‹è½½ï¼Œè¯¥æ–¹æ³•é€šè¿‡`dlmanager`ä¸‹è½½å’Œç¼“å­˜èµ„æºã€‚ä»¥ä¸‹æ˜¯BLEURTä¸‹è½½å’ŒåŠ è½½æ£€æŸ¥ç‚¹çš„ç®€åŒ–ç¤ºä¾‹ï¼š
- en: '[PRE3]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Or if you need to download the NLTK `"punkt"` resources:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ–è€…ï¼Œå¦‚æœæ‚¨éœ€è¦ä¸‹è½½NLTKçš„`"punkt"`èµ„æºï¼š
- en: '[PRE4]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Next, we need to define how the computation of the evaluation module works.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰è¯„ä¼°æ¨¡å—è®¡ç®—çš„æ–¹å¼ã€‚
- en: Compute
  id: totrans-28
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: è®¡ç®—
- en: 'The computation is performed in the `EvaluationModule._compute()` method. It
    takes the same arguments as `EvaluationModuleInfo.features` and should then return
    the result as a dictionary. Here an example of an exact match metric:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—æ˜¯åœ¨`EvaluationModule._compute()`æ–¹æ³•ä¸­æ‰§è¡Œçš„ã€‚å®ƒæ¥å—ä¸`EvaluationModuleInfo.features`ç›¸åŒçš„å‚æ•°ï¼Œç„¶ååº”å°†ç»“æœä½œä¸ºå­—å…¸è¿”å›ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªç²¾ç¡®åŒ¹é…åº¦é‡çš„ç¤ºä¾‹ï¼š
- en: '[PRE5]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: This method is used when you call `.compute()` later on.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æ‚¨ç¨åè°ƒç”¨`.compute()`æ—¶ï¼Œå°†ä½¿ç”¨æ­¤æ–¹æ³•ã€‚
- en: Readme
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è‡ªè¿°
- en: When you use the `evalute-cli` to setup the evaluation module the Readme structure
    and instructions are automatically created. It should include a general description
    of the metric, information about its input/output format, examples as well as
    information about its limiations or biases and references.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æ‚¨ä½¿ç”¨`evalute-cli`è®¾ç½®è¯„ä¼°æ¨¡å—æ—¶ï¼Œè‡ªè¿°ç»“æ„å’Œè¯´æ˜å°†è‡ªåŠ¨ç”Ÿæˆã€‚å®ƒåº”åŒ…æ‹¬æŒ‡æ ‡çš„ä¸€èˆ¬æè¿°ï¼Œæœ‰å…³å…¶è¾“å…¥/è¾“å‡ºæ ¼å¼çš„ä¿¡æ¯ï¼Œç¤ºä¾‹ä»¥åŠæœ‰å…³å…¶é™åˆ¶æˆ–åè§çš„ä¿¡æ¯å’Œå‚è€ƒèµ„æ–™ã€‚
- en: Requirements
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è¦æ±‚
- en: If your evaluation modules has additional dependencies (e.g. `sklearn` or `nltk`)
    the `requirements.txt` files is the place to put them. The file follows the `pip`
    format and you can list all dependencies there.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ‚¨çš„è¯„ä¼°æ¨¡å—æœ‰å…¶ä»–ä¾èµ–é¡¹ï¼ˆä¾‹å¦‚`sklearn`æˆ–`nltk`ï¼‰ï¼Œåˆ™`requirements.txt`æ–‡ä»¶æ˜¯æ”¾ç½®å®ƒä»¬çš„åœ°æ–¹ã€‚è¯¥æ–‡ä»¶éµå¾ª`pip`æ ¼å¼ï¼Œæ‚¨å¯ä»¥åœ¨é‚£é‡Œåˆ—å‡ºæ‰€æœ‰ä¾èµ–é¡¹ã€‚
- en: App
  id: totrans-36
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åº”ç”¨
- en: 'The `app.py` is where the Spaces widget lives. In general it looks like the
    following and does not require any changes:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '`app.py`æ˜¯Spaceså°éƒ¨ä»¶æ‰€åœ¨çš„åœ°æ–¹ã€‚é€šå¸¸çœ‹èµ·æ¥åƒä»¥ä¸‹å†…å®¹ï¼Œå¹¶ä¸”ä¸éœ€è¦ä»»ä½•æ›´æ”¹ï¼š'
- en: '[PRE6]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: If you want a custom widget you could add your gradio app here.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ‚¨æƒ³è¦ä¸€ä¸ªè‡ªå®šä¹‰å°éƒ¨ä»¶ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æ‚¨çš„gradioåº”ç”¨ç¨‹åºã€‚
- en: Push to Hub
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ¨é€åˆ°Hub
- en: 'Finally, when you are done with all the above changes it is time to push your
    evaluation module to the hub. To do so navigate to the folder of your module and
    git add/commit/push the changes to the hub:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œå½“æ‚¨å®Œæˆæ‰€æœ‰ä¸Šè¿°æ›´æ”¹æ—¶ï¼Œæ˜¯æ—¶å€™å°†æ‚¨çš„è¯„ä¼°æ¨¡å—æ¨é€åˆ°hubäº†ã€‚è¦è¿™æ ·åšï¼Œè¯·å¯¼èˆªåˆ°æ‚¨çš„æ¨¡å—æ–‡ä»¶å¤¹ï¼Œå¹¶å°†æ›´æ”¹æ·»åŠ /æäº¤/æ¨é€åˆ°hubï¼š
- en: '[PRE7]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Tada ğŸ‰! Your evaluation module is now on the ğŸ¤— Hub and ready to be used by everybody!
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: å¡”è¾¾ğŸ‰ï¼æ‚¨çš„è¯„ä¼°æ¨¡å—ç°åœ¨å·²ç»åœ¨ğŸ¤— Hubä¸Šï¼Œå¹¶ä¸”å‡†å¤‡å¥½ä¾›æ‰€æœ‰äººä½¿ç”¨ï¼
