# Informer

> åŸå§‹æ–‡æœ¬ï¼š[https://huggingface.co/docs/transformers/v4.37.2/en/model_doc/informer](https://huggingface.co/docs/transformers/v4.37.2/en/model_doc/informer)

## æ¦‚è¿°

Informeræ¨¡å‹ç”±å‘¨æµ©æ¯…ã€å¼ å°šèˆªã€å½­æ°ç¦ã€å¼ å¸…ã€æå»ºæ–°ã€ç†Šè¾‰å’Œå¼ ä¸‡æ‰åœ¨[Informer: Beyond Efficient Transformer for Long Sequence Time-Series Forecasting](https://arxiv.org/abs/2012.07436)ä¸­æå‡ºã€‚

è¯¥æ–¹æ³•å¼•å…¥äº†ä¸€ç§æ¦‚ç‡æ³¨æ„æœºåˆ¶ï¼Œç”¨äºé€‰æ‹©â€œæ´»è·ƒâ€æŸ¥è¯¢è€Œä¸æ˜¯â€œæ‡’æƒ°â€æŸ¥è¯¢ï¼Œå¹¶æä¾›äº†ä¸€ç§ç¨€ç–Transformerï¼Œä»è€Œå‡è½»äº†ä¼ ç»Ÿæ³¨æ„åŠ›çš„äºŒæ¬¡è®¡ç®—å’Œå†…å­˜éœ€æ±‚ã€‚

è¯¥è®ºæ–‡çš„æ‘˜è¦å¦‚ä¸‹ï¼š

*è®¸å¤šç°å®åº”ç”¨éœ€è¦é¢„æµ‹é•¿åºåˆ—æ—¶é—´åºåˆ—ï¼Œä¾‹å¦‚ç”µåŠ›æ¶ˆè€—è§„åˆ’ã€‚é•¿åºåˆ—æ—¶é—´åºåˆ—é¢„æµ‹ï¼ˆLSTFï¼‰è¦æ±‚æ¨¡å‹å…·æœ‰é«˜é¢„æµ‹èƒ½åŠ›ï¼Œå³èƒ½å¤Ÿæœ‰æ•ˆæ•æ‰è¾“å‡ºå’Œè¾“å…¥ä¹‹é—´ç²¾ç¡®çš„é•¿ç¨‹ä¾èµ–å…³ç³»è€¦åˆã€‚æœ€è¿‘çš„ç ”ç©¶è¡¨æ˜Transformeræœ‰å¢åŠ é¢„æµ‹èƒ½åŠ›çš„æ½œåŠ›ã€‚ç„¶è€Œï¼ŒTransformerå­˜åœ¨å‡ ä¸ªä¸¥é‡é—®é¢˜ï¼Œé˜»ç¢äº†å…¶ç›´æ¥åº”ç”¨äºLSTFï¼ŒåŒ…æ‹¬äºŒæ¬¡æ—¶é—´å¤æ‚åº¦ã€é«˜å†…å­˜ä½¿ç”¨å’Œç¼–ç å™¨-è§£ç å™¨æ¶æ„çš„å›ºæœ‰é™åˆ¶ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ç§é«˜æ•ˆçš„åŸºäºTransformerçš„LSTFæ¨¡å‹ï¼Œåä¸ºInformerï¼Œå…·æœ‰ä¸‰ä¸ªç‹¬ç‰¹ç‰¹å¾ï¼š(i) ProbSparseè‡ªæ³¨æ„æœºåˆ¶ï¼Œå®ç°äº†O(L logL)çš„æ—¶é—´å¤æ‚åº¦å’Œå†…å­˜ä½¿ç”¨ï¼Œå¹¶åœ¨åºåˆ—çš„ä¾èµ–å¯¹é½ä¸Šå…·æœ‰å¯æ¯”æ€§çš„æ€§èƒ½ã€‚(ii) è‡ªæ³¨æ„åŠ›æå–çªå‡ºä¸»å¯¼æ³¨æ„åŠ›ï¼Œé€šè¿‡å‡åŠçº§è”å±‚è¾“å…¥ï¼Œæœ‰æ•ˆå¤„ç†æé•¿è¾“å…¥åºåˆ—ã€‚(iii) ç”Ÿæˆå¼è§£ç å™¨ï¼Œæ¦‚å¿µä¸Šç®€å•ï¼Œå¯ä»¥ä¸€æ¬¡æ€§é¢„æµ‹é•¿æ—¶é—´åºåˆ—åºåˆ—ï¼Œè€Œä¸æ˜¯é€æ­¥é¢„æµ‹ï¼Œå¤§å¤§æé«˜äº†é•¿åºåˆ—é¢„æµ‹çš„æ¨ç†é€Ÿåº¦ã€‚å¯¹å››ä¸ªå¤§è§„æ¨¡æ•°æ®é›†çš„å¹¿æ³›å®éªŒè¡¨æ˜ï¼ŒInformeræ˜æ˜¾ä¼˜äºç°æœ‰æ–¹æ³•ï¼Œå¹¶ä¸ºLSTFé—®é¢˜æä¾›äº†æ–°çš„è§£å†³æ–¹æ¡ˆã€‚*

è¯¥æ¨¡å‹ç”±[elisim](https://huggingface.co/elisim)å’Œ[kashif](https://huggingface.co/kashif)è´¡çŒ®ã€‚åŸå§‹ä»£ç å¯åœ¨[æ­¤å¤„](https://github.com/zhouhaoyi/Informer2020)æ‰¾åˆ°ã€‚

## èµ„æº

ä»¥ä¸‹æ˜¯ä¸€äº›å®˜æ–¹Hugging Faceå’Œç¤¾åŒºï¼ˆç”±ğŸŒè¡¨ç¤ºï¼‰èµ„æºï¼Œå¯å¸®åŠ©æ‚¨å…¥é—¨ã€‚å¦‚æœæ‚¨æœ‰å…´è¶£æäº¤èµ„æºä»¥åŒ…å«åœ¨æ­¤å¤„ï¼Œè¯·éšæ—¶æ‰“å¼€Pull Requestï¼Œæˆ‘ä»¬å°†è¿›è¡Œå®¡æŸ¥ï¼èµ„æºåº”è¯¥å±•ç¤ºå‡ºä¸€äº›æ–°ä¸œè¥¿ï¼Œè€Œä¸æ˜¯é‡å¤ç°æœ‰èµ„æºã€‚

+   åœ¨HuggingFaceåšå®¢ä¸­æŸ¥çœ‹Informeråšæ–‡ï¼š[Multivariate Probabilistic Time Series Forecasting with Informer](https://huggingface.co/blog/informer)

## InformerConfig

### `class transformers.InformerConfig`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/informer/configuration_informer.py#L33)

```py
( prediction_length: Optional = None context_length: Optional = None distribution_output: str = 'student_t' loss: str = 'nll' input_size: int = 1 lags_sequence: List = None scaling: Union = 'mean' num_dynamic_real_features: int = 0 num_static_real_features: int = 0 num_static_categorical_features: int = 0 num_time_features: int = 0 cardinality: Optional = None embedding_dimension: Optional = None d_model: int = 64 encoder_ffn_dim: int = 32 decoder_ffn_dim: int = 32 encoder_attention_heads: int = 2 decoder_attention_heads: int = 2 encoder_layers: int = 2 decoder_layers: int = 2 is_encoder_decoder: bool = True activation_function: str = 'gelu' dropout: float = 0.05 encoder_layerdrop: float = 0.1 decoder_layerdrop: float = 0.1 attention_dropout: float = 0.1 activation_dropout: float = 0.1 num_parallel_samples: int = 100 init_std: float = 0.02 use_cache = True attention_type: str = 'prob' sampling_factor: int = 5 distil: bool = True **kwargs )
```

å‚æ•°

+   `prediction_length` (`int`) â€” è§£ç å™¨çš„é¢„æµ‹é•¿åº¦ã€‚æ¢å¥è¯è¯´ï¼Œæ¨¡å‹çš„é¢„æµ‹èŒƒå›´ã€‚è¿™ä¸ªå€¼é€šå¸¸ç”±æ•°æ®é›†å†³å®šï¼Œæˆ‘ä»¬å»ºè®®é€‚å½“è®¾ç½®ã€‚

+   `context_length` (`int`, *optional*, defaults to `prediction_length`) â€” ç¼–ç å™¨çš„ä¸Šä¸‹æ–‡é•¿åº¦ã€‚å¦‚æœä¸º`None`ï¼Œä¸Šä¸‹æ–‡é•¿åº¦å°†ä¸`prediction_length`ç›¸åŒã€‚

+   `distribution_output` (`string`, *optional*, defaults to `"student_t"`) â€” æ¨¡å‹çš„åˆ†å¸ƒå‘å°„å¤´ã€‚å¯ä»¥æ˜¯`"student_t"`ã€â€œnormalâ€æˆ–â€œnegative_binomialâ€ä¹‹ä¸€ã€‚

+   `loss` (`string`, *optional*, defaults to `"nll"`) â€” è¯¥æ¨¡å‹å¯¹åº”`distribution_output`å¤´éƒ¨çš„æŸå¤±å‡½æ•°ã€‚å¯¹äºå‚æ•°åˆ†å¸ƒï¼Œå®ƒæ˜¯è´Ÿå¯¹æ•°ä¼¼ç„¶(nll) - ç›®å‰æ˜¯å”¯ä¸€æ”¯æŒçš„ã€‚

+   `input_size` (`int`, *optional*, defaults to 1) â€” ç›®æ ‡å˜é‡çš„å¤§å°ï¼Œé»˜è®¤ä¸º1è¡¨ç¤ºå•å˜é‡ç›®æ ‡ã€‚å¯¹äºå¤šå˜é‡ç›®æ ‡ï¼Œåº”è¯¥å¤§äº1ã€‚

+   `scaling` (`string` or `bool`, *optional* defaults to `"mean"`) â€” æ˜¯å¦é€šè¿‡`"mean"`ç¼©æ”¾å™¨ã€â€œstdâ€ç¼©æ”¾å™¨æˆ–æ— ç¼©æ”¾å™¨ï¼ˆå¦‚æœä¸º`None`ï¼‰æ¥ç¼©æ”¾è¾“å…¥ç›®æ ‡ã€‚å¦‚æœä¸º`True`ï¼Œåˆ™ç¼©æ”¾å™¨è®¾ç½®ä¸º`"mean"`ã€‚

+   `lags_sequence` (`list[int]`, *optional*, defaults to `[1, 2, 3, 4, 5, 6, 7]`) â€” è¾“å…¥æ—¶é—´åºåˆ—çš„æ»åä½œä¸ºåå˜é‡ï¼Œé€šå¸¸ç”±æ•°æ®é¢‘ç‡å†³å®šã€‚é»˜è®¤ä¸º`[1, 2, 3, 4, 5, 6, 7]`ï¼Œä½†å»ºè®®æ ¹æ®æ•°æ®é›†é€‚å½“æ›´æ”¹ã€‚

+   `num_time_features` (`int`, *optional*, defaults to 0) â€” è¾“å…¥æ—¶é—´åºåˆ—ä¸­çš„æ—¶é—´ç‰¹å¾æ•°é‡ã€‚

+   `num_dynamic_real_features` (`int`, *optional*, defaults to 0) â€” åŠ¨æ€å®å€¼ç‰¹å¾çš„æ•°é‡ã€‚

+   `num_static_categorical_features` (`int`, *optional*, defaults to 0) â€” é™æ€åˆ†ç±»ç‰¹å¾çš„æ•°é‡ã€‚

+   `num_static_real_features` (`int`, *optional*, defaults to 0) â€” é™æ€å®å€¼ç‰¹å¾çš„æ•°é‡ã€‚

+   `cardinality` (`list[int]`, *optional*) â€” é™æ€åˆ†ç±»ç‰¹å¾çš„åŸºæ•°ï¼ˆä¸åŒå€¼çš„æ•°é‡ï¼‰ã€‚åº”è¯¥æ˜¯ä¸€ä¸ªæ•´æ•°åˆ—è¡¨ï¼Œé•¿åº¦ä¸`num_static_categorical_features`ç›¸åŒã€‚å¦‚æœ`num_static_categorical_features`å¤§äº0ï¼Œåˆ™ä¸èƒ½ä¸º`None`ã€‚

+   `embedding_dimension` (`list[int]`, *optional*) â€” æ¯ä¸ªé™æ€åˆ†ç±»ç‰¹å¾çš„åµŒå…¥ç»´åº¦ã€‚åº”è¯¥æ˜¯ä¸€ä¸ªæ•´æ•°åˆ—è¡¨ï¼Œé•¿åº¦ä¸`num_static_categorical_features`ç›¸åŒã€‚å¦‚æœ`num_static_categorical_features`å¤§äº0ï¼Œåˆ™ä¸èƒ½ä¸º`None`ã€‚

+   `d_model` (`int`, *optional*, defaults to 64) â€” transformerå±‚çš„ç»´åº¦ã€‚

+   `encoder_layers` (`int`, *optional*, defaults to 2) â€” ç¼–ç å™¨å±‚æ•°ã€‚

+   `decoder_layers` (`int`, *optional*, defaults to 2) â€” è§£ç å™¨å±‚æ•°ã€‚

+   `encoder_attention_heads` (`int`, *optional*, defaults to 2) â€” Transformerç¼–ç å™¨ä¸­æ¯ä¸ªæ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›å¤´æ•°ã€‚

+   `decoder_attention_heads` (`int`, *optional*, defaults to 2) â€” Transformerè§£ç å™¨ä¸­æ¯ä¸ªæ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›å¤´æ•°ã€‚

+   `encoder_ffn_dim` (`int`, *optional*, defaults to 32) â€” ç¼–ç å™¨ä¸­â€œä¸­é—´â€ï¼ˆé€šå¸¸ç§°ä¸ºå‰é¦ˆï¼‰å±‚çš„ç»´åº¦ã€‚

+   `decoder_ffn_dim` (`int`, *optional*, defaults to 32) â€” è§£ç å™¨ä¸­â€œä¸­é—´â€ï¼ˆé€šå¸¸ç§°ä¸ºå‰é¦ˆï¼‰å±‚çš„ç»´åº¦ã€‚

+   `activation_function` (`str` or `function`, *optional*, defaults to `"gelu"`) â€” ç¼–ç å™¨å’Œè§£ç å™¨ä¸­çš„éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆå‡½æ•°æˆ–å­—ç¬¦ä¸²ï¼‰ã€‚å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™æ”¯æŒ`"gelu"`å’Œ`"relu"`ã€‚

+   `dropout` (`float`, *optional*, defaults to 0.1) â€” ç¼–ç å™¨å’Œè§£ç å™¨ä¸­æ‰€æœ‰å…¨è¿æ¥å±‚çš„dropoutæ¦‚ç‡ã€‚

+   `encoder_layerdrop` (`float`, *optional*, defaults to 0.1) â€” æ¯ä¸ªç¼–ç å™¨å±‚çš„æ³¨æ„åŠ›å’Œå…¨è¿æ¥å±‚çš„dropoutæ¦‚ç‡ã€‚

+   `decoder_layerdrop` (`float`, *optional*, defaults to 0.1) â€” æ¯ä¸ªè§£ç å™¨å±‚çš„æ³¨æ„åŠ›å’Œå…¨è¿æ¥å±‚çš„dropoutæ¦‚ç‡ã€‚

+   `attention_dropout` (`float`, *optional*, defaults to 0.1) â€” æ³¨æ„åŠ›æ¦‚ç‡çš„dropoutæ¦‚ç‡ã€‚

+   `activation_dropout` (`float`, *optional*, defaults to 0.1) â€” å‰é¦ˆç½‘ç»œä¸¤å±‚ä¹‹é—´ä½¿ç”¨çš„dropoutæ¦‚ç‡ã€‚

+   `num_parallel_samples` (`int`, *optional*, defaults to 100) â€” æ¯ä¸ªæ¨æ–­æ—¶é—´æ­¥ç”Ÿæˆçš„å¹¶è¡Œæ ·æœ¬æ•°é‡ã€‚

+   `init_std` (`float`, *optional*, defaults to 0.02) â€” æˆªæ–­æ­£æ€æƒé‡åˆå§‹åŒ–åˆ†å¸ƒçš„æ ‡å‡†å·®ã€‚

+   `use_cache` (`bool`, *optional*, defaults to `True`) â€” æ˜¯å¦ä½¿ç”¨è¿‡å»çš„é”®/å€¼æ³¨æ„åŠ›ï¼ˆå¦‚æœé€‚ç”¨äºæ¨¡å‹ï¼‰ä»¥åŠ é€Ÿè§£ç ã€‚

+   `attention_type` (`str`, *optional*, defaults to â€œprobâ€) â€” ç¼–ç å™¨ä¸­ä½¿ç”¨çš„æ³¨æ„åŠ›æœºåˆ¶ã€‚å¯ä»¥è®¾ç½®ä¸ºâ€œprobâ€ï¼ˆInformerçš„ProbAttentionï¼‰æˆ–â€œfullâ€ï¼ˆä¼ ç»Ÿtransformerçš„è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼‰ã€‚

+   `sampling_factor`ï¼ˆ`int`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º5ï¼‰- ProbSparseé‡‡æ ·å› å­ï¼ˆä»…åœ¨`attention_type`=â€œprobâ€æ—¶ç”Ÿæ•ˆï¼‰ã€‚å®ƒç”¨äºæ§åˆ¶å‡å°‘çš„æŸ¥è¯¢çŸ©é˜µï¼ˆQ_reduceï¼‰çš„è¾“å…¥é•¿åº¦ã€‚

+   `distil`ï¼ˆ`bool`ï¼Œ*å¯é€‰*ï¼Œé»˜è®¤ä¸º`True`ï¼‰- æ˜¯å¦åœ¨ç¼–ç å™¨ä¸­ä½¿ç”¨è’¸é¦ã€‚

è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œç”¨äºå­˜å‚¨[InformerModel](/docs/transformers/v4.37.2/en/model_doc/informer#transformers.InformerModel)çš„é…ç½®ã€‚æ ¹æ®æŒ‡å®šçš„å‚æ•°å®ä¾‹åŒ–ä¸€ä¸ªInformeræ¨¡å‹ï¼Œå®šä¹‰æ¨¡å‹æ¶æ„ã€‚ä½¿ç”¨é»˜è®¤å€¼å®ä¾‹åŒ–é…ç½®å°†äº§ç”Ÿç±»ä¼¼äºInformer [huggingface/informer-tourism-monthly](https://huggingface.co/huggingface/informer-tourism-monthly) æ¶æ„çš„é…ç½®ã€‚

é…ç½®å¯¹è±¡ç»§æ‰¿è‡ª[PretrainedConfig](/docs/transformers/v4.37.2/en/main_classes/configuration#transformers.PretrainedConfig)ï¼Œå¯ç”¨äºæ§åˆ¶æ¨¡å‹è¾“å‡ºã€‚é˜…è¯»æ¥è‡ª[PretrainedConfig](/docs/transformers/v4.37.2/en/main_classes/configuration#transformers.PretrainedConfig)çš„æ–‡æ¡£ä»¥è·å–æ›´å¤šä¿¡æ¯ã€‚

ä¾‹ï¼š

```py
>>> from transformers import InformerConfig, InformerModel

>>> # Initializing an Informer configuration with 12 time steps for prediction
>>> configuration = InformerConfig(prediction_length=12)

>>> # Randomly initializing a model (with random weights) from the configuration
>>> model = InformerModel(configuration)

>>> # Accessing the model configuration
>>> configuration = model.config
```

## InformerModel

### `class transformers.InformerModel`

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/informer/modeling_informer.py#L1442)

```py
( config: InformerConfig )
```

å‚æ•°

+   `config`ï¼ˆ[TimeSeriesTransformerConfig](/docs/transformers/v4.37.2/en/model_doc/time_series_transformer#transformers.TimeSeriesTransformerConfig)ï¼‰- å…·æœ‰æ¨¡å‹æ‰€æœ‰å‚æ•°çš„æ¨¡å‹é…ç½®ç±»ã€‚ä½¿ç”¨é…ç½®æ–‡ä»¶åˆå§‹åŒ–ä¸ä¼šåŠ è½½ä¸æ¨¡å‹å…³è”çš„æƒé‡ï¼ŒåªåŠ è½½é…ç½®ã€‚æŸ¥çœ‹[from_pretrained()](/docs/transformers/v4.37.2/en/main_classes/model#transformers.PreTrainedModel.from_pretrained)æ–¹æ³•ä»¥åŠ è½½æ¨¡å‹æƒé‡ã€‚

è£¸Informeræ¨¡å‹è¾“å‡ºåŸå§‹éšè—çŠ¶æ€ï¼Œæ²¡æœ‰ç‰¹å®šçš„å¤´éƒ¨ã€‚æ­¤æ¨¡å‹ç»§æ‰¿è‡ª[PreTrainedModel](/docs/transformers/v4.37.2/en/main_classes/model#transformers.PreTrainedModel)ã€‚æ£€æŸ¥è¶…ç±»æ–‡æ¡£ä»¥è·å–åº“ä¸ºæ‰€æœ‰æ¨¡å‹å®ç°çš„é€šç”¨æ–¹æ³•ï¼ˆå¦‚ä¸‹è½½æˆ–ä¿å­˜ã€è°ƒæ•´è¾“å…¥åµŒå…¥ã€ä¿®å‰ªå¤´ç­‰ï¼‰ã€‚

è¯¥æ¨¡å‹è¿˜æ˜¯ä¸€ä¸ªPyTorch [torch.nn.Module](https://pytorch.org/docs/stable/nn.html#torch.nn.Module)å­ç±»ã€‚å°†å…¶ç”¨ä½œå¸¸è§„PyTorchæ¨¡å—ï¼Œå¹¶å‚è€ƒPyTorchæ–‡æ¡£ä»¥è·å–æœ‰å…³ä¸€èˆ¬ç”¨æ³•å’Œè¡Œä¸ºçš„æ‰€æœ‰ä¿¡æ¯ã€‚

å‰è¿›

[<æ¥æº>](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/informer/modeling_informer.py#L1585)

```py
( past_values: Tensor past_time_features: Tensor past_observed_mask: Tensor static_categorical_features: Optional = None static_real_features: Optional = None future_values: Optional = None future_time_features: Optional = None decoder_attention_mask: Optional = None head_mask: Optional = None decoder_head_mask: Optional = None cross_attn_head_mask: Optional = None encoder_outputs: Optional = None past_key_values: Optional = None output_hidden_states: Optional = None output_attentions: Optional = None use_cache: Optional = None return_dict: Optional = None ) â†’ export const metadata = 'undefined';transformers.modeling_outputs.Seq2SeqTSModelOutput or tuple(torch.FloatTensor)
```

å‚æ•°

+   `past_values`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length)`æˆ–`(batch_size, sequence_length, input_size)`çš„`torch.FloatTensor`ï¼‰- æ—¶é—´åºåˆ—çš„è¿‡å»å€¼ï¼Œç”¨ä½œä¸Šä¸‹æ–‡ä»¥é¢„æµ‹æœªæ¥ã€‚æ­¤å¼ é‡çš„åºåˆ—å¤§å°å¿…é¡»å¤§äºæ¨¡å‹çš„`context_length`ï¼Œå› ä¸ºæ¨¡å‹å°†ä½¿ç”¨è¾ƒå¤§çš„å¤§å°æ¥æ„å»ºæ»åç‰¹å¾ï¼Œå³ä»è¿‡å»æ·»åŠ çš„é¢å¤–å€¼ï¼Œä»¥å……å½“â€œé¢å¤–ä¸Šä¸‹æ–‡â€ã€‚

    è¿™é‡Œçš„`sequence_length`ç­‰äº`config.context_length` + `max(config.lags_sequence)`ï¼Œå¦‚æœæ²¡æœ‰é…ç½®`lags_sequence`ï¼Œåˆ™ç­‰äº`config.context_length` + 7ï¼ˆå› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œ`config.lags_sequence`ä¸­æœ€å¤§çš„å›æº¯ç´¢å¼•ä¸º7ï¼‰ã€‚å±æ€§`_past_length`è¿”å›è¿‡å»çš„å®é™…é•¿åº¦ã€‚

    `past_values`æ˜¯Transformerç¼–ç å™¨ä½œä¸ºè¾“å…¥çš„å†…å®¹ï¼ˆå¯é€‰çš„é™„åŠ ç‰¹å¾ï¼Œå¦‚`static_categorical_features`ã€`static_real_features`ã€`past_time_features`å’Œæ»åï¼‰ã€‚

    å¯é€‰åœ°ï¼Œç¼ºå¤±å€¼éœ€è¦ç”¨é›¶æ›¿æ¢ï¼Œå¹¶é€šè¿‡`past_observed_mask`æŒ‡ç¤ºã€‚

    å¯¹äºå¤šå˜é‡æ—¶é—´åºåˆ—ï¼Œéœ€è¦`input_size` > 1ç»´ï¼Œå¹¶å¯¹åº”äºæ¯ä¸ªæ—¶é—´æ­¥é•¿ä¸­æ—¶é—´åºåˆ—ä¸­çš„å˜é‡æ•°é‡ã€‚

+   `past_time_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length, num_features)`çš„`torch.FloatTensor`ï¼‰- å¿…éœ€çš„æ—¶é—´ç‰¹å¾ï¼Œæ¨¡å‹å°†å†…éƒ¨å°†è¿™äº›ç‰¹å¾æ·»åŠ åˆ°`past_values`ä¸­ã€‚è¿™äº›å¯èƒ½æ˜¯â€œå¹´ä»½çš„æœˆä»½â€ï¼Œâ€œæœˆä»½çš„æ—¥æœŸâ€ç­‰ï¼Œç¼–ç ä¸ºå‘é‡ï¼ˆä¾‹å¦‚ä½œä¸ºå‚…ç«‹å¶ç‰¹å¾ï¼‰ã€‚è¿™ä¹Ÿå¯ä»¥æ˜¯æ‰€è°“çš„â€œå¹´é¾„â€ç‰¹å¾ï¼ŒåŸºæœ¬ä¸Šå¸®åŠ©æ¨¡å‹çŸ¥é“æ—¶é—´åºåˆ—å¤„äºâ€œç”Ÿå‘½ä¸­çš„å“ªä¸ªé˜¶æ®µâ€ã€‚å¹´é¾„ç‰¹å¾å¯¹äºè¿œå¤„çš„è¿‡å»æ—¶é—´æ­¥å…·æœ‰è¾ƒå°çš„å€¼ï¼Œå¹¶ä¸”éšç€æˆ‘ä»¬æ¥è¿‘å½“å‰æ—¶é—´æ­¥è€Œå•è°ƒå¢åŠ ã€‚å‡æ—¥ç‰¹å¾ä¹Ÿæ˜¯æ—¶é—´ç‰¹å¾çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚

    è¿™äº›ç‰¹å¾å……å½“è¾“å…¥çš„â€œä½ç½®ç¼–ç â€ã€‚å› æ­¤ï¼Œä¸åƒBERTè¿™æ ·çš„æ¨¡å‹ç›¸åï¼ŒBERTçš„ä½ç½®ç¼–ç æ˜¯ä»å¤´å¼€å§‹å†…éƒ¨ä½œä¸ºæ¨¡å‹çš„å‚æ•°å­¦ä¹ çš„ï¼Œæ—¶é—´åºåˆ—Transformeréœ€è¦æä¾›é¢å¤–çš„æ—¶é—´ç‰¹å¾ã€‚æ—¶é—´åºåˆ—Transformerä»…ä¸º`static_categorical_features`å­¦ä¹ é¢å¤–çš„åµŒå…¥ã€‚

    å¯ä»¥å°†é¢å¤–çš„åŠ¨æ€å®æ•°åå˜é‡è¿æ¥åˆ°æ­¤å¼ é‡ä¸­ï¼Œä½†è¿™äº›ç‰¹å¾å¿…é¡»åœ¨é¢„æµ‹æ—¶å·²çŸ¥ã€‚

    è¿™é‡Œçš„`num_features`ç­‰äº`config.num_time_features`+`config.num_dynamic_real_features`ã€‚

+   `past_observed_mask`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length)`æˆ–`(batch_size, sequence_length, input_size)`çš„`torch.BoolTensor`ï¼Œ*å¯é€‰*ï¼‰- ç”¨äºæŒ‡ç¤ºå“ªäº›`past_values`è¢«è§‚å¯Ÿåˆ°ï¼Œå“ªäº›ç¼ºå¤±ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   å¯¹äºè¢«è§‚å¯Ÿåˆ°çš„æ•°å€¼ï¼Œ

    +   å¯¹äº`missing`çš„å€¼ä¸º0ï¼ˆå³è¢«æ›¿æ¢ä¸ºé›¶çš„NaNï¼‰ã€‚

+   `static_categorical_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, number of static categorical features)`çš„`torch.LongTensor`ï¼Œ*å¯é€‰*ï¼‰- æ¨¡å‹å°†å­¦ä¹ ä¸€ä¸ªåµŒå…¥ï¼Œå°†è¿™äº›é™æ€åˆ†ç±»ç‰¹å¾æ·»åŠ åˆ°æ—¶é—´åºåˆ—çš„å€¼ä¸­ã€‚

    é™æ€åˆ†ç±»ç‰¹å¾æ˜¯æ‰€æœ‰æ—¶é—´æ­¥çš„å€¼ç›¸åŒçš„ç‰¹å¾ï¼ˆéšæ—¶é—´ä¿æŒä¸å˜ï¼‰ã€‚

    é™æ€åˆ†ç±»ç‰¹å¾çš„å…¸å‹ç¤ºä¾‹æ˜¯æ—¶é—´åºåˆ—IDã€‚

+   `static_real_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, number of static real features)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰- æ¨¡å‹å°†å°†è¿™äº›é™æ€å®æ•°ç‰¹å¾æ·»åŠ åˆ°æ—¶é—´åºåˆ—çš„å€¼ä¸­ã€‚

    é™æ€å®æ•°ç‰¹å¾æ˜¯æ‰€æœ‰æ—¶é—´æ­¥çš„å€¼ç›¸åŒçš„ç‰¹å¾ï¼ˆéšæ—¶é—´ä¿æŒä¸å˜ï¼‰ã€‚

    é™æ€å®æ•°ç‰¹å¾çš„å…¸å‹ç¤ºä¾‹æ˜¯ä¿ƒé”€ä¿¡æ¯ã€‚

+   `future_values`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, prediction_length)`æˆ–`(batch_size, prediction_length, input_size)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰- æ—¶é—´åºåˆ—çš„æœªæ¥å€¼ï¼Œä½œä¸ºæ¨¡å‹çš„æ ‡ç­¾ã€‚`future_values`æ˜¯Transformeråœ¨è®­ç»ƒæœŸé—´éœ€è¦å­¦ä¹ è¾“å‡ºçš„å†…å®¹ï¼Œç»™å®š`past_values`ã€‚

    è¿™é‡Œçš„åºåˆ—é•¿åº¦ç­‰äº`prediction_length`ã€‚

    æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ¼”ç¤ºç¬”è®°æœ¬å’Œä»£ç ç‰‡æ®µã€‚

    åœ¨è®­ç»ƒæœŸé—´ï¼Œä»»ä½•ç¼ºå¤±å€¼éƒ½éœ€è¦ç”¨é›¶æ›¿æ¢ï¼Œå¹¶é€šè¿‡`future_observed_mask`æŒ‡ç¤ºã€‚

    å¯¹äºå¤šå˜é‡æ—¶é—´åºåˆ—ï¼Œéœ€è¦`input_size` > 1ç»´åº¦ï¼Œå¯¹åº”äºæ—¶é—´åºåˆ—æ¯ä¸ªæ—¶é—´æ­¥ä¸­çš„å˜é‡æ•°é‡ã€‚

+   `future_time_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, prediction_length, num_features)`çš„`torch.FloatTensor`ï¼‰- é¢„æµ‹çª—å£çš„å¿…éœ€æ—¶é—´ç‰¹å¾ï¼Œæ¨¡å‹å°†å†…éƒ¨å°†è¿™äº›ç‰¹å¾æ·»åŠ åˆ°`future_values`ä¸­ã€‚è¿™äº›å¯èƒ½æ˜¯â€œå¹´ä»½çš„æœˆä»½â€ï¼Œâ€œæœˆä»½çš„æ—¥æœŸâ€ç­‰ï¼Œç¼–ç ä¸ºå‘é‡ï¼ˆä¾‹å¦‚ä½œä¸ºå‚…ç«‹å¶ç‰¹å¾ï¼‰ã€‚è¿™ä¹Ÿå¯ä»¥æ˜¯æ‰€è°“çš„â€œå¹´é¾„â€ç‰¹å¾ï¼ŒåŸºæœ¬ä¸Šå¸®åŠ©æ¨¡å‹çŸ¥é“æ—¶é—´åºåˆ—å¤„äºâ€œç”Ÿå‘½ä¸­çš„å“ªä¸ªé˜¶æ®µâ€ã€‚å¹´é¾„ç‰¹å¾å¯¹äºè¿œå¤„çš„è¿‡å»æ—¶é—´æ­¥å…·æœ‰è¾ƒå°çš„å€¼ï¼Œå¹¶ä¸”éšç€æˆ‘ä»¬æ¥è¿‘å½“å‰æ—¶é—´æ­¥è€Œå•è°ƒå¢åŠ ã€‚å‡æ—¥ç‰¹å¾ä¹Ÿæ˜¯æ—¶é—´ç‰¹å¾çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚

    è¿™äº›ç‰¹å¾ä½œä¸ºè¾“å…¥çš„â€œä½ç½®ç¼–ç â€ã€‚å› æ­¤ï¼Œä¸BERTè¿™æ ·çš„æ¨¡å‹ä¸åŒï¼ŒBERTçš„ä½ç½®ç¼–ç æ˜¯ä»å¤´å¼€å§‹å†…éƒ¨ä½œä¸ºæ¨¡å‹çš„å‚æ•°å­¦ä¹ çš„ï¼Œæ—¶é—´åºåˆ—Transformeréœ€è¦æä¾›é¢å¤–çš„æ—¶é—´ç‰¹å¾ã€‚æ—¶é—´åºåˆ—Transformerä»…ä¸º`static_categorical_features`å­¦ä¹ é¢å¤–çš„åµŒå…¥ã€‚

    å¯ä»¥å°†é¢å¤–çš„åŠ¨æ€å®é™…åå˜é‡è¿æ¥åˆ°æ­¤å¼ é‡ä¸­ï¼Œä½†å¿…é¡»åœ¨é¢„æµ‹æ—¶å·²çŸ¥è¿™äº›ç‰¹å¾ã€‚

    è¿™é‡Œçš„`num_features`ç­‰äº`config.num_time_features`+`config.num_dynamic_real_features`ã€‚

+   `future_observed_mask`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length)`æˆ–`(batch_size, sequence_length, input_size)`çš„`torch.BoolTensor`ï¼Œ*å¯é€‰*ï¼‰â€” å¸ƒå°”æ©ç ï¼ŒæŒ‡ç¤ºå“ªäº›`future_values`è¢«è§‚å¯Ÿåˆ°ï¼Œå“ªäº›ç¼ºå¤±ã€‚æ©ç å€¼é€‰å®šåœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤º`å·²è§‚å¯Ÿåˆ°`çš„å€¼ï¼Œ

    +   0è¡¨ç¤º`ç¼ºå¤±`çš„å€¼ï¼ˆå³è¢«é›¶æ›¿æ¢çš„NaNï¼‰ã€‚

    æ­¤æ©ç ç”¨äºè¿‡æ»¤å‡ºæœ€ç»ˆæŸå¤±è®¡ç®—ä¸­çš„ç¼ºå¤±å€¼ã€‚

+   `attention_mask`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length)`çš„`torch.Tensor`ï¼Œ*å¯é€‰*ï¼‰â€” ç”¨äºé¿å…åœ¨æŸäº›æ ‡è®°ç´¢å¼•ä¸Šæ‰§è¡Œæ³¨æ„åŠ›çš„æ©ç ã€‚æ©ç å€¼é€‰å®šåœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºæ ‡è®°`æœªè¢«æ©ç `ï¼Œ

    +   0è¡¨ç¤º`è¢«æ©ç `çš„æ ‡è®°ã€‚

    [ä»€ä¹ˆæ˜¯æ³¨æ„åŠ›æ©ç ï¼Ÿ](../glossary#attention-mask)

+   `decoder_attention_mask`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, target_sequence_length)`çš„`torch.LongTensor`ï¼Œ*å¯é€‰*ï¼‰â€” ç”¨äºé¿å…åœ¨æŸäº›æ ‡è®°ç´¢å¼•ä¸Šæ‰§è¡Œæ³¨æ„åŠ›çš„æ©ç ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†ä½¿ç”¨å› æœæ©ç ï¼Œä»¥ç¡®ä¿æ¨¡å‹åªèƒ½æŸ¥çœ‹ä»¥å‰çš„è¾“å…¥ä»¥é¢„æµ‹æœªæ¥ã€‚

+   `head_mask`ï¼ˆå½¢çŠ¶ä¸º`(encoder_layers, encoder_attention_heads)`çš„`torch.Tensor`ï¼Œ*å¯é€‰*ï¼‰â€” ç”¨äºä½¿ç¼–ç å™¨ä¸­çš„æ³¨æ„åŠ›æ¨¡å—ä¸­çš„é€‰å®šå¤´éƒ¨å¤±æ•ˆçš„æ©ç ã€‚æ©ç å€¼é€‰å®šåœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºå¤´éƒ¨`æœªè¢«æ©ç `ï¼Œ

    +   0è¡¨ç¤ºå¤´éƒ¨è¢«`æ©ç `ã€‚

+   `decoder_head_mask`ï¼ˆå½¢çŠ¶ä¸º`(decoder_layers, decoder_attention_heads)`çš„`torch.Tensor`ï¼Œ*å¯é€‰*ï¼‰â€” ç”¨äºä½¿è§£ç å™¨ä¸­çš„æ³¨æ„åŠ›æ¨¡å—ä¸­çš„é€‰å®šå¤´éƒ¨å¤±æ•ˆçš„æ©ç ã€‚æ©ç å€¼é€‰å®šåœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºå¤´éƒ¨`æœªè¢«æ©ç `ï¼Œ

    +   0è¡¨ç¤ºå¤´éƒ¨è¢«`æ©ç `ã€‚

+   `cross_attn_head_mask`ï¼ˆå½¢çŠ¶ä¸º`(decoder_layers, decoder_attention_heads)`çš„`torch.Tensor`ï¼Œ*å¯é€‰*ï¼‰â€” ç”¨äºä½¿äº¤å‰æ³¨æ„åŠ›æ¨¡å—ä¸­çš„é€‰å®šå¤´éƒ¨å¤±æ•ˆçš„æ©ç ã€‚æ©ç å€¼é€‰å®šåœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºå¤´éƒ¨`æœªè¢«æ©ç `ï¼Œ

    +   0è¡¨ç¤ºå¤´éƒ¨è¢«`æ©ç `ã€‚

+   `encoder_outputs`ï¼ˆ`tuple(tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼‰â€” å…ƒç»„åŒ…å«`last_hidden_state`ã€`hidden_states`ï¼ˆ*å¯é€‰*ï¼‰å’Œ`attentions`ï¼ˆ*å¯é€‰*ï¼‰`last_hidden_state`çš„å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`ï¼ˆ*å¯é€‰*ï¼‰æ˜¯ç¼–ç å™¨æœ€åä¸€å±‚çš„è¾“å‡ºçš„éšè—çŠ¶æ€åºåˆ—ã€‚ç”¨äºè§£ç å™¨çš„äº¤å‰æ³¨æ„åŠ›ã€‚

+   `past_key_values`ï¼ˆ`tuple(tuple(torch.FloatTensor))`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`use_cache=True`æˆ–`config.use_cache=True`æ—¶è¿”å›ï¼‰â€” é•¿åº¦ä¸º`config.n_layers`çš„å…ƒç»„ï¼Œæ¯ä¸ªå…ƒç»„æœ‰2ä¸ªå½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, embed_size_per_head)`çš„å¼ é‡å’Œ2ä¸ªé¢å¤–çš„å½¢çŠ¶ä¸º`(batch_size, num_heads, encoder_sequence_length, embed_size_per_head)`çš„å¼ é‡ã€‚

    åŒ…å«é¢„å…ˆè®¡ç®—çš„éšè—çŠ¶æ€ï¼ˆè‡ªæ³¨æ„åŠ›å—å’Œäº¤å‰æ³¨æ„åŠ›å—ä¸­çš„é”®å’Œå€¼ï¼‰ï¼Œå¯ç”¨äºåŠ é€Ÿé¡ºåºè§£ç ã€‚

    å¦‚æœä½¿ç”¨äº†`past_key_values`ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©ä»…è¾“å…¥å½¢çŠ¶ä¸º`(batch_size, 1)`çš„æœ€å`decoder_input_ids`ï¼ˆå³é‚£äº›æ²¡æœ‰å°†å®ƒä»¬çš„è¿‡å»é”®å€¼çŠ¶æ€æä¾›ç»™æ­¤æ¨¡å‹çš„è¾“å…¥ï¼‰è€Œä¸æ˜¯å½¢çŠ¶ä¸º`(batch_size, sequence_length)`çš„æ‰€æœ‰`decoder_input_ids`ã€‚

+   `inputs_embeds` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`ï¼Œ*optional*) â€” å¯é€‰åœ°ï¼Œå¯ä»¥ç›´æ¥ä¼ é€’åµŒå…¥è¡¨ç¤ºï¼Œè€Œä¸æ˜¯ä¼ é€’`input_ids`ã€‚å¦‚æœæ‚¨æƒ³è¦æ›´å¤šæ§åˆ¶å¦‚ä½•å°†`input_ids`ç´¢å¼•è½¬æ¢ä¸ºç›¸å…³å‘é‡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ¨¡å‹çš„å†…éƒ¨åµŒå…¥æŸ¥æ‰¾çŸ©é˜µï¼Œåˆ™è¿™å¾ˆæœ‰ç”¨ã€‚

+   `use_cache` (`bool`, *optional*) â€” å¦‚æœè®¾ç½®ä¸º`True`ï¼Œåˆ™è¿”å›`past_key_values`é”®å€¼çŠ¶æ€ï¼Œå¯ç”¨äºåŠ é€Ÿè§£ç ï¼ˆå‚è§`past_key_values`ï¼‰ã€‚

+   `output_attentions` (`bool`, *optional*) â€” æ˜¯å¦è¿”å›æ‰€æœ‰æ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›å¼ é‡ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§è¿”å›å¼ é‡ä¸‹çš„`attentions`ã€‚

+   `output_hidden_states` (`bool`, *optional*) â€” æ˜¯å¦è¿”å›æ‰€æœ‰å±‚çš„éšè—çŠ¶æ€ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§è¿”å›å¼ é‡ä¸‹çš„`hidden_states`ã€‚

+   `return_dict` (`bool`, *optional*) â€” æ˜¯å¦è¿”å›[ModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.utils.ModelOutput)è€Œä¸æ˜¯æ™®é€šå…ƒç»„ã€‚

è¿”å›

[transformers.modeling_outputs.Seq2SeqTSModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.modeling_outputs.Seq2SeqTSModelOutput)æˆ–`tuple(torch.FloatTensor)`

ä¸€ä¸ª[transformers.modeling_outputs.Seq2SeqTSModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.modeling_outputs.Seq2SeqTSModelOutput)æˆ–ä¸€ä¸ª`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœä¼ é€’`return_dict=False`æˆ–`config.return_dict=False`ï¼‰åŒ…å«å„ç§å…ƒç´ ï¼Œå–å†³äºé…ç½®ï¼ˆ[InformerConfig](/docs/transformers/v4.37.2/en/model_doc/informer#transformers.InformerConfig)ï¼‰å’Œè¾“å…¥ã€‚

+   `last_hidden_state` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`) â€” æ¨¡å‹è§£ç å™¨æœ€åä¸€å±‚çš„éšè—çŠ¶æ€åºåˆ—ã€‚

    å¦‚æœä»…ä½¿ç”¨`past_key_values`ï¼Œåˆ™è¾“å‡ºå½¢çŠ¶ä¸º`(batch_size, 1, hidden_size)`çš„åºåˆ—çš„æœ€åä¸€ä¸ªéšè—çŠ¶æ€ã€‚

+   `past_key_values` (`tuple(tuple(torch.FloatTensor))`, *optional*, å½“ä¼ é€’`use_cache=True`æˆ–`config.use_cache=True`æ—¶è¿”å›ï¼‰ â€” é•¿åº¦ä¸º`config.n_layers`çš„`tuple(torch.FloatTensor)`å…ƒç»„ï¼Œæ¯ä¸ªå…ƒç»„æœ‰2ä¸ªå½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, embed_size_per_head)`çš„å¼ é‡ï¼Œä»¥åŠ2ä¸ªé¢å¤–çš„å½¢çŠ¶ä¸º`(batch_size, num_heads, encoder_sequence_length, embed_size_per_head)`çš„å¼ é‡ã€‚

    åŒ…å«é¢„å…ˆè®¡ç®—çš„éšè—çŠ¶æ€ï¼ˆè‡ªæ³¨æ„åŠ›å—å’Œäº¤å‰æ³¨æ„åŠ›å—ä¸­çš„é”®å’Œå€¼ï¼‰ï¼Œå¯ç”¨äºåŠ é€Ÿé¡ºåºè§£ç ï¼ˆå‚è§`past_key_values`è¾“å…¥ï¼‰ã€‚

+   `decoder_hidden_states` (`tuple(torch.FloatTensor)`, *optional*, å½“ä¼ é€’`output_hidden_states=True`æˆ–`config.output_hidden_states=True`æ—¶è¿”å›ï¼‰ â€” å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœæ¨¡å‹æœ‰åµŒå…¥å±‚ï¼Œåˆ™ä¸ºåµŒå…¥çš„è¾“å‡º+æ¯å±‚çš„è¾“å‡ºï¼‰ã€‚

    è§£ç å™¨åœ¨æ¯ä¸€å±‚è¾“å‡ºå¤„çš„éšè—çŠ¶æ€ï¼Œä»¥åŠå¯é€‰çš„åˆå§‹åµŒå…¥è¾“å‡ºã€‚

+   `decoder_attentions` (`tuple(torch.FloatTensor)`, *optional*, å½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›ï¼‰ â€” å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    è§£ç å™¨çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—è‡ªæ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `cross_attentions` (`tuple(torch.FloatTensor)`, *optional*, å½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›ï¼‰ â€” å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    è§£ç å™¨çš„äº¤å‰æ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—äº¤å‰æ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `encoder_last_hidden_state` (`torch.FloatTensor` of shape `(batch_size, sequence_length, hidden_size)`, *optional*) â€” æ¨¡å‹ç¼–ç å™¨æœ€åä¸€å±‚çš„éšè—çŠ¶æ€åºåˆ—ã€‚

+   `encoder_hidden_states` (`tuple(torch.FloatTensor)`, *optional*, å½“ä¼ é€’`output_hidden_states=True`æˆ–`config.output_hidden_states=True`æ—¶è¿”å›) â€” å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœæ¨¡å‹æœ‰åµŒå…¥å±‚ï¼Œåˆ™ä¸ºåµŒå…¥è¾“å‡ºçš„è¾“å‡º+æ¯å±‚çš„è¾“å‡ºï¼‰ã€‚

    æ¯å±‚ç¼–ç å™¨çš„éšè—çŠ¶æ€ä»¥åŠå¯é€‰çš„åˆå§‹åµŒå…¥è¾“å‡ºã€‚

+   `encoder_attentions` (`tuple(torch.FloatTensor)`, *optional*, å½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›) â€” å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    ç¼–ç å™¨çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—è‡ªæ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `loc` (`torch.FloatTensor` of shape `(batch_size,)` or `(batch_size, input_size)`, *optional*) â€” ç”¨äºç»™æ¨¡å‹è¾“å…¥ç›¸åŒæ•°é‡çº§çš„æ¯ä¸ªæ—¶é—´åºåˆ—ä¸Šä¸‹æ–‡çª—å£çš„åç§»å€¼ï¼Œç„¶åç”¨äºå°†å…¶åç§»å›åŸå§‹æ•°é‡çº§ã€‚

+   `scale` (`torch.FloatTensor` of shape `(batch_size,)` or `(batch_size, input_size)`, *optional*) â€” ç”¨äºç»™æ¨¡å‹è¾“å…¥ç›¸åŒæ•°é‡çº§çš„æ¯ä¸ªæ—¶é—´åºåˆ—ä¸Šä¸‹æ–‡çª—å£çš„ç¼©æ”¾å€¼ï¼Œç„¶åç”¨äºå°†å…¶é‡æ–°ç¼©æ”¾å›åŸå§‹æ•°é‡çº§ã€‚

+   `static_features` (`torch.FloatTensor` of shape `(batch_size, feature size)`, *optional*) â€” æ¯ä¸ªæ—¶é—´åºåˆ—åœ¨æ‰¹å¤„ç†ä¸­çš„é™æ€ç‰¹å¾ï¼Œåœ¨æ¨æ–­æ—¶è¢«å¤åˆ¶åˆ°åå˜é‡ä¸­ã€‚

[InformerModel](/docs/transformers/v4.37.2/en/model_doc/informer#transformers.InformerModel)çš„å‰å‘æ–¹æ³•ï¼Œè¦†ç›–äº†`__call__`ç‰¹æ®Šæ–¹æ³•ã€‚

è™½ç„¶å‰å‘ä¼ é€’çš„æ­¥éª¤éœ€è¦åœ¨æ­¤å‡½æ•°å†…å®šä¹‰ï¼Œä½†åº”è¯¥åœ¨æ­¤ä¹‹åè°ƒç”¨`Module`å®ä¾‹ï¼Œè€Œä¸æ˜¯åœ¨æ­¤å¤„è°ƒç”¨ï¼Œå› ä¸ºå‰è€…è´Ÿè´£è¿è¡Œé¢„å¤„ç†å’Œåå¤„ç†æ­¥éª¤ï¼Œè€Œåè€…åˆ™é»˜é»˜åœ°å¿½ç•¥å®ƒä»¬ã€‚

ç¤ºä¾‹ï¼š

```py
>>> from huggingface_hub import hf_hub_download
>>> import torch
>>> from transformers import InformerModel

>>> file = hf_hub_download(
...     repo_id="hf-internal-testing/tourism-monthly-batch", filename="train-batch.pt", repo_type="dataset"
... )
>>> batch = torch.load(file)

>>> model = InformerModel.from_pretrained("huggingface/informer-tourism-monthly")

>>> # during training, one provides both past and future values
>>> # as well as possible additional features
>>> outputs = model(
...     past_values=batch["past_values"],
...     past_time_features=batch["past_time_features"],
...     past_observed_mask=batch["past_observed_mask"],
...     static_categorical_features=batch["static_categorical_features"],
...     static_real_features=batch["static_real_features"],
...     future_values=batch["future_values"],
...     future_time_features=batch["future_time_features"],
... )

>>> last_hidden_state = outputs.last_hidden_state
```

## InformerForPrediction

### `class transformers.InformerForPrediction`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/informer/modeling_informer.py#L1704)

```py
( config: InformerConfig )
```

å‚æ•°

+   `config` ([TimeSeriesTransformerConfig](/docs/transformers/v4.37.2/en/model_doc/time_series_transformer#transformers.TimeSeriesTransformerConfig)) â€” å…·æœ‰æ¨¡å‹æ‰€æœ‰å‚æ•°çš„æ¨¡å‹é…ç½®ç±»ã€‚ä½¿ç”¨é…ç½®æ–‡ä»¶åˆå§‹åŒ–ä¸ä¼šåŠ è½½ä¸æ¨¡å‹ç›¸å…³çš„æƒé‡ï¼ŒåªåŠ è½½é…ç½®ã€‚æŸ¥çœ‹[from_pretrained()](/docs/transformers/v4.37.2/en/main_classes/model#transformers.PreTrainedModel.from_pretrained)æ–¹æ³•ä»¥åŠ è½½æ¨¡å‹æƒé‡ã€‚

Informeræ¨¡å‹åœ¨æ—¶é—´åºåˆ—é¢„æµ‹çš„é¡¶éƒ¨å…·æœ‰åˆ†å¸ƒå¤´ã€‚è¯¥æ¨¡å‹ç»§æ‰¿è‡ª[PreTrainedModel](/docs/transformers/v4.37.2/en/main_classes/model#transformers.PreTrainedModel)ã€‚æŸ¥çœ‹è¶…ç±»æ–‡æ¡£ä»¥è·å–åº“ä¸ºæ‰€æœ‰æ¨¡å‹å®ç°çš„é€šç”¨æ–¹æ³•ï¼ˆå¦‚ä¸‹è½½æˆ–ä¿å­˜ã€è°ƒæ•´è¾“å…¥åµŒå…¥ã€ä¿®å‰ªå¤´ç­‰ï¼‰ã€‚

è¿™ä¸ªæ¨¡å‹ä¹Ÿæ˜¯ä¸€ä¸ªPyTorch [torch.nn.Module](https://pytorch.org/docs/stable/nn.html#torch.nn.Module)å­ç±»ã€‚å°†å…¶ç”¨ä½œå¸¸è§„çš„PyTorchæ¨¡å—ï¼Œå¹¶å‚è€ƒPyTorchæ–‡æ¡£ä»¥è·å–ä¸ä¸€èˆ¬ç”¨æ³•å’Œè¡Œä¸ºç›¸å…³çš„æ‰€æœ‰å†…å®¹ã€‚

#### `forward`

[< source >](https://github.com/huggingface/transformers/blob/v4.37.2/src/transformers/models/informer/modeling_informer.py#L1749)

```py
( past_values: Tensor past_time_features: Tensor past_observed_mask: Tensor static_categorical_features: Optional = None static_real_features: Optional = None future_values: Optional = None future_time_features: Optional = None future_observed_mask: Optional = None decoder_attention_mask: Optional = None head_mask: Optional = None decoder_head_mask: Optional = None cross_attn_head_mask: Optional = None encoder_outputs: Optional = None past_key_values: Optional = None output_hidden_states: Optional = None output_attentions: Optional = None use_cache: Optional = None return_dict: Optional = None ) â†’ export const metadata = 'undefined';transformers.modeling_outputs.Seq2SeqTSModelOutput or tuple(torch.FloatTensor)
```

å‚æ•°

+   `past_values`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length)`æˆ–`(batch_size, sequence_length, input_size)`çš„`torch.FloatTensor`ï¼‰- æ—¶é—´åºåˆ—çš„è¿‡å»å€¼ï¼Œç”¨ä½œä¸Šä¸‹æ–‡ä»¥é¢„æµ‹æœªæ¥ã€‚æ­¤å¼ é‡çš„åºåˆ—å¤§å°å¿…é¡»å¤§äºæ¨¡å‹çš„`context_length`ï¼Œå› ä¸ºæ¨¡å‹å°†ä½¿ç”¨è¾ƒå¤§çš„å¤§å°æ¥æ„å»ºæ»åç‰¹å¾ï¼Œå³ä»è¿‡å»æ·»åŠ çš„é¢å¤–å€¼ï¼Œä»¥å……å½“â€œé¢å¤–ä¸Šä¸‹æ–‡â€ã€‚

    è¿™é‡Œçš„`sequence_length`ç­‰äº`config.context_length` + `max(config.lags_sequence)`ï¼Œå¦‚æœæ²¡æœ‰é…ç½®`lags_sequence`ï¼Œåˆ™ç­‰äº`config.context_length` + 7ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œ`config.lags_sequence`ä¸­æœ€å¤§çš„å›é¡¾ç´¢å¼•ä¸º7ï¼‰ã€‚å±æ€§`_past_length`è¿”å›è¿‡å»çš„å®é™…é•¿åº¦ã€‚

    `past_values`æ˜¯Transformerç¼–ç å™¨ä½œä¸ºè¾“å…¥æ¥æ”¶çš„å†…å®¹ï¼ˆè¿˜å¯ä»¥åŒ…æ‹¬é¢å¤–ç‰¹å¾ï¼Œå¦‚`static_categorical_features`ã€`static_real_features`ã€`past_time_features`å’Œæ»åï¼‰ã€‚

    å¯é€‰åœ°ï¼Œç¼ºå¤±å€¼éœ€è¦ç”¨é›¶æ›¿æ¢ï¼Œå¹¶é€šè¿‡`past_observed_mask`æŒ‡ç¤ºã€‚

    å¯¹äºå¤šå˜é‡æ—¶é—´åºåˆ—ï¼Œ`input_size` > 1ç»´åº¦æ˜¯å¿…éœ€çš„ï¼Œå¯¹åº”äºæ—¶é—´åºåˆ—ä¸­æ¯ä¸ªæ—¶é—´æ­¥çš„å˜é‡æ•°é‡ã€‚

+   `past_time_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length, num_features)`çš„`torch.FloatTensor`ï¼‰- å¿…éœ€çš„æ—¶é—´ç‰¹å¾ï¼Œæ¨¡å‹å°†å†…éƒ¨æ·»åŠ åˆ°`past_values`ä¸­ã€‚è¿™äº›å¯èƒ½æ˜¯è¯¸å¦‚â€œå¹´ä»½çš„æœˆä»½â€ï¼Œâ€œæœˆä»½çš„æ—¥æœŸâ€ç­‰ç¼–ç ä¸ºå‘é‡çš„å†…å®¹ï¼ˆä¾‹å¦‚ä½œä¸ºå‚…ç«‹å¶ç‰¹å¾ï¼‰ã€‚è¿™ä¹Ÿå¯èƒ½æ˜¯æ‰€è°“çš„â€œå¹´é¾„â€ç‰¹å¾ï¼ŒåŸºæœ¬ä¸Šå¸®åŠ©æ¨¡å‹çŸ¥é“æ—¶é—´åºåˆ—å¤„äºâ€œç”Ÿå‘½ä¸­çš„å“ªä¸ªé˜¶æ®µâ€ã€‚å¹´é¾„ç‰¹å¾å¯¹äºè¿œå¤„çš„è¿‡å»æ—¶é—´æ­¥å…·æœ‰è¾ƒå°çš„å€¼ï¼Œå¹¶ä¸”éšç€æˆ‘ä»¬æ¥è¿‘å½“å‰æ—¶é—´æ­¥è€Œå•è°ƒå¢åŠ ã€‚å‡æœŸç‰¹å¾ä¹Ÿæ˜¯æ—¶é—´ç‰¹å¾çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚

    è¿™äº›ç‰¹å¾å……å½“è¾“å…¥çš„â€œä½ç½®ç¼–ç â€ã€‚å› æ­¤ï¼Œä¸åƒBERTè¿™æ ·çš„æ¨¡å‹ç›¸åï¼ŒBERTæ¨¡å‹ä¸­çš„ä½ç½®ç¼–ç æ˜¯ä»å¤´å¼€å§‹å†…éƒ¨å­¦ä¹ çš„æ¨¡å‹å‚æ•°ï¼Œæ—¶é—´åºåˆ—Transformeréœ€è¦æä¾›é¢å¤–çš„æ—¶é—´ç‰¹å¾ã€‚æ—¶é—´åºåˆ—Transformerä»…ä¸º`static_categorical_features`å­¦ä¹ é¢å¤–çš„åµŒå…¥ã€‚

    å¯ä»¥å°†é¢å¤–çš„åŠ¨æ€å®åå˜é‡è¿æ¥åˆ°æ­¤å¼ é‡ä¸­ï¼Œä½†å¿…é¡»åœ¨é¢„æµ‹æ—¶çŸ¥é“è¿™äº›ç‰¹å¾ã€‚

    è¿™é‡Œçš„`num_features`ç­‰äº`config.num_time_features`+`config.num_dynamic_real_features`ã€‚

+   `past_observed_mask`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length)`æˆ–`(batch_size, sequence_length, input_size)`çš„`torch.BoolTensor`ï¼Œ*å¯é€‰*ï¼‰- å¸ƒå°”æ©ç ï¼ŒæŒ‡ç¤ºå“ªäº›`past_values`æ˜¯è§‚å¯Ÿåˆ°çš„ï¼Œå“ªäº›æ˜¯ç¼ºå¤±çš„ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   å¯¹äº`observed`çš„å€¼ä¸º1ï¼Œ

    +   å¯¹äº`missing`çš„å€¼ä¸º0ï¼ˆå³ç”¨é›¶æ›¿æ¢çš„NaNï¼‰ã€‚

+   `static_categorical_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, number of static categorical features)`çš„`torch.LongTensor`ï¼Œ*å¯é€‰*ï¼‰- æ¨¡å‹å°†å­¦ä¹ åµŒå…¥çš„å¯é€‰é™æ€åˆ†ç±»ç‰¹å¾ï¼Œç„¶åå°†å…¶æ·»åŠ åˆ°æ—¶é—´åºåˆ—å€¼ä¸­ã€‚

    é™æ€åˆ†ç±»ç‰¹å¾æ˜¯æ‰€æœ‰æ—¶é—´æ­¥çš„å€¼ç›¸åŒçš„ç‰¹å¾ï¼ˆéšæ—¶é—´ä¿æŒä¸å˜ï¼‰ã€‚

    é™æ€åˆ†ç±»ç‰¹å¾çš„å…¸å‹ç¤ºä¾‹æ˜¯æ—¶é—´åºåˆ—IDã€‚

+   `static_real_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, number of static real features)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰- æ¨¡å‹å°†æ·»åŠ åˆ°æ—¶é—´åºåˆ—å€¼ä¸­çš„å¯é€‰é™æ€å®ç‰¹å¾ã€‚

    é™æ€å®ç‰¹å¾æ˜¯æ‰€æœ‰æ—¶é—´æ­¥çš„å€¼ç›¸åŒçš„ç‰¹å¾ï¼ˆéšæ—¶é—´ä¿æŒä¸å˜ï¼‰ã€‚

    é™æ€å®ç‰¹å¾çš„å…¸å‹ç¤ºä¾‹æ˜¯ä¿ƒé”€ä¿¡æ¯ã€‚

+   `future_values`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, prediction_length)`æˆ–`(batch_size, prediction_length, input_size)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰- æ—¶é—´åºåˆ—çš„æœªæ¥å€¼ï¼Œç”¨ä½œæ¨¡å‹çš„æ ‡ç­¾ã€‚`future_values`æ˜¯Transformeråœ¨è®­ç»ƒæœŸé—´éœ€è¦å­¦ä¹ è¾“å‡ºçš„å†…å®¹ï¼Œç»™å®š`past_values`ã€‚

    è¿™é‡Œçš„åºåˆ—é•¿åº¦ç­‰äº`prediction_length`ã€‚

    æŸ¥çœ‹æ¼”ç¤ºç¬”è®°æœ¬å’Œä»£ç ç‰‡æ®µä»¥è·å–è¯¦ç»†ä¿¡æ¯ã€‚

    åœ¨è®­ç»ƒæœŸé—´ï¼Œä»»ä½•ç¼ºå¤±å€¼éƒ½éœ€è¦è¢«æ›¿æ¢ä¸ºé›¶ï¼Œå¹¶é€šè¿‡`future_observed_mask`æŒ‡ç¤ºã€‚

    å¯¹äºå¤šå˜é‡æ—¶é—´åºåˆ—ï¼Œ`input_size` > 1ç»´åº¦æ˜¯å¿…éœ€çš„ï¼Œå¯¹åº”äºæ¯ä¸ªæ—¶é—´æ­¥é•¿ä¸­æ—¶é—´åºåˆ—ä¸­çš„å˜é‡æ•°ã€‚

+   `future_time_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, prediction_length, num_features)`çš„`torch.FloatTensor`ï¼‰- é¢„æµ‹çª—å£æ‰€éœ€çš„æ—¶é—´ç‰¹å¾ï¼Œæ¨¡å‹å†…éƒ¨å°†è¿™äº›ç‰¹å¾æ·»åŠ åˆ°`future_values`ä¸­ã€‚è¿™äº›ç‰¹å¾å¯ä»¥æ˜¯è¯¸å¦‚â€œå¹´ä»½çš„æœˆä»½â€ï¼Œâ€œæœˆä»½çš„æ—¥æœŸâ€ç­‰ã€‚ç¼–ç ä¸ºå‘é‡ï¼ˆä¾‹å¦‚å‚…ç«‹å¶ç‰¹å¾ï¼‰ã€‚è¿™äº›ä¹Ÿå¯ä»¥æ˜¯æ‰€è°“çš„â€œå¹´é¾„â€ç‰¹å¾ï¼ŒåŸºæœ¬ä¸Šå¸®åŠ©æ¨¡å‹çŸ¥é“æ—¶é—´åºåˆ—å¤„äºâ€œç”Ÿå‘½ä¸­çš„å“ªä¸ªé˜¶æ®µâ€ã€‚å¹´é¾„ç‰¹å¾å¯¹äºè¿‡å»çš„æ—¶é—´æ­¥å…·æœ‰è¾ƒå°çš„å€¼ï¼Œå¹¶ä¸”éšç€æˆ‘ä»¬æ¥è¿‘å½“å‰æ—¶é—´æ­¥ï¼Œå€¼ä¼šå•è°ƒå¢åŠ ã€‚å‡æœŸç‰¹å¾ä¹Ÿæ˜¯æ—¶é—´ç‰¹å¾çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚

    è¿™äº›ç‰¹å¾ä½œä¸ºè¾“å…¥çš„â€œä½ç½®ç¼–ç â€ã€‚å› æ­¤ï¼Œä¸BERTè¿™æ ·çš„æ¨¡å‹ç›¸åï¼ŒBERTçš„ä½ç½®ç¼–ç æ˜¯ä»å¤´å¼€å§‹å†…éƒ¨ä½œä¸ºæ¨¡å‹çš„å‚æ•°å­¦ä¹ çš„ï¼Œæ—¶é—´åºåˆ—Transformeréœ€è¦æä¾›é¢å¤–çš„æ—¶é—´ç‰¹å¾ã€‚æ—¶é—´åºåˆ—Transformerä»…ä¸º`static_categorical_features`å­¦ä¹ é¢å¤–çš„åµŒå…¥ã€‚

    å¯ä»¥å°†é¢å¤–çš„åŠ¨æ€å®é™…åå˜é‡è¿æ¥åˆ°è¿™ä¸ªå¼ é‡ä¸­ï¼Œä½†å¿…é¡»åœ¨é¢„æµ‹æ—¶çŸ¥é“è¿™äº›ç‰¹å¾ã€‚

    è¿™é‡Œçš„`num_features`ç­‰äº`config.num_time_features`+`config.num_dynamic_real_features`ã€‚

+   `future_observed_mask`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length)`æˆ–`(batch_size, sequence_length, input_size)`çš„`torch.BoolTensor`ï¼Œ*å¯é€‰*ï¼‰- å¸ƒå°”æ©ç ï¼ŒæŒ‡ç¤ºå“ªäº›`future_values`æ˜¯è§‚å¯Ÿåˆ°çš„ï¼Œå“ªäº›æ˜¯ç¼ºå¤±çš„ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤º`observed`çš„å€¼ï¼Œ

    +   0è¡¨ç¤º`missing`çš„å€¼ï¼ˆå³è¢«é›¶æ›¿æ¢çš„NaNï¼‰ã€‚

    æ­¤æ©ç ç”¨äºè¿‡æ»¤å‡ºæœ€ç»ˆæŸå¤±è®¡ç®—ä¸­çš„ç¼ºå¤±å€¼ã€‚

+   `attention_mask`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length)`çš„`torch.Tensor`ï¼Œ*å¯é€‰*ï¼‰- ç”¨äºé¿å…å¯¹æŸäº›æ ‡è®°ç´¢å¼•æ‰§è¡Œæ³¨æ„åŠ›çš„æ©ç ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºæœªè¢«`masked`çš„æ ‡è®°ï¼Œ

    +   0è¡¨ç¤ºè¢«`masked`çš„æ ‡è®°ã€‚

    [ä»€ä¹ˆæ˜¯æ³¨æ„åŠ›æ©ç ï¼Ÿ](../glossary#attention-mask)

+   `decoder_attention_mask`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, target_sequence_length)`çš„`torch.LongTensor`ï¼Œ*å¯é€‰*ï¼‰- ç”¨äºé¿å…å¯¹æŸäº›æ ‡è®°ç´¢å¼•æ‰§è¡Œæ³¨æ„åŠ›çš„æ©ç ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†ä½¿ç”¨å› æœæ©ç ï¼Œä»¥ç¡®ä¿æ¨¡å‹åªèƒ½æŸ¥çœ‹ä»¥å‰çš„è¾“å…¥ä»¥é¢„æµ‹æœªæ¥ã€‚

+   `head_mask`ï¼ˆå½¢çŠ¶ä¸º`(encoder_layers, encoder_attention_heads)`çš„`torch.Tensor`ï¼Œ*å¯é€‰*ï¼‰- ç”¨äºå°†ç¼–ç å™¨ä¸­æ³¨æ„åŠ›æ¨¡å—çš„é€‰å®šå¤´éƒ¨ç½®é›¶çš„æ©ç ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºå¤´éƒ¨æœªè¢«`masked`,

    +   0è¡¨ç¤ºå¤´éƒ¨è¢«`masked`ã€‚

+   `decoder_head_mask`ï¼ˆå½¢çŠ¶ä¸º`(decoder_layers, decoder_attention_heads)`çš„`torch.Tensor`ï¼Œ*å¯é€‰*ï¼‰- ç”¨äºå°†è§£ç å™¨ä¸­æ³¨æ„åŠ›æ¨¡å—çš„é€‰å®šå¤´éƒ¨ç½®é›¶çš„æ©ç ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºå¤´éƒ¨æœªè¢«`masked`,

    +   0è¡¨ç¤ºå¤´éƒ¨è¢«`masked`ã€‚

+   `cross_attn_head_mask`ï¼ˆå½¢çŠ¶ä¸º`(decoder_layers, decoder_attention_heads)`çš„`torch.Tensor`ï¼Œ*å¯é€‰*ï¼‰- ç”¨äºå°†äº¤å‰æ³¨æ„åŠ›æ¨¡å—çš„é€‰å®šå¤´éƒ¨ç½®é›¶çš„æ©ç ã€‚æ©ç å€¼é€‰åœ¨`[0, 1]`ä¹‹é—´ï¼š

    +   1è¡¨ç¤ºå¤´éƒ¨æœªè¢«`masked`,

    +   0è¡¨ç¤ºå¤´éƒ¨è¢«`masked`ã€‚

+   `encoder_outputs`ï¼ˆå…ƒç»„ï¼ˆå…ƒç»„ï¼ˆ`torch.FloatTensor`ï¼‰, *å¯é€‰*ï¼‰- å…ƒç»„ç”±`last_hidden_state`ã€`hidden_states`ï¼ˆ*å¯é€‰*ï¼‰å’Œ`attentions`ï¼ˆ*å¯é€‰*ï¼‰ç»„æˆï¼Œ`last_hidden_state`çš„å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`ï¼ˆ*å¯é€‰*ï¼‰æ˜¯ç¼–ç å™¨æœ€åä¸€å±‚çš„éšè—çŠ¶æ€çš„åºåˆ—ã€‚ç”¨äºè§£ç å™¨çš„äº¤å‰æ³¨æ„åŠ›ã€‚

+   `past_key_values` (`tuple(tuple(torch.FloatTensor))`, *optional*, å½“ä¼ é€’`use_cache=True`æˆ–`config.use_cache=True`æ—¶è¿”å›) â€” ç”±é•¿åº¦ä¸º`config.n_layers`çš„`tuple(torch.FloatTensor)`ç»„æˆçš„å…ƒç»„ï¼Œæ¯ä¸ªå…ƒç»„æœ‰2ä¸ªå½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, embed_size_per_head)`çš„å¼ é‡å’Œ2ä¸ªé¢å¤–çš„å½¢çŠ¶ä¸º`(batch_size, num_heads, encoder_sequence_length, embed_size_per_head)`çš„å¼ é‡ã€‚

    åŒ…å«é¢„å…ˆè®¡ç®—çš„éšè—çŠ¶æ€ï¼ˆè‡ªæ³¨æ„åŠ›å—å’Œäº¤å‰æ³¨æ„åŠ›å—ä¸­çš„é”®å’Œå€¼ï¼‰ï¼Œå¯ç”¨äºåŠ é€Ÿé¡ºåºè§£ç ã€‚

    å¦‚æœä½¿ç”¨`past_key_values`ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©ä»…è¾“å…¥å½¢çŠ¶ä¸º`(batch_size, 1)`çš„æœ€åä¸€ä¸ª`decoder_input_ids`ï¼ˆè¿™äº›æ²¡æœ‰å°†å®ƒä»¬çš„è¿‡å»é”®å€¼çŠ¶æ€æä¾›ç»™æ­¤æ¨¡å‹ï¼‰è€Œä¸æ˜¯å½¢çŠ¶ä¸º`(batch_size, sequence_length)`çš„æ‰€æœ‰`decoder_input_ids`ã€‚

+   `inputs_embeds` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`ï¼Œ*optional*) â€” å¯é€‰åœ°ï¼Œå¯ä»¥ç›´æ¥ä¼ é€’åµŒå…¥è¡¨ç¤ºï¼Œè€Œä¸æ˜¯ä¼ é€’`input_ids`ã€‚å¦‚æœæ‚¨æƒ³è¦æ›´å¤šæ§åˆ¶å¦‚ä½•å°†`input_ids`ç´¢å¼•è½¬æ¢ä¸ºç›¸å…³å‘é‡ï¼Œè€Œä¸æ˜¯æ¨¡å‹çš„å†…éƒ¨åµŒå…¥æŸ¥æ‰¾çŸ©é˜µï¼Œåˆ™è¿™å¾ˆæœ‰ç”¨ã€‚

+   `use_cache` (`bool`ï¼Œ*optional*) â€” å¦‚æœè®¾ç½®ä¸º`True`ï¼Œåˆ™è¿”å›`past_key_values`é”®å€¼çŠ¶æ€ï¼Œå¹¶å¯ç”¨äºåŠ é€Ÿè§£ç ï¼ˆå‚è§`past_key_values`ï¼‰ã€‚

+   `output_attentions` (`bool`ï¼Œ*optional*) â€” æ˜¯å¦è¿”å›æ‰€æœ‰æ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›å¼ é‡ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…è¿”å›å¼ é‡ä¸‹çš„`attentions`ã€‚

+   `output_hidden_states` (`bool`ï¼Œ*optional*) â€” æ˜¯å¦è¿”å›æ‰€æœ‰å±‚çš„éšè—çŠ¶æ€ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…è¿”å›å¼ é‡ä¸‹çš„`hidden_states`ã€‚

+   `return_dict` (`bool`ï¼Œ*optional*) â€” æ˜¯å¦è¿”å›[ModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.utils.ModelOutput)è€Œä¸æ˜¯æ™®é€šå…ƒç»„ã€‚

è¿”å›

[transformers.modeling_outputs.Seq2SeqTSModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.modeling_outputs.Seq2SeqTSModelOutput)æˆ–`tuple(torch.FloatTensor)`

ä¸€ä¸ª[transformers.modeling_outputs.Seq2SeqTSModelOutput](/docs/transformers/v4.37.2/en/main_classes/output#transformers.modeling_outputs.Seq2SeqTSModelOutput)æˆ–ä¸€ä¸ª`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœä¼ é€’`return_dict=False`æˆ–`config.return_dict=False`ï¼‰åŒ…å«æ ¹æ®é…ç½®ï¼ˆ[InformerConfig](/docs/transformers/v4.37.2/en/model_doc/informer#transformers.InformerConfig)ï¼‰å’Œè¾“å…¥çš„ä¸åŒå…ƒç´ ã€‚

+   `last_hidden_state` (`torch.FloatTensor`ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`) â€” æ¨¡å‹è§£ç å™¨æœ€åä¸€å±‚çš„éšè—çŠ¶æ€åºåˆ—ã€‚

    å¦‚æœä½¿ç”¨`past_key_values`ï¼Œåˆ™ä»…è¾“å‡ºå½¢çŠ¶ä¸º`(batch_size, 1, hidden_size)`çš„åºåˆ—çš„æœ€åä¸€ä¸ªéšè—çŠ¶æ€ã€‚

+   `past_key_values` (`tuple(tuple(torch.FloatTensor))`, *optional*, å½“ä¼ é€’`use_cache=True`æˆ–`config.use_cache=True`æ—¶è¿”å›) â€” ç”±é•¿åº¦ä¸º`config.n_layers`çš„`tuple(torch.FloatTensor)`ç»„æˆçš„å…ƒç»„ï¼Œæ¯ä¸ªå…ƒç»„æœ‰2ä¸ªå½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, embed_size_per_head)`çš„å¼ é‡å’Œ2ä¸ªé¢å¤–çš„å½¢çŠ¶ä¸º`(batch_size, num_heads, encoder_sequence_length, embed_size_per_head)`çš„å¼ é‡ã€‚

    åŒ…å«é¢„å…ˆè®¡ç®—çš„éšè—çŠ¶æ€ï¼ˆè‡ªæ³¨æ„åŠ›å—å’Œäº¤å‰æ³¨æ„åŠ›å—ä¸­çš„é”®å’Œå€¼ï¼‰ï¼Œå¯ç”¨äºåŠ é€Ÿé¡ºåºè§£ç ã€‚

+   `decoder_hidden_states` (`tuple(torch.FloatTensor)`, *optional*, å½“ä¼ é€’`output_hidden_states=True`æˆ–`config.output_hidden_states=True`æ—¶è¿”å›) â€” ç”±`torch.FloatTensor`ç»„æˆçš„å…ƒç»„ï¼ˆä¸€ä¸ªç”¨äºåµŒå…¥çš„è¾“å‡ºï¼Œå¦‚æœæ¨¡å‹æœ‰åµŒå…¥å±‚ï¼Œ+ ä¸€ä¸ªç”¨äºæ¯ä¸ªå±‚çš„è¾“å‡ºï¼‰ï¼Œå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`ã€‚

    è§£ç å™¨åœ¨æ¯ä¸€å±‚çš„è¾“å‡ºéšè—çŠ¶æ€ä»¥åŠå¯é€‰çš„åˆå§‹åµŒå…¥è¾“å‡ºã€‚

+   `decoder_attentions`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    è§£ç å™¨çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—è‡ªæ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `cross_attentions`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    è§£ç å™¨çš„äº¤å‰æ³¨æ„åŠ›å±‚çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—äº¤å‰æ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `encoder_last_hidden_state`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰- æ¨¡å‹ç¼–ç å™¨æœ€åä¸€å±‚çš„éšè—çŠ¶æ€åºåˆ—ã€‚

+   `encoder_hidden_states`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_hidden_states=True`æˆ–`config.output_hidden_states=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, sequence_length, hidden_size)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆå¦‚æœæ¨¡å‹æœ‰åµŒå…¥å±‚ï¼Œåˆ™ä¸ºåµŒå…¥çš„è¾“å‡º+æ¯å±‚çš„è¾“å‡ºï¼‰ã€‚

    ç¼–ç å™¨åœ¨æ¯ä¸€å±‚è¾“å‡ºçš„éšè—çŠ¶æ€ï¼Œä»¥åŠå¯é€‰çš„åˆå§‹åµŒå…¥è¾“å‡ºã€‚

+   `encoder_attentions`ï¼ˆ`tuple(torch.FloatTensor)`ï¼Œ*å¯é€‰*ï¼Œå½“ä¼ é€’`output_attentions=True`æˆ–`config.output_attentions=True`æ—¶è¿”å›ï¼‰- å½¢çŠ¶ä¸º`(batch_size, num_heads, sequence_length, sequence_length)`çš„`torch.FloatTensor`å…ƒç»„ï¼ˆæ¯å±‚ä¸€ä¸ªï¼‰ã€‚

    ç¼–ç å™¨çš„æ³¨æ„åŠ›æƒé‡ï¼Œåœ¨æ³¨æ„åŠ›softmaxä¹‹åï¼Œç”¨äºè®¡ç®—è‡ªæ³¨æ„åŠ›å¤´ä¸­çš„åŠ æƒå¹³å‡å€¼ã€‚

+   `loc`ï¼ˆå½¢çŠ¶ä¸º`(batch_size,)`æˆ–`(batch_size, input_size)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰- æ¯ä¸ªæ—¶é—´åºåˆ—ä¸Šä¸‹æ–‡çª—å£çš„åç§»å€¼ï¼Œç”¨äºç»™æ¨¡å‹è¾“å…¥ç›¸åŒæ•°é‡çº§çš„å€¼ï¼Œç„¶åç”¨äºå°†å…¶åç§»å›åŸå§‹æ•°é‡çº§ã€‚

+   `scale`ï¼ˆå½¢çŠ¶ä¸º`(batch_size,)`æˆ–`(batch_size, input_size)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰- æ¯ä¸ªæ—¶é—´åºåˆ—ä¸Šä¸‹æ–‡çª—å£çš„ç¼©æ”¾å€¼ï¼Œç”¨äºç»™æ¨¡å‹è¾“å…¥ç›¸åŒæ•°é‡çº§çš„å€¼ï¼Œç„¶åç”¨äºå°†å…¶é‡æ–°ç¼©æ”¾å›åŸå§‹æ•°é‡çº§ã€‚

+   `static_features`ï¼ˆå½¢çŠ¶ä¸º`(batch_size, feature size)`çš„`torch.FloatTensor`ï¼Œ*å¯é€‰*ï¼‰- æ‰¹å¤„ç†ä¸­æ¯ä¸ªæ—¶é—´åºåˆ—çš„é™æ€ç‰¹å¾ï¼Œåœ¨æ¨æ–­æ—¶å¤åˆ¶åˆ°åå˜é‡ä¸­ã€‚

[InformerForPrediction](/docs/transformers/v4.37.2/en/model_doc/informer#transformers.InformerForPrediction)çš„å‰å‘æ–¹æ³•ï¼Œè¦†ç›–äº†`__call__`ç‰¹æ®Šæ–¹æ³•ã€‚

è™½ç„¶å‰å‘ä¼ é€’çš„æ­¥éª¤éœ€è¦åœ¨è¿™ä¸ªå‡½æ•°å†…å®šä¹‰ï¼Œä½†åº”è¯¥åœ¨æ­¤ä¹‹åè°ƒç”¨`Module`å®ä¾‹ï¼Œè€Œä¸æ˜¯è¿™ä¸ªå‡½æ•°ï¼Œå› ä¸ºå‰è€…ä¼šè´Ÿè´£è¿è¡Œå‰åå¤„ç†æ­¥éª¤ï¼Œè€Œåè€…ä¼šé»˜é»˜åœ°å¿½ç•¥å®ƒä»¬ã€‚

ç¤ºä¾‹ï¼š

```py
>>> from huggingface_hub import hf_hub_download
>>> import torch
>>> from transformers import InformerForPrediction

>>> file = hf_hub_download(
...     repo_id="hf-internal-testing/tourism-monthly-batch", filename="train-batch.pt", repo_type="dataset"
... )
>>> batch = torch.load(file)

>>> model = InformerForPrediction.from_pretrained(
...     "huggingface/informer-tourism-monthly"
... )

>>> # during training, one provides both past and future values
>>> # as well as possible additional features
>>> outputs = model(
...     past_values=batch["past_values"],
...     past_time_features=batch["past_time_features"],
...     past_observed_mask=batch["past_observed_mask"],
...     static_categorical_features=batch["static_categorical_features"],
...     static_real_features=batch["static_real_features"],
...     future_values=batch["future_values"],
...     future_time_features=batch["future_time_features"],
... )

>>> loss = outputs.loss
>>> loss.backward()

>>> # during inference, one only provides past values
>>> # as well as possible additional features
>>> # the model autoregressively generates future values
>>> outputs = model.generate(
...     past_values=batch["past_values"],
...     past_time_features=batch["past_time_features"],
...     past_observed_mask=batch["past_observed_mask"],
...     static_categorical_features=batch["static_categorical_features"],
...     static_real_features=batch["static_real_features"],
...     future_time_features=batch["future_time_features"],
... )

>>> mean_prediction = outputs.sequences.mean(dim=1)
```
